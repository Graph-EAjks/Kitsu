import{_ as g,a as v,O as C,T as A,a2 as E,a3 as w,a4 as D,r,c as d,o as n,e as o,f as _,d as u,t as p,F as k,g as b,a5 as x,k as $,m as N,a6 as L,a7 as B,a8 as M,a9 as H}from"./index-BAzFID02.js";import{L as I}from"./ListPageHeader-DsCo3SsV.js";import{R as V}from"./RouteTabs-DzLDL6y7.js";const F={name:"asset-type-list",components:{HelpCircleIcon:w,RowActionsCell:E,TableInfo:A,TaskTypeName:C},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"],computed:{...v(["taskTypeMap"])},methods:{sortTaskTypes(e=[]){const s=e.map(a=>this.taskTypeMap.get(a));return D(s)}}},R={class:"data-list"},q={class:"datatable-wrapper"},j={class:"datatable"},G={class:"datatable-head"},K={scope:"col",class:"name"},O={scope:"col",class:"short-name"},P={scope:"col",class:"task-types"},S={key:0,class:"datatable-body"},z={class:"name"},J=["title"],Q={class:"short-name"},U={key:0,class:"task-types"},W={key:1,class:"task-types"},X={class:"has-text-centered nb-asset-types"};function Y(e,s,a,c,t,l){const y=r("help-circle-icon"),m=r("task-type-name"),T=r("row-actions-cell"),f=r("table-info");return n(),d("div",R,[o("div",q,[o("table",j,[o("thead",G,[o("tr",null,[o("th",K,p(e.$t("asset_types.fields.name")),1),o("th",O,p(e.$t("asset_types.fields.short_name")),1),o("th",P,p(e.$t("asset_types.fields.task_types")),1),s[0]||(s[0]=o("th",{scope:"col",class:"actions"},null,-1))])]),a.entries.length>0?(n(),d("tbody",S,[(n(!0),d(k,null,b(a.entries,i=>(n(),d("tr",{class:"datatable-row",key:i.id},[o("td",z,[x(p(i.name)+" ",1),i.description?(n(),d("span",{key:0,title:i.description},[_(y,{class:"icon is-small"})],8,J)):u("",!0)]),o("td",Q,p(i.short_name),1),(i.task_types||[]).length>0?(n(),d("td",U,[(n(!0),d(k,null,b(l.sortTaskTypes(i.task_types),h=>(n(),d("span",{key:h.id,class:"task-type-name flexrow-item"},[h.id?(n(),$(m,{key:0,"task-type":h},null,8,["task-type"])):u("",!0)]))),128))])):(n(),d("td",W,p(e.$t("asset_types.include_all")),1)),_(T,{"entry-id":i.id,onEditClicked:h=>e.$emit("edit-clicked",i),onDeleteClicked:h=>e.$emit("delete-clicked",i)},null,8,["entry-id","onEditClicked","onDeleteClicked"])]))),128))])):u("",!0)])]),_(f,{"is-loading":a.isLoading,"is-error":a.isError},null,8,["is-loading","is-error"]),o("p",X,p(a.entries.length)+" "+p(e.$tc("asset_types.number",a.entries.length)),1)])}const Z=g(F,[["render",Y],["__scopeId","data-v-5584ef0b"]]),ee={name:"asset-types",components:{AssetTypeList:Z,DeleteModal:B,EditAssetTypeModal:L,ListPageHeader:I,RouteTabs:V},data(){return{activeTab:"active",assetTypeToDelete:null,assetTypeToEdit:{},choices:[],errors:{del:!1,edit:!1,list:!1},modals:{del:!1,edit:!1},loading:{del:!1,edit:!1,list:!1},tabs:[{name:"active",label:this.$t("main.active")},{name:"archived",label:this.$t("main.archived")}]}},mounted(){this.activeTab=this.$route.query.tab||"active"},computed:{...v(["assetTypes","archivedAssetTypes","getAssetType","taskTypeMap"]),isActiveTab(){return this.activeTab==="active"},assetTypesList(){return this.isActiveTab?this.assetTypes:this.archivedAssetTypes},deleteText(){const e=this.assetTypeToDelete;return e?this.$t("asset_types.delete_text",{name:e.name}):""}},methods:{...N(["deleteAssetType","editAssetType","newAssetType","loadAssetTypes"]),confirmEditAssetType(e){let s="newAssetType";this.assetTypeToEdit&&this.assetTypeToEdit.id&&(s="editAssetType",e.id=this.assetTypeToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[s](e).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(a=>{console.error(a),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteAssetType(){this.loading.del=!0,this.errors.del=!1,this.deleteAssetType(this.assetTypeToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(e=>{console.error(e),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const e=M.slugify(this.$t("asset_types.title")),a=[[this.$t("main.type"),this.$t("asset_types.fields.name"),this.$t("asset_types.fields.short_name"),this.$t("asset_types.fields.description"),this.$t("asset_types.fields.task_types")]].concat(this.assetTypes.map(c=>[c.type,c.name,c.short_name,c.description,c.task_types.length?c.task_types.map(t=>this.taskTypeMap.get(t)?.name).join(", "):this.$t("asset_types.include_all")]));H.buildCsvFile(e,a)},onNewClicked(){this.assetTypeToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(e){this.assetTypeToEdit=e,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(e){this.assetTypeToDelete=e,this.errors.del=!1,this.modals.del=!0}},watch:{$route(){this.activeTab=this.$route.query.tab||"active"}},head(){return{title:`${this.$t("asset_types.title")} - Kitsu`}}},te={class:"asset-types page fixed-page"};function se(e,s,a,c,t,l){const y=r("list-page-header"),m=r("route-tabs"),T=r("asset-type-list"),f=r("edit-asset-type-modal"),i=r("delete-modal");return n(),d("div",te,[_(y,{title:e.$t("asset_types.library_title"),"new-entry-label":e.$t("asset_types.new_asset_type"),"is-exportable":l.isActiveTab,onExportClicked:l.onExportClicked,onNewClicked:l.onNewClicked},null,8,["title","new-entry-label","is-exportable","onExportClicked","onNewClicked"]),_(m,{class:"mt2","active-tab":t.activeTab,tabs:t.tabs},null,8,["active-tab","tabs"]),_(T,{class:"asset-type-list",entries:l.assetTypesList,"is-loading":t.loading.list,"is-error":t.errors.list,onEditClicked:l.onEditClicked,onDeleteClicked:l.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),_(f,{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"asset-type-to-edit":t.assetTypeToEdit,onCancel:s[0]||(s[0]=h=>t.modals.edit=!1),onConfirm:l.confirmEditAssetType},null,8,["active","is-loading","is-error","asset-type-to-edit","onConfirm"]),_(i,{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:l.deleteText,"error-text":e.$t("asset_types.delete_error"),onCancel:s[1]||(s[1]=h=>t.modals.del=!1),onConfirm:l.confirmDeleteAssetType},null,8,["active","is-loading","is-error","text","error-text","onConfirm"])])}const oe=g(ee,[["render",se],["__scopeId","data-v-e170dfff"]]);export{oe as default};
//# sourceMappingURL=AssetTypes-CLO0J5PE.js.map
