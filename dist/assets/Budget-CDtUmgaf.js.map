{"version":3,"file":"Budget-CDtUmgaf.js","sources":["../../src/components/mixins/page.js","../../src/components/pages/budget/BudgetList.vue","../../src/components/modals/BaseModal.vue","../../src/components/modals/EditBudgetModal.vue","../../src/components/widgets/MonthField.vue","../../src/components/modals/EditBudgetEntryModal.vue","../../src/components/pages/budget/Budget.vue"],"sourcesContent":["/*\n * This mixin is used to format the page title based on the current context.\n */\nimport { mapGetters } from 'vuex'\n\nexport const pageMixin = {\n  computed: {\n    ...mapGetters(['currentProduction, currentEpisode, isTVShow'])\n  },\n\n  methods: {},\n\n  head() {\n    if (this.currentProduction) {\n      if (this.isTVSHow && this.currentEpisode) {\n        return {\n          title:\n            `${this.currentProduction.name} - ` +\n            `${this.currentEpisode.name} | {this.pageTitle} - Kitsu`\n        }\n      } else {\n        return {\n          title: `${this.currentProduction.name} | ${this.pageTitle} - Kitsu`\n        }\n      }\n    } else {\n      return {\n        title: `${this.pageTitle} - Kitsu`\n      }\n    }\n  }\n}\n","<template>\n  <div class=\"budget-data\">\n    <div class=\"has-text-centered mt2\" v-if=\"isLoading\">\n      <spinner />\n    </div>\n\n    <div class=\"flexrow mt2\" v-else-if=\"isError\">\n      <p class=\"list-error\">\n        {{ $t('budget.budget_entries_error') }}\n      </p>\n    </div>\n\n    <div class=\"mt2\" v-else-if=\"budgetDepartments.length === 0\">\n      <p class=\"has-text-centered mt1\">\n        {{ $t('budget.no_budget_entries_found') }}\n      </p>\n      <p class=\"has-text-centered mt1\">\n        <button-simple\n          :text=\"$t('budget.add_entry')\"\n          @click=\"$emit('add-budget-entry')\"\n        />\n      </p>\n    </div>\n\n    <div class=\"data-list filler\" v-else>\n      <div ref=\"body\" class=\"datatable-wrapper flexcolumn filler\">\n        <table class=\"datatable\">\n          <thead class=\"datatable-head\">\n            <tr>\n              <th\n                class=\"datatable-row-header department-header-header\"\n                colspan=\"3\"\n              >\n                <div class=\"flexrow\">\n                  <div class=\"flexrow-item\">\n                    {{ $t('budget.fields.department') }}\n                  </div>\n                  <div class=\"filler\"></div>\n                  <button-simple\n                    is-thin\n                    :text=\"$t('budget.add_entry')\"\n                    @click=\"$emit('add-budget-entry')\"\n                  />\n                </div>\n              </th>\n              <th class=\"datatable-row-header base-salary-header month\">\n                {{ $t('budget.fields.base_salary') }}\n              </th>\n              <th class=\"datatable-row-header duration-header month\">\n                {{ $t('budget.fields.duration') }}\n              </th>\n              <template v-if=\"isShowingExpenses\">\n                <th\n                  class=\"month datatable-row-header cost-column\"\n                  :key=\"month\"\n                  v-for=\"month in monthsBetweenStartAndNow\"\n                >\n                  {{\n                    month.month() === 0\n                      ? month.format('MMM / YY')\n                      : month.format('MMM')\n                  }}\n                </th>\n                <th class=\"datatable-row-header has-text-right cost-column\">\n                  {{ $t('budget.costs') }}\n                </th>\n                <th class=\"datatable-row-header has-text-right cost-column\">\n                  {{ $t('budget.remaining') }}\n                </th>\n                <th\n                  class=\"datatable-row-header has-text-right cost-column difference\"\n                >\n                  {{ $t('budget.difference') }}\n                </th>\n              </template>\n              <th\n                :key=\"month\"\n                class=\"month datatable-row-header\"\n                v-for=\"month in isShowingExpenses\n                  ? monthsBetweenNowAndEnd\n                  : monthsBetweenProductionDates\"\n              >\n                {{\n                  month.month() === 0\n                    ? month.format('MMM / YY')\n                    : month.format('MMM')\n                }}\n              </th>\n              <th class=\"datatable-row-header has-text-right\">\n                {{ $t('main.total') }} ({{ currency }})\n              </th>\n              <th class=\"actions datatable-row-header\"></th>\n            </tr>\n          </thead>\n\n          <tbody\n            class=\"datatable-body\"\n            @mousedown=\"startBrowsing\"\n            @touchstart=\"startBrowsing\"\n          >\n            <tr class=\"datatable-row\">\n              <td class=\"datatable-row-header total-header\" colspan=\"3\">\n                <div class=\"pa05\">\n                  {{ $t('main.total') }}\n                </div>\n              </td>\n              <td class=\"month\"></td>\n              <td class=\"month\"></td>\n              <template v-if=\"isShowingExpenses\">\n                <td\n                  :key=\"month\"\n                  class=\"month\"\n                  v-for=\"month in monthsBetweenStartAndNow\"\n                >\n                  {{\n                    convertedExpenses[month.format('YYYY-MM')]?.toLocaleString()\n                  }}\n                </td>\n                <td class=\"costs expenses\" v-if=\"isShowingExpenses\">\n                  {{ convertedExpenses.total?.toLocaleString() }}\n                </td>\n                <td class=\"remaining expenses\" v-if=\"isShowingExpenses\">\n                  {{\n                    (\n                      totalEntry.total - (convertedExpenses.total || 0)\n                    ).toLocaleString()\n                  }}\n                </td>\n                <td\n                  class=\"difference expenses\"\n                  :class=\"{\n                    positive: differences.total > 0,\n                    negative: differences.total < 0\n                  }\"\n                  v-if=\"isShowingExpenses\"\n                >\n                  {{ differences.total > 0 ? '+' : '' }}\n                  {{ differences.total?.toLocaleString() || '' }}\n                </td>\n              </template>\n\n              <td\n                class=\"month\"\n                :key=\"month\"\n                v-for=\"month in isShowingExpenses\n                  ? monthsBetweenNowAndEnd\n                  : monthsBetweenProductionDates\"\n              >\n                {{\n                  totalEntry.monthCosts[\n                    month.format('YYYY-MM')\n                  ]?.toLocaleString()\n                }}\n              </td>\n\n              <td class=\"total-cost\">\n                {{ totalEntry.total.toLocaleString() }}\n              </td>\n              <td class=\"actions\"></td>\n            </tr>\n\n            <template\n              v-for=\"departmentEntry in extendedBudgetDepartments\"\n              :key=\"departmentEntry.id\"\n            >\n              <tr\n                class=\"datatable-row department-row pointer\"\n                @click=\"toggleDepartment(departmentEntry.id)\"\n              >\n                <td\n                  class=\"datatable-row-header strong department-header\"\n                  colspan=\"3\"\n                >\n                  <div\n                    class=\"flexrow department-header-content\"\n                    :style=\"getDepartmentStyle(departmentEntry.id, '99')\"\n                  >\n                    <chevron-right-icon\n                      class=\"flexrow-item\"\n                      v-if=\"collapsedDepartments[departmentEntry.id]\"\n                    />\n                    <chevron-down-icon class=\"flexrow-item\" v-else />\n                    <div class=\"flexrow-item\">\n                      {{ departmentMap.get(departmentEntry.id).name }}\n                    </div>\n                  </div>\n                </td>\n                <td\n                  class=\"base-salary-header text-right month\"\n                  :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                ></td>\n                <td\n                  class=\"duration-header text-right month\"\n                  :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                ></td>\n                <template v-if=\"isShowingExpenses\">\n                  <td\n                    :key=\"month\"\n                    class=\"month\"\n                    :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                    v-for=\"month in monthsBetweenStartAndNow\"\n                  >\n                    {{\n                      convertedExpenses[departmentEntry.id]?.[\n                        month.format('YYYY-MM')\n                      ]?.toLocaleString()\n                    }}\n                  </td>\n                  <td\n                    class=\"costs expenses\"\n                    :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                    v-if=\"isShowingExpenses\"\n                  >\n                    {{\n                      convertedExpenses[\n                        departmentEntry.id\n                      ]?.total?.toLocaleString()\n                    }}\n                  </td>\n                  <td\n                    class=\"remaining expenses\"\n                    :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                    v-if=\"isShowingExpenses\"\n                  >\n                    {{\n                      (\n                        departmentEntry.total -\n                        (convertedExpenses[departmentEntry.id]?.total || 0)\n                      ).toLocaleString()\n                    }}\n                  </td>\n                  <td\n                    class=\"difference expenses\"\n                    :class=\"{\n                      positive: differences[departmentEntry.id]?.total > 0,\n                      negative: differences[departmentEntry.id]?.total < 0\n                    }\"\n                    :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                    v-if=\"isShowingExpenses\"\n                  >\n                    {{ differences[departmentEntry.id]?.total > 0 ? '+' : '' }}\n                    {{\n                      differences[\n                        departmentEntry.id\n                      ]?.total?.toLocaleString() || ''\n                    }}\n                  </td>\n                </template>\n                <td\n                  :key=\"departmentEntry.id + '-' + month\"\n                  class=\"month\"\n                  :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                  v-for=\"month in isShowingExpenses\n                    ? monthsBetweenNowAndEnd\n                    : monthsBetweenProductionDates\"\n                >\n                  {{\n                    departmentEntry.monthCosts[\n                      month.format('YYYY-MM')\n                    ]?.toLocaleString()\n                  }}\n                </td>\n                <td\n                  class=\"total-cost\"\n                  :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                >\n                  {{ departmentEntry.total.toLocaleString() }}\n                </td>\n                <td\n                  class=\"actions\"\n                  :style=\"getDepartmentStyle(departmentEntry.id, '33')\"\n                ></td>\n              </tr>\n\n              <template v-if=\"!collapsedDepartments[departmentEntry.id]\">\n                <tr\n                  class=\"datatable-row\"\n                  :key=\"personEntry.id\"\n                  v-for=\"personEntry in departmentEntry.persons\"\n                >\n                  <td class=\"position datatable-row-header\">\n                    {{\n                      $t('budget.positions.' + personEntry.position || 'artist')\n                    }}\n                  </td>\n                  <td class=\"seniority datatable-row-header\">\n                    {{\n                      $t(\n                        'budget.seniorities.' + personEntry.seniority ||\n                          'junior'\n                      )\n                    }}\n                  </td>\n                  <td class=\"name datatable-row-header\">\n                    <div class=\"flexrow\">\n                      <people-avatar\n                        class=\"flexrow-item\"\n                        :person=\"personMap.get(personEntry.person_id)\"\n                        :is-link=\"false\"\n                        :font-size=\"12\"\n                        :size=\"20\"\n                        v-if=\"personEntry.person_id\"\n                      />\n                      <people-name\n                        :person=\"personMap.get(personEntry.person_id)\"\n                        v-if=\"personEntry.person_id\"\n                      />\n                      <span class=\"new-hiring\" v-else>\n                        {{ $t('budget.new_hiring') }}\n                      </span>\n                    </div>\n                  </td>\n                  <td class=\"base-salary-header text-right entry-data\">\n                    {{ (personEntry.monthly_salary || 0).toLocaleString() }}\n                  </td>\n                  <td class=\"duration-header text-right entry-data\">\n                    {{ personEntry.months_duration }}\n                  </td>\n                  <template v-if=\"isShowingExpenses\">\n                    <td\n                      :key=\"personEntry.id + '-' + month\"\n                      class=\"costs\"\n                      v-for=\"month in monthsBetweenStartAndNow\"\n                    >\n                      {{\n                        convertedExpenses[departmentEntry.id]?.[\n                          personEntry.person_id\n                        ]?.[month.format('YYYY-MM')]?.toLocaleString()\n                      }}\n                    </td>\n                    <td class=\"costs expenses\" v-if=\"isShowingExpenses\">\n                      {{\n                        convertedExpenses[\n                          departmentEntry.id\n                        ]?.total?.toLocaleString()\n                      }}\n                    </td>\n                    <td class=\"remaining expenses\" v-if=\"isShowingExpenses\">\n                      {{\n                        (\n                          personEntry.total -\n                            convertedExpenses[departmentEntry.id]?.[\n                              personEntry.person_id\n                            ]?.total || 0\n                        ).toLocaleString()\n                      }}\n                    </td>\n                    <td\n                      class=\"difference expenses\"\n                      :class=\"{\n                        positive:\n                          differences[departmentEntry.id]?.[\n                            personEntry.person_id\n                          ] > 0,\n                        negative:\n                          differences[departmentEntry.id]?.[\n                            personEntry.person_id\n                          ] < 0\n                      }\"\n                      v-if=\"isShowingExpenses\"\n                    >\n                      {{\n                        differences[departmentEntry.id]?.[\n                          personEntry.person_id\n                        ] > 0\n                          ? '+'\n                          : ''\n                      }}\n                      {{\n                        differences[departmentEntry.id]?.[\n                          personEntry.person_id\n                        ]?.toLocaleString() || ''\n                      }}\n                    </td>\n                  </template>\n                  <td\n                    :key=\"personEntry.id + '-' + month\"\n                    class=\"month value-cell\"\n                    v-for=\"month in isShowingExpenses\n                      ? monthsBetweenNowAndEnd\n                      : monthsBetweenProductionDates\"\n                  >\n                    <input\n                      class=\"input-editor\"\n                      type=\"number\"\n                      min=\"0\"\n                      step=\"1\"\n                      :value=\"getMonthCost(personEntry, month)\"\n                      @change=\"\n                        addPersonException(\n                          personEntry,\n                          month,\n                          $event.target.value\n                        )\n                      \"\n                      v-if=\"personEntry.monthCosts[month.format('YYYY-MM')]\"\n                    />\n                    <span v-else>&nbsp;</span>\n                  </td>\n                  <td class=\"total-cost\">\n                    {{ personEntry.total.toLocaleString() }}\n                  </td>\n                  <row-actions-cell\n                    class=\"actions\"\n                    :entry-id=\"personEntry.id\"\n                    :hide-avatar=\"true\"\n                    :hide-change-password=\"true\"\n                    :hide-delete=\"false\"\n                    :hide-refresh=\"true\"\n                    @delete-clicked=\"$emit('delete-budget-entry', personEntry)\"\n                    @edit-clicked=\"$emit('edit-budget-entry', personEntry)\"\n                  />\n                </tr>\n              </template>\n            </template>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { domMixin } from '@/components/mixins/dom'\nimport { grabListMixin } from '@/components/mixins/grablist'\n\nimport { ChevronDownIcon, ChevronRightIcon } from 'lucide-vue-next'\n\nimport preferences from '@/lib/preferences'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport PeopleName from '@/components/widgets/PeopleName.vue'\nimport PeopleAvatar from '@/components/widgets/PeopleAvatar.vue'\nimport RowActionsCell from '@/components/cells/RowActionsCell.vue'\nimport Spinner from '@/components/widgets/Spinner.vue'\n\nexport default {\n  name: 'budget-list',\n\n  mixins: [domMixin, grabListMixin],\n\n  emits: ['add-budget-entry', 'delete-budget-entry', 'edit-budget-entry'],\n\n  components: {\n    ButtonSimple,\n    ChevronDownIcon,\n    ChevronRightIcon,\n    PeopleName,\n    PeopleAvatar,\n    RowActionsCell,\n    Spinner\n  },\n\n  props: {\n    budgetEntries: {\n      type: Array,\n      default: () => []\n    },\n    budgetDepartments: {\n      type: Array,\n      default: () => []\n    },\n    costsMonths: {\n      type: Object,\n      default: () => {}\n    },\n    currency: {\n      type: String,\n      default: 'USD'\n    },\n    currentBudget: {\n      type: Object,\n      default: () => {}\n    },\n    expenses: {\n      type: Object,\n      default: () => {}\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    isShowingExpenses: {\n      type: Boolean,\n      default: false\n    },\n    monthsBetweenStartAndNow: {\n      type: Array,\n      default: () => []\n    },\n    monthsBetweenNowAndEnd: {\n      type: Array,\n      default: () => []\n    },\n    monthsBetweenProductionDates: {\n      type: Array,\n      default: () => []\n    },\n    salaryScale: {\n      type: Object,\n      default: () => {}\n    },\n    totalEntry: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n\n  data() {\n    return {\n      collapsedDepartments: {},\n      domEvents: [\n        ['mousemove', this.onMouseMove],\n        ['touchmove', this.onMouseMove],\n        ['mouseup', this.stopBrowsing],\n        ['mouseleave', this.stopBrowsing],\n        ['touchend', this.stopBrowsing],\n        ['touchcancel', this.stopBrowsing],\n        ['keyup', this.stopBrowsing]\n      ]\n    }\n  },\n\n  mounted() {\n    const key = `budget:collapsed-departments-${this.currentProduction.id}`\n    this.addEvents(this.domEvents)\n    this.collapsedDepartments = preferences.getObjectPreference(key) || {}\n  },\n\n  beforeUnmount() {\n    this.removeEvents(this.domEvents)\n    document.body.style.cursor = 'default'\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'departmentMap',\n      'personMap',\n      'organisation'\n    ]),\n\n    /* It converts the expenses to the budget format where there is an\n     * entry for each department and each person. It also calculates the totals\n     * for each person, department and for all the departments.\n     * It also converts the time spent to a cost.\n     */\n    convertedExpenses() {\n      const convertedExpenses = {}\n      const expenses = this.expenses || {}\n      let total = 0\n      Object.keys(expenses).forEach(departmentId => {\n        let departmentTotal = 0\n        convertedExpenses[departmentId] = {}\n\n        Object.keys(expenses[departmentId]).forEach(personId => {\n          let personTotal = 0\n          const dailyRate = this.getDailyRate(departmentId, personId)\n\n          convertedExpenses[departmentId][personId] = {}\n          Object.keys(expenses[departmentId][personId]).forEach(month => {\n            const timeSpent = expenses[departmentId][personId][month]\n            const cost = this.convertTimeSpentToCost(dailyRate, timeSpent)\n            convertedExpenses[departmentId][personId][month] = cost\n            if (!convertedExpenses[departmentId][month]) {\n              convertedExpenses[departmentId][month] = 0\n            }\n            convertedExpenses[departmentId][month] += cost\n            if (!convertedExpenses[month]) {\n              convertedExpenses[month] = 0\n            }\n            convertedExpenses[month] += cost\n            personTotal += cost\n          })\n\n          convertedExpenses[departmentId][personId].total = personTotal\n          departmentTotal += personTotal\n        })\n        convertedExpenses[departmentId].total = departmentTotal\n        total += departmentTotal\n      })\n      convertedExpenses.total = total\n      return convertedExpenses\n    },\n\n    /* It extends the budget departments with the expenses that don't have\n     * equivalent entries in the budget departments. It also adds the new\n     * departments to the budget departments if needed.\n     */\n    extendedBudgetDepartments() {\n      if (!this.isShowingExpenses) return this.budgetDepartments\n\n      const existingDepartments = this.budgetDepartments.reduce(\n        (acc, department) => {\n          acc[department.id] = true\n          return acc\n        },\n        {}\n      )\n\n      const newDepartments = Object.keys(this.expenses)\n        .filter(departmentId => !existingDepartments[departmentId])\n        .map(departmentId => ({\n          id: departmentId,\n          monthCosts: {},\n          total: 0,\n          duration: 0,\n          persons: [],\n          start_date: null\n        }))\n\n      const extendedBudgetDepartments = [\n        ...this.budgetDepartments,\n        ...newDepartments\n      ]\n\n      const existingEntries = extendedBudgetDepartments.reduce(\n        (acc, department) => {\n          department.persons.forEach(entry => {\n            if (!acc[department.id]) {\n              acc[department.id] = {}\n            }\n            acc[department.id][entry.person_id] = true\n          })\n          return acc\n        },\n        {}\n      )\n\n      Object.keys(this.expenses).forEach(departmentId => {\n        if (departmentId === 'total') return\n        Object.keys(this.expenses[departmentId]).forEach(personId => {\n          if (personId === 'total') return\n          if (!existingEntries[departmentId]?.[personId]) {\n            const person = this.personMap.get(personId)\n            extendedBudgetDepartments\n              .find(department => department.id === departmentId)\n              .persons.push({\n                id: null,\n                person_id: personId,\n                budget_entry_id: null,\n                department_id: departmentId,\n                monthCosts: {},\n                position: person.position,\n                seniority: person.seniority,\n                total: 0,\n                months_duration: 0,\n                monthly_salary: 0,\n                daily_salary: person.daily_salary,\n                start_date: null,\n                exceptions: {}\n              })\n          }\n        })\n      })\n\n      return extendedBudgetDepartments\n    },\n\n    /* It calculates the difference between the consumed budget and the\n     * expenses. It runs through all the departments and persons and\n     * calculates the difference for each person. It aggregates the\n     */\n    differences() {\n      const differences = { total: 0 }\n      this.budgetDepartments.forEach(department => {\n        if (!differences[department.id]) {\n          differences[department.id] = { total: 0 }\n        }\n        department.persons.forEach(person => {\n          if (!person.person_id) return\n          if (!differences[department.id][person.person_id]) {\n            differences[department.id][person.person_id] = 0\n          }\n          let personTotal = 0\n          Object.keys(this.costsMonths).forEach(month => {\n            personTotal += this.getMonthCost(person, month)\n          })\n          const expense =\n            this.convertedExpenses[department.id]?.[person.person_id]?.total ||\n            0\n          const personDifference = personTotal - expense || 0\n          differences[department.id][person.person_id] += personDifference\n          differences[department.id].total += personDifference\n        })\n        differences.total += differences[department.id].total\n      })\n      return differences\n    }\n  },\n\n  methods: {\n    ...mapActions(['updateProductionBudgetEntry']),\n\n    /* It gets the daily rate of a person, and use the salary scale if\n     * no daily rate is available.\n     */\n    getDailyRate(deparmentId, personId) {\n      const person = this.personMap.get(personId)\n      if (!person) return 0\n      const salaryScale =\n        person.seniority && person.position\n          ? this.salaryScale[deparmentId][person.position][person.seniority]\n          : 0\n      return person.daily_salary || salaryScale\n    },\n\n    /* It converts the time spent to days then multiply it with the\n     * given daily rate.\n     */\n    convertTimeSpentToCost(dailyRate, timeSpent) {\n      const days = timeSpent / 60 / this.organisation.hours_by_day\n      return Math.round(days * dailyRate)\n    },\n\n    /* It gets the cost of a person for a given month, exceptions are\n     * prioritized over the month costs.\n     */\n    getMonthCost(personEntry, month) {\n      let monthKey = ''\n      if (typeof month === 'string') {\n        monthKey = month\n      } else {\n        monthKey = month.format('YYYY-MM')\n      }\n      personEntry.exceptions = personEntry.exceptions || {}\n      return (\n        parseInt(personEntry.exceptions[monthKey]) ||\n        parseInt(personEntry.monthCosts[monthKey]) ||\n        0\n      )\n    },\n\n    /* It toggles the department visibility and save it to local storage. */\n    toggleDepartment(departmentId) {\n      this.collapsedDepartments[departmentId] =\n        !this.collapsedDepartments[departmentId]\n\n      const key = `budget:collapsed-departments-${this.currentProduction.id}`\n      preferences.setObjectPreference(key, this.collapsedDepartments)\n    },\n\n    /* It sets the background with the color of the department. */\n    getDepartmentStyle(departmentId, opacity) {\n      return {\n        backgroundColor: this.departmentMap.get(departmentId).color + opacity\n      }\n    },\n\n    /* It sets an salary exception for a person, for a given month. */\n    addPersonException(personEntry, month, value) {\n      const exceptions = personEntry.exceptions || {}\n      exceptions[month.format('YYYY-MM')] = value\n      const budgetEntry = {\n        id: personEntry.budget_entry_id,\n        ...personEntry,\n        exceptions\n      }\n      this.updateProductionBudgetEntry({\n        productionId: this.currentProduction.id,\n        budgetId: this.currentBudget.id,\n        budgetEntryId: personEntry.budget_entry_id,\n        budgetEntry\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.datatable-wrapper {\n  border-bottom-right-radius: 10px;\n  border-bottom-left-radius: 10px;\n}\n\n.department-header-header {\n  max-width: 400px;\n  width: 400px;\n  min-width: 400px;\n  z-index: 5;\n}\n\n.data-list {\n  margin-top: 2em;\n}\n\n.department-header {\n  max-width: 400px;\n  min-width: 400px;\n  position: sticky;\n  padding: 0;\n}\n\n.department-header-content {\n  color: white;\n  height: 100%;\n  min-width: 400px;\n  max-width: 400px;\n  padding: 0.6em 1em;\n}\n\nth.month {\n  text-align: center;\n  max-width: 80px;\n  min-width: 80px;\n  width: 80px;\n}\n\ntd.month {\n  text-align: right;\n  max-width: 80px;\n  min-width: 80px;\n  width: 80px;\n}\n\ntd.entry-data {\n  text-align: right;\n  max-width: 80px;\n  min-width: 80px;\n  width: 80px;\n  padding: 10px;\n}\n\n.position {\n  max-width: 100px;\n  min-width: 100px;\n  width: 100px;\n}\n\n.seniority {\n  max-width: 100px;\n  min-width: 100px;\n  width: 100px;\n}\n\n.name {\n  max-width: 200px;\n  width: 200px;\n}\n\ntd.datatable-row-header.seniority {\n  left: 100px;\n}\n\ntd.datatable-row-header.name {\n  left: 200px;\n}\n\n.actions {\n  min-width: 120px;\n}\n\n.total-cost {\n  font-weight: bold;\n  text-align: right;\n  max-width: 100px;\n  width: 100px;\n}\n\n.costs,\n.remaining,\n.difference {\n  text-align: right;\n  max-width: 100px;\n  width: 100px;\n}\n\n.difference {\n  border-right: 3px solid $green;\n}\n\n.new-hiring {\n  background: $light-grey-light;\n  color: $dark-grey-2;\n  padding: 0.5em 1em;\n  border-radius: 5px;\n  font-size: 0.8rem;\n\n  .dark & {\n    background: $dark-grey-light;\n    color: $light-grey;\n  }\n}\n\n.input-editor {\n  width: 100%;\n  text-align: right;\n}\n\n.cost-column {\n  background-color: #8888cc;\n  color: white;\n}\n\n.expenses {\n  font-weight: bold;\n\n  &.positive {\n    color: $green;\n  }\n\n  &.negative {\n    color: $red;\n  }\n}\n\ninput[type='number']::-webkit-outer-spin-button,\ninput[type='number']::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type='number'] {\n  -moz-appearance: textfield;\n}\n</style>\n","<template>\n  <div\n    :class=\"{\n      modal: true,\n      'is-active': active\n    }\"\n  >\n    <div class=\"modal-background\" @click=\"onBackgroundClicked\"></div>\n\n    <div class=\"modal-content\">\n      <div class=\"box\">\n        <h1 class=\"title\">\n          {{ title }}\n        </h1>\n        <slot />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/*\n */\nimport { modalMixin } from './base_modal'\n\nexport default {\n  name: 'base-modal',\n\n  mixins: [modalMixin],\n\n  emits: ['cancel'],\n\n  components: {},\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    title: {\n      type: String,\n      default: ''\n    }\n  },\n\n  data() {\n    return {}\n  },\n\n  methods: {\n    onBackgroundClicked() {\n      this.$emit('cancel')\n    }\n  },\n\n  watch: {}\n}\n</script>\n\n<style scoped>\n.modal {\n  display: none;\n\n  &.is-active {\n    display: flex;\n  }\n}\n</style>\n","<template>\n  <base-modal :active=\"active\" :title=\"modalTitle\" @cancel=\"$emit('cancel')\">\n    <form @submit.prevent>\n      <div class=\"field\">\n        <label class=\"label\">\n          {{ $t('budget.fields.revision') }}\n        </label>\n\n        <p class=\"revision-number\">\n          v{{ isEditing ? budgetToEdit.revision : lastRevision + 1 }}\n        </p>\n      </div>\n\n      <text-field\n        ref=\"nameField\"\n        :label=\"$t('budget.fields.name')\"\n        :maxlength=\"30\"\n        v-model=\"form.name\"\n        @enter=\"runConfirmation\"\n        v-focus\n      />\n\n      <combobox\n        :label=\"$t('budget.fields.currency')\"\n        :options=\"currencieOptions\"\n        v-model=\"form.currency\"\n      />\n    </form>\n\n    <modal-footer\n      :error-text=\"$t('budget.create_budget_error')\"\n      :is-error=\"isError\"\n      :is-loading=\"isLoading\"\n      :is-disabled=\"isDisabled\"\n      @confirm=\"runConfirmation\"\n      @cancel=\"$emit('cancel')\"\n    />\n  </base-modal>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport { modalMixin } from '@/components/modals/base_modal'\n\nimport BaseModal from '@/components/modals/BaseModal.vue'\nimport ModalFooter from '@/components/modals/ModalFooter.vue'\nimport TextField from '@/components/widgets/TextField.vue'\nimport Combobox from '@/components/widgets/Combobox.vue'\n\nexport default {\n  name: 'edit-budget-modal',\n\n  mixins: [modalMixin],\n\n  components: {\n    BaseModal,\n    Combobox,\n    ModalFooter,\n    TextField\n  },\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    budgetToEdit: {\n      type: Object,\n      default: () => {}\n    },\n    lastRevision: {\n      type: Number,\n      default: 1\n    }\n  },\n\n  emits: ['cancel', 'confirm'],\n\n  data() {\n    return {\n      form: {\n        name: '',\n        currency: 'USD'\n      },\n      currencieOptions: [\n        { label: 'USD', value: 'USD' },\n        { label: 'EUR', value: 'EUR' },\n        { label: 'GBP', value: 'GBP' },\n        { label: 'CAD', value: 'CAD' },\n        { label: 'AUD', value: 'AUD' },\n        { label: 'CHF', value: 'CHF' },\n        { label: 'JPY', value: 'JPY' },\n        { label: 'CNY', value: 'CNY' },\n        { label: 'INR', value: 'INR' }\n      ]\n    }\n  },\n\n  computed: {\n    ...mapGetters([]),\n\n    isDisabled() {\n      return this.form.name.length === 0\n    },\n\n    isEditing() {\n      return this.budgetToEdit && this.budgetToEdit.id\n    },\n\n    modalTitle() {\n      return this.isEditing\n        ? this.$t('budget.edit_budget')\n        : this.$t('budget.create_budget')\n    }\n  },\n\n  methods: {\n    ...mapActions(['']),\n\n    runConfirmation() {\n      this.$emit('confirm', this.form)\n    }\n  },\n\n  watch: {\n    active() {\n      if (this.active) {\n        setTimeout(() => {\n          this.$refs.nameField.focus()\n        }, 100)\n      }\n    },\n\n    budgetToEdit() {\n      if (this.budgetToEdit.id) {\n        this.form = {\n          id: this.budgetToEdit.id,\n          name: this.budgetToEdit.name,\n          currency: this.budgetToEdit.currency || 'USD'\n        }\n      } else {\n        this.form = {\n          id: null,\n          name: '',\n          currency: 'USD'\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-content .box p.text {\n  margin-bottom: 1em;\n}\n\n.revision-number {\n  font-size: 1.4rem;\n  font-weight: bold;\n}\n\n.task-types {\n  flex-wrap: wrap;\n}\n</style>\n","<template>\n  <div class=\"month-field flexcolumn\">\n    <label class=\"label\" v-if=\"label.length > 0\">\n      {{ label }}\n    </label>\n    <div class=\"date-selector\">\n      <combobox-number :options=\"availableYears\" v-model=\"selectedYear\" />\n      <combobox-number :options=\"availableMonths\" v-model=\"selectedMonth\" />\n    </div>\n  </div>\n</template>\n<script>\nimport moment from 'moment'\nimport { range } from '@/lib/time'\n\nimport ComboboxNumber from '@/components/widgets/ComboboxNumber.vue'\n\nexport default {\n  name: 'month-field',\n\n  emits: ['update:modelValue'],\n  components: {\n    ComboboxNumber\n  },\n\n  props: {\n    label: {\n      type: String,\n      default: ''\n    },\n    minDate: {\n      type: Date,\n      required: true\n    },\n    maxDate: {\n      type: Date,\n      required: true\n    },\n    modelValue: {}\n  },\n\n  data() {\n    return {\n      selectedMonth: null,\n      selectedYear: null,\n      months: []\n    }\n  },\n\n  mounted() {\n    this.months = range(1, 12).map(month => ({\n      value: month - 1,\n      label: moment()\n        .month(month - 1)\n        .format('MMMM')\n    }))\n    if (this.modelValue && this.modelValue.getMonth) {\n      this.selectedMonth = this.modelValue.getMonth()\n      this.selectedYear = this.modelValue.getFullYear()\n    }\n  },\n\n  computed: {\n    availableYears() {\n      const years = []\n      const startYear = this.minDate.getFullYear()\n      const endYear = this.maxDate.getFullYear()\n\n      for (let year = startYear; year <= endYear; year++) {\n        years.push(year)\n      }\n      return years.map(year => ({\n        value: year,\n        label: year\n      }))\n    },\n\n    availableMonths() {\n      const currentYear = this.selectedYear || this.availableYears[0].value\n      const startYear = this.minDate.getFullYear()\n      const endYear = this.maxDate.getFullYear()\n      const minMonth = this.minDate.getMonth()\n      const maxMonth = this.maxDate.getMonth()\n\n      return this.months\n        .filter(month => {\n          if (currentYear === startYear && currentYear === endYear) {\n            // If same year, only show months between start and end\n            return month.value >= minMonth && month.value <= maxMonth\n          } else if (currentYear === startYear) {\n            // If start year, only show months after start date\n            return month.value >= minMonth\n          } else if (currentYear === endYear) {\n            // If end year, only show months before end date\n            return month.value <= maxMonth\n          }\n          return true\n        })\n        .map(month => ({\n          value: month.value,\n          label: month.label\n        }))\n    }\n  },\n\n  watch: {\n    modelValue() {\n      this.$options.silent = true\n      if (this.modelValue && this.modelValue.getMonth) {\n        this.selectedMonth = this.modelValue.getMonth()\n        this.selectedYear = this.modelValue.getFullYear()\n      }\n      this.$nextTick(() => {\n        this.$options.silent = false\n      })\n    },\n\n    selectedMonth(newMonth) {\n      if (this.$options.silent) return\n      const date = moment(new Date(this.selectedYear, newMonth, 1, 0, 0, 0, 0))\n      this.$emit('update:modelValue', date.startOf('month').toDate())\n    },\n\n    selectedYear(newYear) {\n      if (this.$options.silent) return\n      this.$nextTick(() => {\n        this.selectedMonth = this.availableMonths[0].value\n        const date = moment(\n          new Date(newYear, this.selectedMonth, 1, 0, 0, 0, 0)\n        )\n        this.$emit('update:modelValue', date.startOf('month').toDate())\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.date-selector {\n  display: flex;\n  gap: 1rem;\n}\n</style>\n","<template>\n  <base-modal\n    :active=\"active\"\n    :title=\"isEditing ? $t('budget.edit_budget_entry') : $t('budget.add_entry')\"\n    @cancel=\"$emit('cancel')\"\n  >\n    <form @submit.prevent>\n      <combobox-department\n        ref=\"departmentField\"\n        :label=\"$t('budget.fields.department')\"\n        v-model=\"form.department_id\"\n        @enter=\"runConfirmation\"\n        v-focus\n      />\n\n      <people-field\n        class=\"mt2\"\n        :label=\"$t('budget.fields.person')\"\n        :people=\"departmentPeople\"\n        @select=\"onPersonChanged\"\n        @enter=\"runConfirmation\"\n        v-model=\"form.person\"\n      />\n\n      <combobox\n        class=\"mt2\"\n        :label=\"$t('budget.fields.position')\"\n        :options=\"positionOptions\"\n        locale-key-prefix=\"people.position.\"\n        v-model=\"form.position\"\n        @enter=\"runConfirmation\"\n      />\n\n      <combobox\n        class=\"mt2\"\n        :label=\"$t('budget.fields.seniority')\"\n        :options=\"seniorityOptions\"\n        locale-key-prefix=\"people.seniority.\"\n        v-model=\"form.seniority\"\n        @enter=\"runConfirmation\"\n      />\n\n      <div class=\"flexrow\">\n        <month-field\n          class=\"mr1\"\n          :label=\"$t('budget.fields.start_date')\"\n          :min-date=\"projectStartDate\"\n          :max-date=\"projectEndDate\"\n          v-model=\"form.start_date\"\n        />\n\n        <text-field\n          class=\"month-duration\"\n          type=\"number\"\n          :min=\"1\"\n          :max=\"maxDuration\"\n          :label=\"$t('budget.fields.months_duration')\"\n          v-model=\"form.months_duration\"\n          @enter=\"runConfirmation\"\n        />\n\n        <text-field\n          class=\"month-duration\"\n          type=\"number\"\n          :min=\"0\"\n          :label=\"$t('budget.fields.daily_salary')\"\n          v-model=\"form.daily_salary\"\n          @enter=\"runConfirmation\"\n        />\n      </div>\n      <div class=\"mt0\">\n        <span class=\"salary-label\">{{ $t('budget.fields.start_date') }}</span>\n        <span class=\"salary-value\">{{\n          formatDate(form.start_date).substring(0, 7)\n        }}</span>\n        <br />\n        <span class=\"salary-label\">{{ $t('budget.fields.end_date') }}</span>\n        <span class=\"salary-value\">{{ endMonth }}</span>\n        <br />\n        <span class=\"salary-label\">\n          {{ $t('budget.fields.monthly_salary') }}\n        </span>\n        <span class=\"salary-value\">{{ monthlySalary }}</span>\n        <br />\n        <span class=\"salary-label\">{{ $t('budget.fields.total_salary') }}</span>\n        <span class=\"salary-value\">{{ totalSalary }}</span>\n      </div>\n    </form>\n\n    <modal-footer\n      :error-text=\"$t('budget.create_budget_error')\"\n      :is-error=\"isError\"\n      :is-loading=\"isLoading\"\n      :is-disabled=\"isDisabled\"\n      @confirm=\"runConfirmation\"\n      @cancel=\"$emit('cancel')\"\n    />\n  </base-modal>\n</template>\n\n<script>\nimport moment from 'moment'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { modalMixin } from '@/components/modals/base_modal'\nimport { parseSimpleDate, formatSimpleDate } from '@/lib/time'\n\nimport BaseModal from '@/components/modals/BaseModal.vue'\nimport Combobox from '@/components/widgets/Combobox.vue'\nimport ComboboxDepartment from '@/components/widgets/ComboboxDepartment.vue'\nimport ModalFooter from '@/components/modals/ModalFooter.vue'\nimport MonthField from '@/components/widgets/MonthField.vue'\nimport PeopleField from '@/components/widgets/PeopleField.vue'\nimport TextField from '@/components/widgets/TextField.vue'\n\nexport default {\n  name: 'edit-budget-entry-modal',\n\n  mixins: [modalMixin],\n\n  components: {\n    BaseModal,\n    Combobox,\n    ComboboxDepartment,\n    ModalFooter,\n    MonthField,\n    PeopleField,\n    TextField\n  },\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    budgetEntryToEdit: {\n      type: Object,\n      default: () => {}\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    salaryScale: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  emits: ['cancel', 'confirm'],\n\n  data() {\n    return {\n      form: {\n        department_id: '',\n        person: null,\n        position: 'artist',\n        seniority: 'junior',\n        start_date: null,\n        months_duration: 1\n      },\n      positionOptions: [\n        { label: 'artist', value: 'artist' },\n        { label: 'supervisor', value: 'supervisor' },\n        { label: 'lead', value: 'lead' }\n      ],\n      refreshKeys: {\n        endMonth: 0,\n        monthlySalary: 0,\n        totalSalary: 0\n      },\n      seniorityOptions: [\n        { label: 'junior', value: 'junior' },\n        { label: 'mid', value: 'mid' },\n        { label: 'senior', value: 'senior' }\n      ]\n    }\n  },\n\n  mounted() {\n    this.resetForm()\n  },\n\n  computed: {\n    ...mapGetters(['activePeople', 'currentProduction', 'personMap']),\n\n    isDisabled() {\n      return !this.form.department_id || this.form.months_duration < 1\n    },\n\n    isEditing() {\n      return this.budgetEntryToEdit && this.budgetEntryToEdit.id\n    },\n\n    projectStartDate() {\n      return parseSimpleDate(this.currentProduction.start_date).toDate()\n    },\n\n    projectEndDate() {\n      return parseSimpleDate(this.currentProduction.end_date).toDate()\n    },\n\n    endMonth() {\n      this.refreshKeys.endMonth\n      const startDate = parseSimpleDate(this.form.start_date)\n      const projectEndDate = parseSimpleDate(this.currentProduction.end_date)\n      let endDate = startDate.add(this.form.months_duration, 'months')\n      endDate = moment.min(endDate, projectEndDate)\n      return endDate.format('YYYY-MM')\n    },\n\n    dailySalary() {\n      if (!this.form.department_id) {\n        return 0\n      } else if (!this.form.person || !this.form.person.daily_salary) {\n        const departmentScale = this.salaryScale[this.form.department_id]\n        return departmentScale[this.form.position || 'artist'][\n          this.form.seniority || 'junior'\n        ].salary\n      } else {\n        return this.form.person.daily_salary\n      }\n    },\n\n    monthlySalary() {\n      return this.dailySalary * 20\n    },\n\n    totalSalary() {\n      if (!this.form.department_id) {\n        return 0\n      } else {\n        const duration = Math.min(this.form.months_duration, this.maxDuration)\n        return this.monthlySalary * duration\n      }\n    },\n\n    maxDuration() {\n      const startDate = parseSimpleDate(this.form.start_date)\n      const projectEndDate = parseSimpleDate(\n        this.currentProduction.end_date\n      ).endOf('month')\n      const maxDuration = projectEndDate.diff(startDate, 'months')\n      return maxDuration > 0 ? maxDuration : 1\n    },\n\n    departmentPeople() {\n      if (this.form.department_id) {\n        return this.activePeople.filter(person =>\n          person.departments.includes(this.form.department_id)\n        )\n      } else {\n        return this.activePeople\n      }\n    }\n  },\n\n  methods: {\n    ...mapActions(['']),\n\n    runConfirmation() {\n      this.$emit('confirm', {\n        ...this.form,\n        person_id: this.form.person?.id,\n        duration: Math.min(this.form.months_duration, this.maxDuration),\n        salary: this.monthlySalary,\n        total_salary: this.totalSalary\n      })\n    },\n\n    onPersonChanged(person) {\n      if (person) {\n        this.form.position = person.position || 'artist'\n        this.form.seniority = person.seniority || 'junior'\n      } else {\n        this.form.position = 'artist'\n        this.form.seniority = 'junior'\n      }\n    },\n\n    formatDate(date) {\n      return formatSimpleDate(date)\n    },\n\n    resetForm() {\n      if (this.isEditing) {\n        const person = this.personMap.get(this.budgetEntryToEdit.person_id)\n        Object.assign(this.form, {\n          id: this.budgetEntryToEdit.id,\n          department_id: this.budgetEntryToEdit.department_id,\n          person,\n          position: this.budgetEntryToEdit.position || 'artist',\n          seniority: this.budgetEntryToEdit.seniority || 'junior',\n          start_date: parseSimpleDate(\n            this.budgetEntryToEdit.start_date\n          ).toDate(),\n          months_duration: this.budgetEntryToEdit.months_duration,\n          daily_salary: this.budgetEntryToEdit.daily_salary\n        })\n        this.form.person = person\n        // Needed to bypass watcher\n        this.$nextTick(() => {\n          this.form.daily_salary = this.budgetEntryToEdit.daily_salary\n        })\n      } else {\n        this.form = {\n          id: null,\n          department_id: '',\n          person: null,\n          position: 'artist',\n          seniority: 'junior',\n          start_date: parseSimpleDate(this.currentProduction.start_date)\n            .startOf('month')\n            .toDate(),\n          months_duration: 1,\n          daily_salary: 0\n        }\n      }\n    }\n  },\n\n  watch: {\n    active() {\n      if (this.active) {\n        this.resetForm()\n        setTimeout(() => {\n          this.$refs.departmentField.focus()\n        }, 100)\n      }\n    },\n\n    dailySalary() {\n      this.form.daily_salary = this.dailySalary\n    },\n\n    budgetEntryToEdit() {\n      this.resetForm()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.salary-label {\n  display: inline-block;\n  font-weight: bold;\n  width: 120px;\n}\n\n.salary-value {\n  display: inline-block;\n  text-align: right;\n  width: 80px;\n}\n\n.month-duration {\n  margin-left: 1em;\n  width: 160px;\n}\n</style>\n","<template>\n  <page-layout>\n    <template #main>\n      <div class=\"flexcolumn page\">\n        <budget-header\n          :budgets=\"budgets\"\n          :budget-options=\"budgetOptions\"\n          :budget=\"currentBudget\"\n          :is-loading=\"loading.budgets\"\n          :is-error=\"errors.budgets\"\n          :is-error-expenses=\"errors.expenses\"\n          :is-loading-expenses=\"loading.expenses\"\n          :is-showing-expenses=\"expenses.showing\"\n          @change-budget=\"onChangeBudget\"\n          @delete-budget=\"onDeleteBudgetClicked\"\n          @edit-budget=\"onEditBudgetClicked\"\n          @export-budget=\"onExportBudgetClicked\"\n          @toggle-expenses=\"onToggleExpenses\"\n          @new-version=\"onNewBudgetVersionClicked\"\n        />\n\n        <budget-list\n          :budget-departments=\"budgetDepartments\"\n          :budget-entries=\"budgetEntries\"\n          :costs-months=\"costsMonths\"\n          :currency=\"currentBudget?.currency || 'USD'\"\n          :current-budget=\"currentBudget\"\n          :expenses=\"expenses.data\"\n          :is-error=\"errors.entries\"\n          :is-loading=\"loading.entries\"\n          :is-showing-expenses=\"expenses.showing\"\n          :months-between-start-and-now=\"monthsBetweenStartAndNow\"\n          :months-between-now-and-end=\"monthsBetweenNowAndEnd\"\n          :months-between-production-dates=\"monthsBetweenProductionDates\"\n          :salary-scale=\"salaryScale\"\n          :total-entry=\"totalEntry\"\n          @add-budget-entry=\"onAddBudgetEntry\"\n          @delete-budget-entry=\"deleteBudgetEntry\"\n          @edit-budget-entry=\"editBudgetEntry\"\n          v-if=\"currentBudget.id\"\n        />\n\n        <edit-budget-modal\n          :active=\"modals.createBudget\"\n          :budget-to-edit=\"budgetToEdit\"\n          :last-revision=\"lastRevision\"\n          :is-loading=\"loading.createBudget || loading.editBudget\"\n          :is-error=\"errors.createBudget || errors.editBudget\"\n          @cancel=\"modals.createBudget = false\"\n          @confirm=\"createBudget\"\n        />\n\n        <edit-budget-entry-modal\n          :active=\"modals.createBudgetEntry\"\n          :budget-entry-to-edit=\"budgetEntryToEdit\"\n          :is-loading=\"loading.createBudgetEntry\"\n          :is-error=\"errors.createBudgetEntry || errors.editBudgetEntry\"\n          :salary-scale=\"salaryScale\"\n          @cancel=\"modals.createBudgetEntry = false\"\n          @confirm=\"confirmCreateBudgetEntry\"\n        />\n\n        <hard-delete-modal\n          :active=\"modals.deleteBudget\"\n          :error-text=\"$t('budget.delete_budget_error')\"\n          :is-loading=\"loading.del\"\n          :is-error=\"errors.deleteBudget\"\n          :lock-text=\"currentBudget?.name\"\n          :text=\"$t('budget.delete_budget_message')\"\n          @cancel=\"modals.deleteBudget = false\"\n          @confirm=\"deleteBudget\"\n        />\n\n        <delete-modal\n          :active=\"modals.deleteBudgetEntry\"\n          :error-text=\"$t('budget.delete_budget_entry_error')\"\n          :is-loading=\"loading.deleteBudgetEntry\"\n          :is-error=\"errors.deleteBudgetEntry\"\n          :text=\"$t('budget.delete_budget_entry_message')\"\n          @cancel=\"modals.deleteBudgetEntry = false\"\n          @confirm=\"confirmDeleteBudgetEntry\"\n        />\n      </div>\n    </template>\n\n    <template #side>\n      <budget-analytics\n        :amount=\"totalEntry.total\"\n        :currency=\"currentBudget.currency\"\n        :budgets=\"budgets\"\n        :budget-departments=\"budgetDepartments\"\n        :budget-entries=\"budgetEntries\"\n        :months-between-production-dates=\"monthsBetweenProductionDates\"\n        :pie-chart-data=\"pieChartData\"\n        :pie-chart-colors=\"pieChartColors\"\n        :column-chart-data=\"columnChartData\"\n      />\n    </template>\n  </page-layout>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport moment from 'moment'\n\nimport { pageMixin } from '@/components/mixins/page'\nimport { formatMonth, parseSimpleDate } from '@/lib/time'\nimport csv from '@/lib/csv'\n\nimport BudgetAnalytics from '@/components/pages/budget/BudgetAnalytics.vue'\nimport BudgetHeader from '@/components/pages/budget/BudgetHeader.vue'\nimport BudgetList from '@/components/pages/budget/BudgetList.vue'\nimport DeleteModal from '@/components/modals/DeleteModal.vue'\nimport EditBudgetModal from '@/components/modals/EditBudgetModal.vue'\nimport EditBudgetEntryModal from '@/components/modals/EditBudgetEntryModal.vue'\nimport HardDeleteModal from '@/components/modals/HardDeleteModal.vue'\nimport PageLayout from '@/components/layouts/PageLayout.vue'\n\nconst helpers = {\n  resetDepartmentTotals(departmentData) {\n    departmentData.total = departmentData.persons.reduce(\n      (acc, person) => acc + person.total,\n      0\n    )\n    departmentData.monthCosts = departmentData.persons.reduce((acc, person) => {\n      Object.keys(person.monthCosts).forEach(month => {\n        acc[month] = (acc[month] || 0) + person.monthCosts[month]\n      })\n      return acc\n    }, {})\n  }\n}\n\nexport default {\n  name: 'budget',\n\n  mixins: [pageMixin],\n\n  components: {\n    BudgetAnalytics,\n    BudgetHeader,\n    BudgetList,\n    DeleteModal,\n    EditBudgetEntryModal,\n    EditBudgetModal,\n    HardDeleteModal,\n    PageLayout\n  },\n\n  data() {\n    return {\n      budgets: [],\n      budgetEntries: [],\n      budgetEntryToEdit: {},\n      budgetOptions: [],\n      budgetToEdit: {},\n      costsMonths: [],\n      currentBudget: {},\n      errors: {\n        budgets: false,\n        createBudget: false,\n        deleteBudget: false,\n        deleteBudgetEntry: false,\n        editBudget: false,\n        editBudgetEntry: false,\n        entries: false,\n        expenses: false\n      },\n      expenses: {\n        data: {},\n        showing: false\n      },\n      loading: {\n        budgets: true,\n        createBudget: false,\n        deleteBudget: false,\n        deleteBudgetEntry: false,\n        editBudget: false,\n        editBudgetEntry: false,\n        entries: true,\n        expenses: false\n      },\n      modals: {\n        createBudget: false,\n        createBudgetEntry: false,\n        editBudgetEntry: false,\n        deleteBudget: false,\n        deleteBudgetEntry: false\n      },\n      monthsBetweenProductionDates: [],\n      salaryScale: {}\n    }\n  },\n\n  async mounted() {\n    this.pageTitle = this.$t('budget.title')\n    await this.setSalaryScale()\n    await this.loadBudgets()\n    await this.loadBudgetEntries()\n    this.resetMonths()\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'departments',\n      'departmentMap',\n      'personMap'\n    ]),\n\n    monthsBetweenStartAndNow() {\n      return this.getMonthsBetweenDates(\n        this.currentProduction.start_date,\n        moment().format('YYYY-MM-DD')\n      )\n    },\n\n    monthsBetweenNowAndEnd() {\n      return this.getMonthsBetweenDates(\n        moment().add(1, 'month').format('YYYY-MM-DD'),\n        this.currentProduction.end_date\n      )\n    },\n\n    lastRevision() {\n      return this.budgets.length > 0 ? this.budgets[0].revision : 0\n    },\n\n    budgetDepartments() {\n      const departmentIds = new Set(\n        this.budgetEntries.map(entry => entry.department_id)\n      )\n      const budgetDepartments = []\n      Array.from(departmentIds).map(departmentId => {\n        const departmentEntries = this.budgetEntries.filter(\n          entry => entry.department_id === departmentId\n        )\n        const departmentData = {\n          id: departmentId,\n          monthCosts: {},\n          total: 0,\n          duration: 0,\n          persons: [],\n          start_date: null\n        }\n        departmentEntries.forEach(entry => {\n          const monthlySalary = entry.daily_salary * 20\n          const monthCosts = {}\n          let total = 0\n          entry.exceptions = entry.exceptions || {}\n          for (let i = 0; i < entry.months_duration; i++) {\n            const month = moment(entry.start_date).add(i, 'month')\n            const monthKey = month.format('YYYY-MM')\n            const monthCost = entry.exceptions[monthKey] || monthlySalary\n            monthCosts[monthKey] = monthCost\n            total += monthCost\n          }\n          departmentData.persons.push({\n            id: entry.id,\n            person_id: entry.person_id,\n            budget_entry_id: entry.id,\n            department_id: entry.department_id,\n            monthCosts,\n            position: entry.position,\n            seniority: entry.seniority,\n            total,\n            months_duration: entry.months_duration,\n            monthly_salary: monthlySalary,\n            daily_salary: entry.daily_salary,\n            start_date: entry.start_date,\n            exceptions: entry.exceptions\n          })\n          const startDate = moment(entry.start_date)\n          const departmentStartDate = moment(departmentData.start_date)\n          if (\n            !departmentData.start_date ||\n            startDate.isBefore(departmentStartDate)\n          ) {\n            departmentData.start_date = entry.start_date\n          }\n          departmentData.persons.sort(this.sortDepartmentPersons)\n        })\n        helpers.resetDepartmentTotals(departmentData)\n        budgetDepartments.push(departmentData)\n      })\n      budgetDepartments.sort((a, b) => {\n        const departmentA = this.departmentMap.get(a.id)\n        const departmentB = this.departmentMap.get(b.id)\n        return departmentA.name.localeCompare(departmentB.name)\n      })\n      return budgetDepartments\n    },\n\n    totalEntry() {\n      const total = this.budgetDepartments.reduce(\n        (acc, department) => acc + department.total,\n        0\n      )\n      const monthCosts = this.budgetDepartments.reduce((acc, department) => {\n        Object.keys(department.monthCosts).forEach(month => {\n          acc[month] = (acc[month] || 0) + department.monthCosts[month]\n        })\n        return acc\n      }, {})\n      return {\n        total,\n        monthCosts\n      }\n    },\n\n    pieChartData() {\n      return this.budgetDepartments.map(departmentEntry => {\n        const department = this.departmentMap.get(departmentEntry.id)\n        return [department.name, departmentEntry.total]\n      })\n    },\n\n    pieChartColors() {\n      return this.budgetDepartments.map(departmentEntry => {\n        const department = this.departmentMap.get(departmentEntry.id)\n        return department.color\n      })\n    },\n\n    columnChartData() {\n      return this.monthsBetweenProductionDates.map(monthDate => {\n        const monthKey = monthDate.format('YYYY-MM')\n        const [year, month] = monthKey.split('-')\n        const label = `${month}/${year.slice(2)}`\n        return [label, this.totalEntry.monthCosts[monthKey] || 0]\n      })\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'createProductionBudgetEntry',\n      'createProductionBudget',\n      'deleteProductionBudget',\n      'deleteProductionBudgetEntry',\n      'loadExpenses',\n      'loadProductionBudget',\n      'loadProductionBudgets',\n      'loadProductionBudgetEntry',\n      'loadProductionBudgetEntries',\n      'loadSalaryScale',\n      'updateProductionBudget',\n      'updateProductionBudgetEntry'\n    ]),\n\n    formatMonth,\n\n    resetMonths() {\n      this.monthsBetweenProductionDates = this.getMonthsBetweenDates(\n        this.currentProduction.start_date,\n        this.currentProduction.end_date\n      )\n      this.costsMonths = this.monthsBetweenProductionDates.map(month => {\n        return month.format('YYYY-MM')\n      })\n    },\n\n    sortDepartmentPersons(a, b) {\n      const seniorityWeight = {\n        junior: 1,\n        mid: 2,\n        senior: 3\n      }\n      const positionWeight = {\n        artist: 1,\n        lead: 2,\n        supervisor: 3\n      }\n      const seniorityA = seniorityWeight[a.seniority]\n      const seniorityB = seniorityWeight[b.seniority]\n      const positionA = positionWeight[a.position]\n      const positionB = positionWeight[b.position]\n      if (a.person_id === null && b.person_id === null) {\n        if (positionA === positionB) {\n          return seniorityB - seniorityA\n        } else {\n          return positionB - positionA\n        }\n      } else if (a.person_id === null) {\n        return 1\n      } else if (b.person_id === null) {\n        return -1\n      } else {\n        const personA = this.personMap.get(a.person_id)\n        const personB = this.personMap.get(b.person_id)\n        if (personA.name === personB.name) {\n          if (positionA === positionB) {\n            return seniorityB - seniorityA\n          } else {\n            return positionB - positionA\n          }\n        } else {\n          return personA.name.localeCompare(personB.name)\n        }\n      }\n    },\n\n    async setSalaryScale() {\n      this.salaryScale = await this.loadSalaryScale()\n    },\n\n    onChangeBudget(budget) {\n      this.currentBudget = budget\n    },\n\n    onEditBudgetClicked() {\n      this.budgetToEdit = this.currentBudget\n      this.modals.createBudget = true\n    },\n\n    onExportBudgetClicked() {\n      const nameData = [\n        this.$t('budget.title').toLowerCase(),\n        this.currentProduction.name,\n        `v${this.currentBudget.revision}`,\n        this.currentBudget.name,\n        this.currentBudget.currency\n      ]\n      csv.generateBudget(\n        this.$t,\n        this.departmentMap,\n        this.personMap,\n        nameData,\n        this.currentBudget.currency,\n        this.monthsBetweenProductionDates,\n        this.totalEntry,\n        this.budgetDepartments\n      )\n    },\n\n    onNewBudgetVersionClicked() {\n      this.budgetToEdit = {}\n      this.modals.createBudget = true\n    },\n\n    async createBudget(budget) {\n      try {\n        this.loading.createBudget = true\n        if (budget.id) {\n          await this.updateProductionBudget({\n            productionId: this.currentProduction.id,\n            budget: {\n              id: this.currentBudget.id,\n              name: budget.name,\n              currency: budget.currency\n            }\n          })\n          const oldBudget = this.budgets.find(\n            b => b.id === this.currentBudget.id\n          )\n          if (oldBudget) {\n            Object.assign(oldBudget, {\n              name: budget.name,\n              currency: budget.currency\n            })\n          }\n        } else {\n          this.loading.createBudget = true\n          const newBudget = await this.createProductionBudget({\n            productionId: this.currentProduction.id,\n            budget\n          })\n          this.budgets.unshift(newBudget)\n          this.currentBudget = newBudget\n        }\n        this.resetBudgetOptions()\n        this.modals.createBudget = false\n      } catch (error) {\n        console.error(error)\n        this.errors.createBudget = true\n      } finally {\n        this.loading.createBudget = false\n      }\n    },\n\n    onDeleteBudgetClicked() {\n      this.errors.deleteBudget = false\n      this.modals.deleteBudget = true\n    },\n\n    async deleteBudget() {\n      this.loading.deleteBudget = true\n      try {\n        await this.deleteProductionBudget({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id\n        })\n        this.postDeleteBudget(this.currentBudget)\n        this.modals.deleteBudget = false\n      } catch (error) {\n        console.error(error)\n        this.errors.deleteBudget = true\n      } finally {\n        this.loading.deleteBudget = false\n      }\n    },\n\n    postDeleteBudget(budget) {\n      this.budgets = this.budgets.filter(b => b.id !== budget.id)\n      this.resetBudgetOptions()\n      if (this.budgets.length > 0) {\n        this.currentBudget = this.budgets[0]\n      } else {\n        this.currentBudget = {}\n      }\n    },\n\n    onAddBudgetEntry() {\n      this.budgetEntryToEdit = {}\n      this.modals.createBudgetEntry = true\n    },\n\n    async confirmCreateBudgetEntry(budgetEntry) {\n      if (budgetEntry.id) {\n        await this.runRemoteBudgetEntryEdition(budgetEntry)\n      } else {\n        await this.runRemoteBudgetEntryCreation(budgetEntry)\n      }\n    },\n\n    async runRemoteBudgetEntryCreation(budgetEntry) {\n      try {\n        this.loading.createBudgetEntry = true\n        await this.createProductionBudgetEntry({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id,\n          budgetEntry: {\n            ...budgetEntry,\n            person_id: budgetEntry.person ? budgetEntry.person.id : null\n          }\n        })\n        this.modals.createBudgetEntry = false\n      } catch (error) {\n        console.error(error)\n        this.errors.createBudgetEntry = true\n      } finally {\n        this.loading.createBudgetEntry = false\n      }\n    },\n\n    editBudgetEntry(budgetEntry) {\n      this.budgetEntryToEdit = budgetEntry\n      this.modals.createBudgetEntry = true\n    },\n\n    async runRemoteBudgetEntryEdition(budgetEntry) {\n      try {\n        this.loading.editBudgetEntry = true\n        this.errors.editBudgetEntry = false\n        await this.updateProductionBudgetEntry({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id,\n          budgetEntryId: budgetEntry.id,\n          budgetEntry: {\n            id: budgetEntry.id,\n            department_id: budgetEntry.department_id,\n            person_id: budgetEntry.person ? budgetEntry.person.id : null,\n            position: budgetEntry.position,\n            seniority: budgetEntry.seniority,\n            start_date: budgetEntry.start_date,\n            months_duration: budgetEntry.duration,\n            daily_salary: budgetEntry.daily_salary\n          }\n        })\n        this.modals.createBudgetEntry = false\n      } catch (error) {\n        console.error(error)\n        this.errors.editBudgetEntry = true\n      } finally {\n        this.loading.editBudgetEntry = false\n      }\n    },\n\n    afterEditBudgetEntry(budgetEntry) {\n      const oldBudgetEntry = this.budgetEntries.find(\n        b => b.id === budgetEntry.id\n      )\n      if (oldBudgetEntry) {\n        Object.assign(oldBudgetEntry, budgetEntry)\n      }\n    },\n\n    async deleteBudgetEntry(budgetEntry) {\n      this.loading.deleteBudgetEntry = false\n      this.errors.deleteBudgetEntry = false\n      this.modals.deleteBudgetEntry = true\n      this.budgetEntryToDelete = budgetEntry\n    },\n\n    async confirmDeleteBudgetEntry() {\n      this.loading.deleteBudgetEntry = true\n      try {\n        await this.deleteProductionBudgetEntry({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id,\n          budgetEntryId: this.budgetEntryToDelete.budget_entry_id\n        })\n        this.postDeleteBudgetEntry(this.budgetEntryToDelete)\n        this.modals.deleteBudgetEntry = false\n      } catch (error) {\n        console.error(error)\n        this.errors.deleteBudgetEntry = true\n      } finally {\n        this.loading.deleteBudgetEntry = false\n      }\n    },\n\n    postDeleteBudgetEntry(budgetEntry) {\n      this.budgetEntries = this.budgetEntries.filter(\n        entry => entry.id !== budgetEntry.id\n      )\n    },\n\n    async loadBudgets() {\n      try {\n        this.loading.budgets = true\n        this.errors.budgets = false\n        this.budgets = await this.loadProductionBudgets(\n          this.currentProduction.id\n        )\n        this.budgets.sort((a, b) => b.revision - a.revision)\n        this.currentBudget = this.budgets.length > 0 ? this.budgets[0] : {}\n        this.resetBudgetOptions()\n      } catch (error) {\n        console.error(error)\n        this.errors.budgets = true\n      } finally {\n        this.loading.budgets = false\n      }\n    },\n\n    async loadBudgetEntries() {\n      if (!this.currentBudget || !this.currentBudget.id) return\n      try {\n        this.loading.entries = true\n        this.errors.entries = false\n        this.budgetEntries = await this.loadProductionBudgetEntries({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id\n        })\n      } catch (error) {\n        console.error(error)\n        this.errors.entries = true\n      } finally {\n        this.loading.entries = false\n      }\n    },\n\n    resetBudgetOptions() {\n      this.budgetOptions = this.budgets.map(budget => {\n        return {\n          label: `v${budget.revision} - ${budget.name}`,\n          value: budget\n        }\n      })\n    },\n\n    getMonthsBetweenDates(startDate, endDate) {\n      const months = []\n      const current = parseSimpleDate(startDate)\n      const end = parseSimpleDate(endDate)\n      while (current <= end) {\n        months.push(current.clone())\n        current.add(1, 'month')\n      }\n      return months\n    },\n\n    async onToggleExpenses() {\n      if (!this.expenses.showing) {\n        try {\n          this.loading.expenses = true\n          this.expenses.data = await this.loadExpenses(\n            this.currentProduction.id\n          )\n        } catch (error) {\n          console.error(error)\n          this.errors.expenses = true\n        } finally {\n          this.loading.expenses = false\n        }\n      }\n      this.expenses.showing = !this.expenses.showing\n    }\n  },\n\n  watch: {\n    currentProduction() {\n      this.loadBudgets()\n      this.resetMonths()\n    },\n\n    currentBudget() {\n      this.loadBudgetEntries()\n    }\n  },\n\n  socket: {\n    events: {\n      'budget:create': async function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        const budget = await this.loadProductionBudget({\n          productionId: this.currentProduction.id,\n          budgetId: data.budget_id\n        })\n        const oldBudget = this.budgets.find(b => b.id === budget.id)\n        if (budget && !oldBudget) {\n          this.budgets.unshift(budget)\n          this.resetBudgetOptions()\n        }\n      },\n\n      'budget:update': async function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        const budget = await this.loadProductionBudget({\n          productionId: this.currentProduction.id,\n          budgetId: data.budget_id\n        })\n        if (budget) {\n          const oldBudget = this.budgets.find(b => b.id === budget.id)\n          if (oldBudget) {\n            Object.assign(oldBudget, {\n              name: budget.name,\n              currency: budget.currency\n            })\n            this.resetBudgetOptions()\n          }\n        }\n      },\n\n      'budget:delete': function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        const oldBudget = this.budgets.find(b => b.id === data.budget_id)\n        const isCurrentBudgetDeleted = this.currentBudget.id === data.budget_id\n        if (oldBudget) {\n          this.budgets = this.budgets.filter(b => b.id !== data.budget_id)\n          this.resetBudgetOptions()\n          if (isCurrentBudgetDeleted) {\n            this.currentBudget = this.budgets[0]\n          }\n        }\n      },\n\n      'budget-entry:create': async function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        if (data.budget_id !== this.currentBudget.id) return\n        const oldBudgetEntry = this.budgetEntries.find(\n          b => b.id === data.budget_entry_id\n        )\n        if (oldBudgetEntry) return\n        const budgetEntry = await this.loadProductionBudgetEntry({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id,\n          budgetEntryId: data.budget_entry_id\n        })\n        this.budgetEntries.push(budgetEntry)\n      },\n\n      'budget-entry:update': async function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        if (data.budget_id !== this.currentBudget.id) return\n        const oldBudgetEntry = this.budgetEntries.find(\n          b => b.id === data.budget_entry_id\n        )\n        if (!oldBudgetEntry) return\n\n        const budgetEntry = await this.loadProductionBudgetEntry({\n          productionId: this.currentProduction.id,\n          budgetId: this.currentBudget.id,\n          budgetEntryId: data.budget_entry_id\n        })\n        this.afterEditBudgetEntry(budgetEntry)\n      },\n\n      'budget-entry:delete': async function (data) {\n        if (data.project_id !== this.currentProduction.id) return\n        if (data.budget_id !== this.currentBudget.id) return\n        const oldBudgetEntry = this.budgetEntries.find(\n          b => b.id === data.budget_entry_id\n        )\n        if (!oldBudgetEntry) return\n        this.postDeleteBudgetEntry({ id: data.budget_entry_id })\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.budget-data {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  max-height: calc(100vh - 140px);\n}\n</style>\n"],"names":["pageMixin","mapGetters","_sfc_main","domMixin","grabListMixin","ButtonSimple","ChevronDownIcon","ChevronRightIcon","PeopleName","PeopleAvatar","RowActionsCell","Spinner","key","preferences","convertedExpenses","expenses","total","departmentId","departmentTotal","personId","personTotal","dailyRate","month","timeSpent","cost","existingDepartments","acc","department","newDepartments","extendedBudgetDepartments","existingEntries","entry","person","differences","expense","personDifference","mapActions","deparmentId","salaryScale","days","personEntry","monthKey","opacity","value","exceptions","budgetEntry","_hoisted_1","_hoisted_4","_hoisted_6","_hoisted_7","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_23","_hoisted_26","_hoisted_27","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_39","_hoisted_41","_openBlock","_createElementBlock","$props","_hoisted_2","_createVNode","_component_spinner","_hoisted_3","_createElementVNode","_toDisplayString","_ctx","_hoisted_5","_component_button_simple","_hoisted_8","_hoisted_9","_hoisted_12","_Fragment","_renderList","_createCommentVNode","args","_hoisted_22","$options","_hoisted_24","_hoisted_25","_normalizeClass","departmentEntry","$event","_hoisted_28","_normalizeStyle","$data","_createBlock","_component_chevron_right_icon","_component_chevron_down_icon","_component_people_avatar","_component_people_name","_hoisted_34","_hoisted_37","_hoisted_38","_hoisted_40","_component_row_actions_cell","modalMixin","_renderSlot","BaseModal","Combobox","ModalFooter","TextField","_component_base_modal","_withCtx","_cache","_withModifiers","_component_text_field","_component_combobox","_component_modal_footer","ComboboxNumber","range","moment","years","startYear","endYear","year","currentYear","minMonth","maxMonth","newMonth","date","newYear","_component_combobox_number","ComboboxDepartment","MonthField","PeopleField","parseSimpleDate","startDate","projectEndDate","endDate","duration","maxDuration","formatSimpleDate","_component_combobox_department","_component_people_field","_component_month_field","helpers","departmentData","BudgetAnalytics","BudgetHeader","BudgetList","DeleteModal","EditBudgetEntryModal","EditBudgetModal","HardDeleteModal","PageLayout","departmentIds","budgetDepartments","departmentEntries","monthlySalary","monthCosts","i","monthCost","departmentStartDate","a","b","departmentA","departmentB","monthDate","formatMonth","seniorityWeight","positionWeight","seniorityA","seniorityB","positionA","positionB","personA","personB","budget","nameData","csv","oldBudget","newBudget","error","oldBudgetEntry","months","current","end","data","isCurrentBudgetDeleted","_component_page_layout","_component_budget_header","_component_budget_list","_component_edit_budget_modal","_component_edit_budget_entry_modal","_component_hard_delete_modal","_component_delete_modal","_component_budget_analytics"],"mappings":"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"}