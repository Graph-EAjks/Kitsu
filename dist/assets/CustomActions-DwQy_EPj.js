import{_ as y,s as b,a1 as E,T as g,r,o as u,c as f,e as s,t as n,F as k,g as A,f as c,a4 as v,C as T,a5 as x,a6 as w,a8 as D,k as $,a9 as V,n as j,p as B,aa as L,m as F,b as M,ab as N,ac as U}from"./index-VIyWXLb8.js";import{L as I}from"./ListPageHeader-BhKajpf7.js";const O={name:"custom-action-list",mixins:[b],components:{RowActionsCell:E,TableInfo:g},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"]},S={class:"data-list"},H={class:"datatable-wrapper"},z={class:"datatable"},G={class:"datatable-head"},K={scope:"col",class:"name"},P={scope:"col",class:"url"},R={scope:"col",class:"entity-type"},q={scope:"col",class:"is-ajax"},J={class:"datatable-body"},Q={scope:"row",class:"name datatable-row-header"},W={class:"url"},X={class:"entity-type"},Y={class:"is-ajax"},Z={class:"has-text-centered nb-custom-actions"};function ee(e,t,i,m,o,l){const _=r("row-actions-cell"),h=r("table-info");return u(),f("div",S,[s("div",H,[s("table",z,[s("thead",G,[s("tr",null,[s("th",K,n(e.$t("custom_actions.fields.name")),1),s("th",P,n(e.$t("custom_actions.fields.url")),1),s("th",R,n(e.$t("custom_actions.fields.entity_type")),1),s("th",q,n(e.$t("custom_actions.fields.is_ajax")),1),t[0]||(t[0]=s("th",{scope:"col",class:"actions"},"Â ",-1))])]),s("tbody",J,[(u(!0),f(k,null,A(i.entries,a=>(u(),f("tr",{class:"datatable-row",key:a.id},[s("td",Q,n(a.name),1),s("td",W,n(a.url),1),s("td",X,n(a.entity_type),1),s("td",Y,n(e.formatBoolean(a.is_ajax)),1),c(_,{"entry-id":a.id,onEditClicked:p=>e.$emit("edit-clicked",a),onDeleteClicked:p=>e.$emit("delete-clicked",a)},null,8,["entry-id","onEditClicked","onDeleteClicked"])]))),128))])])]),c(h,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"]),s("p",Z,n(i.entries.length)+" "+n(e.$tc("custom_actions.number",i.entries.length)),1)])}const te=y(O,[["render",ee],["__scopeId","data-v-ecfc0a28"]]),oe={name:"edit-custom-action-modal",mixins:[v],components:{Combobox:T,ComboboxBoolean:x,ModalFooter:w,TextField:D},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},customActionToEdit:{type:Object,default:()=>{}}},emits:["cancel","confirm"],data(){return{form:{name:"",url:"",entityType:"all",isAjax:"false"},entityTypeOptions:[{label:"all",value:"all"},{label:"asset",value:"asset"},{label:"shot",value:"shot"}]}},methods:{confirmClicked(){this.$emit("confirm",this.form)},isEditing(){return this.customActionToEdit&&this.customActionToEdit.id}},watch:{customActionToEdit(){this.customActionToEdit&&(this.form={name:this.customActionToEdit.name,url:this.customActionToEdit.url,entityType:this.customActionToEdit.entity_type,isAjax:(!!this.customActionToEdit.is_ajax).toString()})},active(){this.active&&setTimeout(()=>{this.$refs.nameField.focus()},100)}}},se={class:"modal-content"},ie={class:"box"},le={key:0,class:"title"},ne={key:1,class:"title"};function ae(e,t,i,m,o,l){const _=r("text-field"),h=r("combobox"),a=r("combobox-boolean"),p=r("modal-footer"),C=$("focus");return u(),f("div",{class:B({modal:!0,"is-active":i.active})},[s("div",{class:"modal-background",onClick:t[0]||(t[0]=d=>e.$emit("cancel"))}),s("div",se,[s("div",ie,[l.isEditing()?(u(),f("h1",le,n(e.$t("custom_actions.edit_title"))+" "+n(i.customActionToEdit.name),1)):(u(),f("h1",ne,n(e.$t("custom_actions.new_custom_action")),1)),s("form",{onSubmit:t[5]||(t[5]=V(()=>{},["prevent"]))},[j(c(_,{ref:"nameField",label:e.$t("custom_actions.fields.name"),modelValue:o.form.name,"onUpdate:modelValue":t[1]||(t[1]=d=>o.form.name=d)},null,8,["label","modelValue"]),[[C]]),c(_,{label:e.$t("custom_actions.fields.url"),placeholder:"https://...",type:"url",modelValue:o.form.url,"onUpdate:modelValue":t[2]||(t[2]=d=>o.form.url=d),modelModifiers:{trim:!0},onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"]),c(h,{label:e.$t("custom_actions.fields.entity_type"),options:o.entityTypeOptions,modelValue:o.form.entityType,"onUpdate:modelValue":t[3]||(t[3]=d=>o.form.entityType=d),"locale-key-prefix":"custom_actions.entity_types.",onEnter:l.confirmClicked},null,8,["label","options","modelValue","onEnter"]),c(a,{label:e.$t("custom_actions.fields.is_ajax"),modelValue:o.form.isAjax,"onUpdate:modelValue":t[4]||(t[4]=d=>o.form.isAjax=d),onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"])],32),c(p,{"error-text":e.$t("custom_actions.create_error"),"is-error":i.isError,onConfirm:l.confirmClicked,onCancel:t[6]||(t[6]=d=>e.$emit("cancel"))},null,8,["error-text","is-error","onConfirm"])])])],2)}const ce=y(oe,[["render",ae],["__scopeId","data-v-6aceb4ab"]]),re={name:"custom-actions",components:{CustomActionList:te,DeleteModal:L,EditCustomActionModal:ce,ListPageHeader:I},data(){return{modals:{edit:!1,del:!1},loading:{edit:!1,del:!1,list:!1},errors:{edit:!1,del:!1,list:!1},customActionToDelete:null,customActionToEdit:null}},computed:{...F(["customActions"]),deleteText(){const e=this.customActionToDelete;return e?this.$t("custom_actions.delete_text",{name:e.name}):""}},created(){this.loading.list=!0,this.errors.list=!1,this.loadCustomActions(e=>{this.loading.list=!1,e&&(this.errors.list=!0)})},methods:{...M(["deleteCustomAction","editCustomAction","loadCustomActions","newCustomAction"]),confirmEditCustomAction(e){let t="newCustomAction";this.customActionToEdit&&this.customActionToEdit.id&&(t="editCustomAction",e.id=this.customActionToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[t](e).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(i=>{console.error(i),this.errors.edit=!0,this.modals.isNewDisplayed=!1})},confirmDeleteCustomAction(){this.loading.del=!0,this.errors.del=!1,this.deleteCustomAction(this.customActionToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(e=>{console.error(e),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const e=N.slugify(this.$t("custom_actions.title")),i=[[this.$t("main.type"),this.$t("custom_actions.fields.name"),this.$t("custom_actions.fields.url"),this.$t("custom_actions.fields.entity_type"),this.$t("custom_actions.fields.is_ajax")]].concat(this.customActions.map(m=>[m.type,m.name,m.url,m.entity_type,m.is_ajax]));U.buildCsvFile(e,i)},onNewClicked(){this.customActionToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(e){this.customActionToEdit=e,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(e){this.customActionToDelete=e,this.errors.del=!1,this.modals.del=!0}},head(){return{title:`${this.$t("custom_actions.title")} - Kitsu`}}},de={class:"custom-actions page fixed-page"};function me(e,t,i,m,o,l){const _=r("list-page-header"),h=r("custom-action-list"),a=r("edit-custom-action-modal"),p=r("delete-modal");return u(),f("div",de,[c(_,{title:e.$t("custom_actions.title"),"new-entry-label":e.$t("custom_actions.new_custom_action"),onExportClicked:l.onExportClicked,onNewClicked:l.onNewClicked},null,8,["title","new-entry-label","onExportClicked","onNewClicked"]),c(h,{entries:e.customActions,"is-loading":o.loading.list,"is-error":o.errors.list,onEditClicked:l.onEditClicked,onDeleteClicked:l.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),c(a,{active:o.modals.edit,"is-loading":o.loading.edit,"is-error":o.errors.edit,"custom-action-to-edit":o.customActionToEdit,onCancel:t[0]||(t[0]=C=>o.modals.edit=!1),onConfirm:l.confirmEditCustomAction},null,8,["active","is-loading","is-error","custom-action-to-edit","onConfirm"]),c(p,{active:o.modals.del,"is-loading":o.loading.del,"is-error":o.errors.del,text:l.deleteText,"error-text":e.$t("custom_actions.delete_error"),onCancel:t[1]||(t[1]=C=>o.modals.del=!1),onConfirm:l.confirmDeleteCustomAction},null,8,["active","is-loading","is-error","text","error-text","onConfirm"])])}const _e=y(re,[["render",me]]);export{_e as default};
//# sourceMappingURL=CustomActions-DwQy_EPj.js.map
