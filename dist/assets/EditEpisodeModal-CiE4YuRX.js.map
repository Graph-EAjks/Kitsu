{"version":3,"file":"EditEpisodeModal-CiE4YuRX.js","sources":["../../src/components/modals/EditEpisodeModal.vue"],"sourcesContent":["<template>\n  <div\n    :class=\"{\n      modal: true,\n      'is-active': active\n    }\"\n  >\n    <div class=\"modal-background\" @click=\"$emit('cancel')\"></div>\n\n    <div class=\"modal-content\">\n      <div class=\"box\">\n        <h1 class=\"title\" v-if=\"episodeToEdit && episodeToEdit.id\">\n          {{ $t('episodes.edit_title') }} {{ episodeToEdit.name }}\n        </h1>\n        <h1 class=\"title\" v-else>\n          {{ $t('episodes.new_episode') }}\n        </h1>\n\n        <form @submit.prevent>\n          <text-field\n            ref=\"nameField\"\n            :label=\"$t('episodes.fields.name')\"\n            v-model.trim=\"form.name\"\n            @enter=\"runConfirmation\"\n            v-focus\n          />\n\n          <combobox-styled\n            class=\"field\"\n            :label=\"$t('main.status')\"\n            :options=\"episodeStatusOptions\"\n            v-model=\"form.status\"\n          />\n\n          <text-field\n            ref=\"resolutionField\"\n            :label=\"$t('shots.fields.resolution')\"\n            v-model=\"form.data.resolution\"\n            @enter=\"runConfirmation\"\n          />\n\n          <textarea-field\n            ref=\"descriptionField\"\n            :label=\"$t('episodes.fields.description')\"\n            @keyup.ctrl.enter=\"runConfirmation\"\n            @keyup.meta.enter=\"runConfirmation\"\n            v-model=\"form.description\"\n          />\n\n          <template v-if=\"episodeToEdit\">\n            <metadata-field\n              :key=\"descriptor.id\"\n              :descriptor=\"descriptor\"\n              :entity=\"episodeToEdit\"\n              @enter=\"runConfirmation\"\n              v-model=\"form.data[descriptor.field_name]\"\n              v-for=\"descriptor in episodeMetadataDescriptors\"\n            />\n          </template>\n        </form>\n\n        <modal-footer\n          :error-text=\"$t('episodes.edit_error')\"\n          :is-loading=\"isLoading\"\n          :is-error=\"isError\"\n          @confirm=\"runConfirmation\"\n          @cancel=\"$emit('cancel')\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\n\nimport { modalMixin } from '@/components/modals/base_modal'\n\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport MetadataField from '@/components/widgets/MetadataField.vue'\nimport ModalFooter from '@/components/modals/ModalFooter.vue'\nimport TextField from '@/components/widgets/TextField.vue'\nimport TextareaField from '@/components/widgets/TextareaField.vue'\n\nexport default {\n  name: 'edit-episode-modal',\n\n  mixins: [modalMixin],\n\n  components: {\n    ComboboxStyled,\n    MetadataField,\n    ModalFooter,\n    TextField,\n    TextareaField\n  },\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    episodeToEdit: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  emits: ['cancel', 'confirm'],\n\n  data() {\n    let form = {\n      id: '',\n      name: '',\n      description: '',\n      fps: '',\n      data: {\n        resolution: ''\n      }\n    }\n    if (this.episodeToEdit && this.episodeToEdit.id) {\n      form = {\n        id: this.episodeToEdit.id,\n        name: this.episodeToEdit.name,\n        description: this.episodeToEdit.description,\n        production_id: this.episodeToEdit.project_id,\n        data:\n          {\n            ...this.episodeToEdit.data,\n            resolution: this.episodeToEdit.data.resolution || ''\n          } || {}\n      }\n    }\n    return {\n      form,\n      episodeSuccessText: '',\n      episodeStatusOptions: [\n        { label: 'canceled', value: 'canceled' },\n        { label: 'complete', value: 'complete' },\n        { label: 'running', value: 'running' },\n        { label: 'standby', value: 'standby' }\n      ]\n    }\n  },\n\n  computed: {\n    ...mapGetters(['episodeMetadataDescriptors'])\n  },\n\n  methods: {\n    runConfirmation() {\n      this.$emit('confirm', this.form)\n    },\n\n    isEditing() {\n      return this.episodeToEdit && this.episodeToEdit.id\n    },\n\n    resetForm() {\n      this.episodeSuccessText = ''\n      if (!this.isEditing()) {\n        this.form.id = null\n        this.form.name = ''\n        this.form.status = 'running'\n        this.form.description = ''\n        this.form.data = {}\n      } else {\n        this.form = {\n          id: this.episodeToEdit.id,\n          name: this.episodeToEdit.name,\n          status: this.episodeToEdit.status,\n          description: this.episodeToEdit.description,\n          data:\n            {\n              ...this.episodeToEdit.data,\n              resolution: this.episodeToEdit.data.resolution || ''\n            } || {}\n        }\n      }\n    }\n  },\n\n  mounted() {\n    this.resetForm()\n  },\n\n  watch: {\n    active() {\n      if (this.active) {\n        this.resetForm()\n      }\n    },\n\n    episodeToEdit() {\n      this.resetForm()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-content .box p.text {\n  margin-bottom: 1em;\n}\n.is-danger {\n  color: #ff3860;\n  font-style: italic;\n}\n\n.info-message {\n  margin-top: 1em;\n}\n</style>\n"],"names":["_sfc_main","modalMixin","ComboboxStyled","MetadataField","ModalFooter","TextField","TextareaField","form","mapGetters","_hoisted_1","_hoisted_2","_createElementBlock","_normalizeClass","$props","_createElementVNode","_ctx","_hoisted_3","_toDisplayString","_hoisted_4","_cache","_withModifiers","_createVNode","_component_text_field","$data","$event","$options","_component_combobox_styled","_component_textarea_field","_withKeys","_openBlock","_Fragment","_renderList","descriptor","_createBlock","_component_metadata_field","_createCommentVNode","_component_modal_footer"],"mappings":"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"}