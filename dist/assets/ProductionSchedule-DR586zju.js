import{ch as q,_ as L,B as R,b5 as G,aC as H,aD as X,O as W,aj as K,aF as Z,aE as J,Y as $,y as ee,ce as te,Z as se,aa as ne,bU as ae,A as O,m as ie,aH as j,bN as le,a0 as E,ci as oe,bX as z,cj as de,M as re,b as ce,bI as _,ck as U,cl as ue,cm as Q,cn as he,co as me,bO as fe,r as y,o as c,c as u,e as d,t as D,f as h,l as Y,d as V,F as B,g as C,ab as _e,G as N,a5 as pe}from"./index-BzEHCGL3.js";/**
 * @license lucide-vue-next v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=q("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-vue-next v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=q("list-restart",[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]]),De={name:"production-schedule",components:{ButtonSimple:R,Checkbox:G,ChevronDownIcon:H,ChevronRightIcon:X,ComboboxNumber:W,DateField:K,GripVerticalIcon:ge,ListRestartIcon:ye,PeopleAvatar:Z,PeopleName:J,Schedule:$,Spinner:ee,TrashIcon:te,TaskTypeName:se,TextField:ne,XIcon:ae},data(){return{assignments:{assigned:!1,entityTypes:null,excludes:[],forcedDailyQuota:null,item:null,loading:!1,saving:!1,startDate:null,endDate:null,unassign:!1},daysOffByPerson:[],draggedEntities:[],endDate:O().add(6,"months").endOf("day"),scheduleItems:[],startDate:O().startOf("day"),selectedStartDate:null,selectedEndDate:null,selectedTaskType:null,zoomLevel:1,zoomOptions:[{label:this.$t("main.week"),value:0},{label:"1",value:1},{label:"2",value:2},{label:"3",value:3}],loading:{schedule:!1},errors:{schedule:!1}}},mounted(){this.reset()},computed:{...ie(["currentEpisode","currentProduction","isCurrentUserManager","isCurrentUserSupervisor","isTVShow","organisation","personMap","productionAssetTypes","user"]),estimatedDailyQuota(){const e=j(this.assignments.startDate),t=j(this.assignments.endDate),a=le(e,t),l=this.draggedEntities.reduce((n,r)=>{var P;return n+(((P=r.children)==null?void 0:P.length)??0)},0),s=this.availablePersons.length;return a&&s?l/a/s:0},assetMap(){return E.cache.assetMap},assets(){return E.cache.assets},assetTypeMap(){return oe.cache.assetTypeMap},availablePersons(){const e=this.taskTypeMap.get(this.selectedTaskType.task_type_id);return this.team.filter(t=>!this.assignments.excludes.includes(t.id)&&t.role!=="client"&&(!t.departments.length||t.departments.includes(e==null?void 0:e.department_id)))},hasDraggedEntities(){return this.draggedEntities.some(e=>e.children.length)},shotMap(){return z.cache.shotMap},shots(){return z.cache.shots},taskTypeMap(){return de.cache.taskTypeMap},team(){return re(this.currentProduction.team.map(e=>this.personMap.get(e)).filter(e=>e&&!e.is_bot))}},methods:{...ce(["assignSelectedTasks","editProduction","loadAggregatedPersonDaysOff","loadAssets","loadAssetTypeScheduleItems","loadEpisodeScheduleItems","loadScheduleItems","loadSequenceScheduleItems","loadShots","loadTasks","saveScheduleItem","unassignSelectedTasks","updateTask"]),loadData(){this.loading.schedule=!0,this.loadScheduleItems(this.currentProduction).then(e=>{const t=_(this.selectedStartDate),a=_(this.selectedEndDate);e=e.map(l=>{const s=this.taskTypeMap.get(l.task_type_id);let n,r;l.start_date?n=_(l.start_date):n=O(),n.isSameOrAfter(a)&&(n=a.clone().add(-1,"days")),n.isBefore(t)&&(n=t.clone()),l.end_date?r=_(l.end_date):r=n.clone().add(1,"days"),r.isSameOrAfter(a)&&(r=a.clone());const P=U(s.id,this.currentProduction.id,this.currentEpisode?this.currentEpisode.id:null,s.for_entity);return{...l,color:s.color,for_entity:s.for_entity,name:`${s.for_entity} / ${s.name}`,priority:s.priority,startDate:n,endDate:r,editable:this.isInDepartment(s),expanded:!1,loading:!1,route:s.for_entity==="Shot"&&this.isTVShow?null:P,children:[]}}),this.scheduleItems=ue(e,this.currentProduction,this.taskTypeMap),this.loading.schedule=!1}).catch(e=>{console.error(e),this.loading.schedule=!1})},reset(){this.closeSidePanel(),this.currentProduction.start_date&&(this.startDate=_(this.currentProduction.start_date)),this.currentProduction.end_date&&(this.endDate=_(this.currentProduction.end_date)),this.selectedStartDate=this.startDate.toDate(),this.selectedEndDate=this.endDate.toDate(),this.loadData()},convertScheduleItems(e,t){return t.map(a=>{let l;a.start_date?l=_(a.start_date):l=O(),l.isBefore(this.startDate)&&(l=this.startDate.clone()),l.isAfter(this.endDate)&&(l=this.endDate.clone());let s;a.end_date?s=_(a.end_date):s=l.clone().add(1,"days"),s.isBefore(l)&&(s=l.clone().add(1,"days")),s.isAfter(this.endDate)&&(s=this.endDate.clone());const n={...a,startDate:l,endDate:s,expanded:!1,loading:!1,editable:this.isInDepartment(this.taskTypeMap.get(a.task_type_id)),children:[],parentElement:e};return this.isTVShow&&(n.route=U(a.task_type_id,this.currentProduction.id,a.object_id,e.for_entity)),n})},async expandTaskTypeElement(e,t=null,a=!1,l=!0,s=null){if(e.expanded=a||!e.expanded,e.expanded){try{e.loading=!0,this.selectedTaskType=e,this.assignments.loading=l,e.children=[],e.people={},e.entitiesByType={};const n=this.isTVShow?["Asset","Shot"].includes(e.for_entity)?this.loadEpisodeScheduleItems:this.loadSequenceScheduleItems:e.for_entity==="Shot"?this.loadSequenceScheduleItems:this.loadAssetTypeScheduleItems,r={production:this.currentProduction,taskType:this.taskTypeMap.get(e.task_type_id)},P=await n(r);let p=this.convertScheduleItems(e,P);const I=new Map(p.map(T=>[T.object_id,T]));if(this.isTVShow)e.children=p;else{e.for_entity==="Asset"&&await this.loadAssets({withShared:!1,withTasks:!1}),e.for_entity==="Shot"&&await this.loadShots(),s||(s=await this.loadTasks({project_id:this.currentProduction.id,task_type_id:e.task_type_id,relations:"true"}));const T=[...new Set(s.flatMap(i=>i.assignees))];await this.loadDaysOff(T);const b={},S={};s.forEach(i=>{var f;i.start_date&&(e.for_entity==="Asset"?(i.entity=this.assetMap.get(i.entity_id),i.entity_type_id=i.entity.asset_type_id):e.for_entity==="Shot"?(i.entity=this.shotMap.get(i.entity_id),i.entity_type_id=i.entity.sequence_id):i.entity_type_id=e.for_entity,!((f=i.entity)!=null&&f.canceled)&&(b[i.entity_type_id]||(b[i.entity_type_id]={}),i.assignees.length||(i.assignees=["unassigned"]),i.assignees.forEach(m=>{const k=I.get(i.entity_type_id),g=_(i.start_date);if(g.isAfter(this.endDate))return;g.isBefore(k.startDate)&&(k.startDate=g.clone()),i.startDate=g;let v;if(i.due_date?v=_(i.due_date):i.end_date?v=_(i.end_date):i.estimation&&(v=Q(i.startDate,Math.ceil(he(this.organisation,i.estimation))-1,this.daysOffByPerson[m])),!v||v.isBefore(g)){const A=g.isoWeekday()===5?3:1;v=g.clone().add(A,"days")}if(!v.isSameOrAfter(g)){const A=g.isoWeekday()===5?3:1;v=g.clone().add(A,"days")}v.isBefore(this.startDate)||(v.isAfter(k.endDate)&&(k.endDate=v.clone()),i.endDate=v,b[i.entity_type_id][m]||(b[i.entity_type_id][m]=[],S[m]=m!=="unassigned"?{...this.personMap.get(m),daysOff:this.daysOffByPerson[m]}:{id:m,avatar:!1,color:"#888",full_name:this.$t("main.unassigned")}),b[i.entity_type_id][m].push(i))})))}),e.for_entity==="Asset"&&(p=p.filter(i=>{const f=this.assetTypeMap.get(i.object_id);return f&&(!f.task_types.length||f.task_types.includes(e.task_type_id))}));const M=([i],[f])=>i==="unassigned"?1:f==="unassigned"?-1:S[i].full_name.localeCompare(S[f].full_name),w=(i,f)=>{var m,k;return(k=i.entity)==null?void 0:k.name.localeCompare((m=f.entity)==null?void 0:m.name,void 0,{numeric:!0})};p.forEach(i=>{const f=b[i.object_id]||{},m=new Map(Object.entries(f).sort(M).map(([k,g])=>[k,g.sort(w)]));i.children=m}),e.children=p,e.people=S,e.entitiesByType=Object.fromEntries(Object.entries(b).map(([i,f])=>[i,Object.entries(f).flatMap(([m,k])=>m!=="unassigned"?k.map(g=>g.entity_id):void 0).filter(Boolean)]))}}catch(n){console.error(n),e.children=[],e.people=[]}finally{e.loading=!1}t&&t(e),this.selectTaskTypeElement(e,null,l)}},async loadDaysOff(e){this.daysOffByPerson=[];for(const t of e){const a=await this.loadAggregatedPersonDaysOff({personId:t}).catch(()=>[]);this.daysOffByPerson[t]=a}},filteredAssignments(e){return this.assignments.assigned?e:e.filter(t=>!t.assigned)},onScheduleItemChanged(e){if(e.startDate&&e.endDate&&e.parentElement)e.parentElement.startDate=this.getMinDate(e.parentElement),e.parentElement.endDate=this.getMaxDate(e.parentElement),this.saveScheduleItem(e.parentElement);else if(!e.parentElement){const a=this.getMinDate(e),l=this.getMaxDate(e);e.startDate.isAfter(a)&&(e.startDate=a),e.endDate.isBefore(l)&&(e.endDate=l)}const t=this.scheduleItems.find(a=>a===e);t&&(t.startDate=e.startDate,t.start_date=e.startDate.format("YYYY-MM-DD"),t.endDate=e.endDate,t.end_date=e.endDate.format("YYYY-MM-DD")),this.saveScheduleItem(e)},getMinDate(e){let t=this.endDate.clone();return e.children.forEach(a=>{a.startDate&&a.startDate.isBefore(t)&&(t=a.startDate)}),t.clone()},getMaxDate(e){let t=this.startDate.clone();return e.children.forEach(a=>{a.endDate&&a.endDate.isAfter(t)&&(t=a.endDate)}),t.clone()},isInDepartment(e){return this.isCurrentUserManager?!0:this.isCurrentUserSupervisor?this.user.departments.length===0?!0:e.department_id&&this.user.departments.includes(e.department_id):!1},scrollScheduleToToday(){var e;(e=this.$refs.schedule)==null||e.scrollToToday()},resetSidePanel(){this.assignments={...this.assignments,entityTypes:null,excludes:[],forcedDailyQuota:null,item:null,loading:!1,saving:!1,startDate:null,endDate:null,unassign:!1}},selectParentElement(e){e.expanded?this.selectTaskTypeElement(e):this.expandTaskTypeElement(e,()=>{var t;(t=this.$refs.schedule)==null||t.refreshItemPositions(e)})},async selectTaskTypeElement(e,t=void 0,a=!0){if(this.selectedTaskType=e,a&&this.resetSidePanel(),this.assignments.loading=!0,e.for_entity==="Asset")await this.loadAssets({withShared:!1,withTasks:!1}),this.assignments.entityTypes=this.productionAssetTypes.filter(l=>!l.task_types.length||l.task_types.includes(e.task_type_id)).map((l,s)=>({id:l.id,name:l.name,for_entity:e.for_entity,expanded:l.id===(t==null?void 0:t.object_id),entity_type_id:l.id,children:this.assets.filter(n=>n.asset_type_id===l.id&&!n.canceled&&!n.shared).map(n=>{var r;return{...n,assigned:(r=e.entitiesByType[l.id])==null?void 0:r.includes(n.id)}})}));else if(e.for_entity==="Shot"){await this.loadShots();const l=this.shots.reduce((s,n)=>{var r;return s[n.parent_id]||(s[n.parent_id]=[]),n.assigned=(r=e.entitiesByType[n.parent_id])==null?void 0:r.includes(n.id),s[n.parent_id].push(n),s},{});this.assignments.entityTypes=Object.keys(l).map(s=>{const n=l[s];return{id:s,name:n[0].sequence_name,for_entity:e.for_entity,expanded:s===(t==null?void 0:t.object_id),children:n}})}this.assignments.loading=!1},closeSidePanel(){this.selectedTaskType=void 0,this.resetSidePanel()},onAssignmentItemDragStart(e,t,a){e.stopPropagation(),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData(`task-type-${a.task_type_id}`,!0),e.dataTransfer.setData("taskTypeId",a.task_type_id),e.dataTransfer.setData("entityId",t.id),t.children=this.filteredAssignments(t.children),this.draggedEntities=[t]},onScheduleItemDropped(e,t){this.assignments.item=t;const a=e.start_date||t.start_date,l=_(a).isAfter(t.end_date)?a:t.end_date;this.assignments.startDate=a,this.assignments.endDate=l},removeFromAssignments(e){this.assignments.excludes.push(e.id)},async saveAssignments(){this.assignments.saving=!0;const e=await this.loadTasks({project_id:this.currentProduction.id,task_type_id:this.selectedTaskType.task_type_id,relations:"true"}),a=1/(this.assignments.forcedDailyQuota??this.estimatedDailyQuota);for(const l of this.draggedEntities){const s=_(this.assignments.startDate),n=_(this.assignments.endDate);let r=0,P=0,p=s.clone();for(const I of l.children){const T=e.find(w=>w.entity_id===I.id);if(!T)continue;this.assignments.unassign&&await this.unassignSelectedTasks({taskIds:[T.id]}),r++;let b=p,S=null,M=null;for(;P<this.availablePersons.length;){M=this.availablePersons[P],b=Q(b,0,this.daysOffByPerson[M.id]);const{due_date:w}=me(this.organisation,s,S,r*a,this.daysOffByPerson[M.id]);if(S=_(w),S.isAfter(n))P++,r=1,b=s.clone(),S=null;else{await Promise.all([this.assignSelectedTasks({personId:M.id,taskIds:[T.id]}),this.updateTask({taskId:T.id,data:{estimation:fe(this.organisation,a),start_date:b.format("YYYY-MM-DD"),due_date:S.format("YYYY-MM-DD")}})]),r*a%1!==0?p=S.clone():p=S.clone().add(1,"days");break}}}this.expandTaskTypeElement(this.selectedTaskType,()=>{var I;(I=this.$refs.schedule)==null||I.refreshItemPositions(this.selectedTaskType)},!0,!1,e)}this.assignments.saving=!1}},watch:{selectedStartDate(){this.startDate=_(this.selectedStartDate);const e=this.startDate.format("YYYY-MM-DD");this.currentProduction.start_date&&this.currentProduction.start_date!==e&&this.editProduction({...this.currentProduction,start_date:e})},selectedEndDate(){this.endDate=_(this.selectedEndDate);const e=this.endDate.format("YYYY-MM-DD");this.currentProduction.end_date&&this.currentProduction.end_date!==e&&this.editProduction({...this.currentProduction,end_date:e})},currentProduction(){this.reset()}},head(){return{title:`${this.currentProduction.name} | ${this.$t("schedule.title")} - Kitsu`}}},be={class:"columns fixed-page"},Se={class:"column main-column"},ve={class:"flexrow project-dates"},ke={class:"flexrow-item"},Pe={class:"label"},Te={class:"flexrow-item"},xe={class:"label"},Me={class:"flexrow"},Ie={key:0,class:"column side-column"},we={class:"side"},Ae={class:"mt1"},Ve={class:"details"},Be={key:0,class:"mt2"},Ce={key:1,class:"assignments mt1"},Oe=["onDragstart"],Ye={class:"name"},je=["onClick"],Ee={key:0,class:"assignments"},ze=["onDragstart"],Ue={class:"name"},Qe={key:2,class:"assignments mt1"},Ne={class:"flexrow"},qe={class:"flexrow-item"},Fe={class:"flexrow-item"},Le={key:0},Re={key:1,class:"dragged-items"},Ge={class:"assignees"},He=["title"],Xe={key:0},We={class:"has-text-centered"},Ke={key:1},Ze={class:"assignee"},Je={class:"person"},$e={class:"flexrow mt2"},et={class:"mr05"},tt={class:"mt2"},st={class:"mt2 has-text-right"};function nt(e,t,a,l,s,n){const r=y("date-field"),P=y("combobox-number"),p=y("button-simple"),I=y("schedule"),T=y("x-icon"),b=y("task-type-name"),S=y("spinner"),M=y("grip-vertical-icon"),w=y("chevron-right-icon"),i=y("chevron-down-icon"),f=y("list-restart-icon"),m=y("people-avatar"),k=y("people-name"),g=y("checkbox"),v=y("text-field"),A=y("trash-icon");return c(),u("div",be,[d("div",Se,[d("div",ve,[d("div",ke,[d("label",Pe,D(e.$t("main.start_date")),1),h(r,{"can-delete":!1,utc:"",modelValue:s.selectedStartDate,"onUpdate:modelValue":t[0]||(t[0]=o=>s.selectedStartDate=o)},null,8,["modelValue"])]),d("div",Te,[d("label",xe,D(e.$t("main.end_date")),1),h(r,{"can-delete":!1,utc:"",modelValue:s.selectedEndDate,"onUpdate:modelValue":t[1]||(t[1]=o=>s.selectedEndDate=o)},null,8,["modelValue"])]),h(P,{class:"flexrow-item zoom-level",label:e.$t("schedule.zoom_level"),options:s.zoomOptions,modelValue:s.zoomLevel,"onUpdate:modelValue":t[2]||(t[2]=o=>s.zoomLevel=o)},null,8,["label","options","modelValue"]),t[13]||(t[13]=d("div",{class:"filler"},null,-1)),d("div",Me,[h(p,{class:"flexrow-item",icon:"clock",text:e.$t("schedule.today"),onClick:n.scrollScheduleToToday},null,8,["text","onClick"])])]),h(I,{ref:"schedule","start-date":s.startDate,"end-date":s.endDate,hierarchy:s.scheduleItems,"zoom-level":s.zoomLevel,"is-loading":s.loading.schedule,"is-error":s.errors.schedule,"hide-man-days":"",multiline:e.isTVShow,subchildren:!e.isTVShow,onItemChanged:n.onScheduleItemChanged,onItemDrop:n.onScheduleItemDropped,onItemSelected:n.selectTaskTypeElement,onRootElementExpanded:n.expandTaskTypeElement,onRootElementSelected:n.selectParentElement},null,8,["start-date","end-date","hierarchy","zoom-level","is-loading","is-error","multiline","subchildren","onItemChanged","onItemDrop","onItemSelected","onRootElementExpanded","onRootElementSelected"])]),s.selectedTaskType?(c(),u("div",Ie,[d("div",we,[d("a",{class:"close-button",onClick:t[3]||(t[3]=(...o)=>n.closeSidePanel&&n.closeSidePanel(...o))},[h(T,{class:"align-middle",size:16})]),d("h2",Ae,D(e.$t("menu.assign_tasks")),1),d("div",Ve,[h(b,{class:"task-type","production-id":e.currentProduction.id,"task-type":s.selectedTaskType},null,8,["production-id","task-type"]),s.assignments.item?V("",!0):(c(),Y(p,{key:0,icon:"user-check","is-on":s.assignments.assigned,title:e.$t("schedule.show_assigned"),onClick:t[4]||(t[4]=o=>s.assignments.assigned=!s.assignments.assigned)},null,8,["is-on","title"]))]),s.assignments.loading?(c(),u("div",Be,[h(S,{class:"mauto",size:20})])):s.assignments.item?(c(),u("div",Qe,[d("form",{class:"mt1",onSubmit:t[12]||(t[12]=_e(o=>n.saveAssignments(),["prevent"]))},[d("div",Ne,[d("div",qe,[h(r,{"can-delete":!1,label:e.$t("main.start_date"),utc:"",modelValue:s.assignments.startDate,"onUpdate:modelValue":t[5]||(t[5]=o=>s.assignments.startDate=o)},null,8,["label","modelValue"])]),d("div",Fe,[h(r,{"can-delete":!1,label:e.$t("main.end_date"),utc:"",modelValue:s.assignments.endDate,"onUpdate:modelValue":t[6]||(t[6]=o=>s.assignments.endDate=o)},null,8,["label","modelValue"])])]),(c(!0),u(B,null,C(s.draggedEntities,o=>(c(),u("div",{key:o.id},[d("div",{class:"dragged-type",style:N({background:s.selectedTaskType.color})},D(o.name),5),o.children.length?(c(),u("ul",Re,[(c(!0),u(B,null,C(o.children,x=>(c(),u("li",{class:"dragged-item",key:x.id,style:N({background:`color-mix(in srgb, ${s.selectedTaskType.color} 40%, transparent)`,"border-left":`4px solid ${s.selectedTaskType.color}`})},D(o.name)+" / "+D(x.name),5))),128))])):(c(),u("div",Le,D(e.$t("schedule.no_entity")),1)),t[14]||(t[14]=d("hr",null,null,-1))]))),128)),d("table",Ge,[d("thead",null,[d("tr",null,[d("td",null,[pe(D(e.$t("schedule.assign"))+" ",1),s.assignments.excludes.length?(c(),u("a",{key:0,class:"reset-assignees",title:e.$t("schedule.reset_list"),onClick:t[7]||(t[7]=o=>s.assignments.excludes=[])},[h(f,{class:"align-middle",size:18,"stroke-width":1.5})],8,He)):V("",!0)])])]),n.availablePersons.length?(c(),u("tbody",Ke,[(c(!0),u(B,null,C(n.availablePersons,o=>(c(),u("tr",{key:o.id},[d("td",Ze,[d("div",Je,[h(m,{"is-link":!1,"font-size":14,person:o,size:28},null,8,["person"]),h(k,{person:o},null,8,["person"])]),h(p,{class:"is-small",icon:"minus",title:e.$t("main.avatar.unassign",{personName:o.name}),type:"button",onClick:x=>n.removeFromAssignments(o)},null,8,["title","onClick"])])]))),128))])):(c(),u("tbody",Xe,[d("tr",null,[d("td",We,D(e.$t("schedule.no_assignee")),1)])]))]),h(g,{class:"pa05",disabled:!n.availablePersons.length,label:e.$t("schedule.force_unassign"),toggle:!0,modelValue:s.assignments.unassign,"onUpdate:modelValue":t[8]||(t[8]=o=>s.assignments.unassign=o)},null,8,["disabled","label","modelValue"]),d("div",$e,[d("label",et,D(e.$t("schedule.forced_daily_quotas")),1),h(v,{class:"mb0 daily-quotas","input-class":" is-small",step:.01,type:"number",modelValue:s.assignments.forcedDailyQuota,"onUpdate:modelValue":t[9]||(t[9]=o=>s.assignments.forcedDailyQuota=o)},null,8,["modelValue"]),s.assignments.forcedDailyQuota?(c(),u("a",{key:0,class:"reset-quotas ml05",onClick:t[10]||(t[10]=o=>s.assignments.forcedDailyQuota=null)},[h(A,{class:"align-middle",size:14})])):V("",!0)]),d("div",tt,D(e.$t("schedule.estimated_daily_quotas"))+" "+D(n.estimatedDailyQuota.toFixed(2)),1),d("div",st,[h(p,{class:"mr1",disabled:s.assignments.saving,text:e.$t("main.cancel"),type:"button",onClick:t[11]||(t[11]=o=>s.assignments.item=null)},null,8,["disabled","text"]),h(p,{disabled:!n.hasDraggedEntities||!n.availablePersons.length,icon:"user-check","is-loading":s.assignments.saving,text:e.$t("main.apply"),type:"submit"},null,8,["disabled","is-loading","text"])])],32)])):(c(),u("ul",Ce,[(c(!0),u(B,null,C(s.assignments.entityTypes,o=>(c(),u("li",{key:o.id},[d("div",{class:"assignment-item",draggable:"true",onDragstart:x=>n.onAssignmentItemDragStart(x,o,s.selectedTaskType)},[h(M,{class:"icon"}),d("span",Ye,D(o.name)+" ("+D(n.filteredAssignments(o.children).length)+") ",1),d("span",{class:"expand",onClick:x=>o.expanded=!o.expanded},[o.expanded?(c(),Y(i,{key:1})):(c(),Y(w,{key:0}))],8,je)],40,Oe),o.expanded?(c(),u("ul",Ee,[(c(!0),u(B,null,C(n.filteredAssignments(o.children),x=>(c(),u("li",{key:x.id},[d("div",{class:"assignment-item",draggable:"true",onDragstart:F=>n.onAssignmentItemDragStart(F,{...o,children:[x]},s.selectedTaskType)},[h(M,{class:"icon"}),d("span",Ue,D(x.name),1)],40,ze)]))),128))])):V("",!0)]))),128))]))])])):V("",!0)])}const it=L(De,[["render",nt],["__scopeId","data-v-5195ffba"]]);export{it as default};
//# sourceMappingURL=ProductionSchedule-DR586zju.js.map
