import{h as u,i as l,j as r,aY as d,aX as m,M as c,m as i,g as o,n,o as f}from"./index-a6c845e9.js";import{L as T}from"./ListPageHeader-03593c7e.js";import{R as h}from"./RouteTabs-8971d926.js";import{S as p}from"./StatusAutomationList-6cdd2711.js";import"./TaskStatusCell-54fc6476.js";const y={name:"edit-status-automation-modal",mixins:[u],components:{Combobox:l,ComboboxBoolean:r,ComboboxTaskType:d,ComboboxStatus:m,ModalFooter:c},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},statusAutomationToEdit:{type:Object,default:()=>{}},taskStatus:{type:Object,default:()=>{}}},data(){return{entityTypeOptions:[{label:"asset",value:"asset"},{label:"shot",value:"shot"}],fieldTypeOptions:[{label:"status",value:"status"},{label:"ready_for",value:"ready_for"}],form:{entityType:"asset",outFieldType:"status",inEntityTaskTypes:[],outEntityTaskTypes:[],inTaskTypeId:"",outTaskTypeId:"",inTaskStatusId:"",outTaskStatusId:""}}},computed:{...i(["statusAutomations","statusAutomationsStatusOptions","assetTaskTypes","shotTaskTypes","taskStatuses"]),taskStatusList(){return this.taskStatuses||[]},isEditing(){return this.statusAutomationToEdit&&this.statusAutomationToEdit.id}},methods:{...o([]),confirmClicked(){this.$emit("confirm",this.form)},setTaskTypes(a){a==="asset"?(this.form.inEntityTaskTypes=this.assetTaskTypes,this.form.outFieldType==="status"?this.form.outEntityTaskTypes=this.assetTaskTypes:this.form.outEntityTaskTypes=this.shotTaskTypes):a==="shot"&&(this.form.inEntityTaskTypes=this.shotTaskTypes,this.form.outEntityTaskTypes=this.shotTaskTypes)}},watch:{statusAutomationToEdit(){if(this.statusAutomationToEdit){let a=[];this.form.entityType==="asset"?a=this.assetTaskTypes:this.form.entityType==="shot"&&(a=this.shotTaskTypes),this.form={entityType:this.isEditing?this.statusAutomationToEdit.entity_type:"asset",inEntityTaskTypes:a,outEntityTaskTypes:a,inTaskTypeId:this.isEditing?this.statusAutomationToEdit.in_task_type_id:a[0].id,inTaskStatusId:this.isEditing?this.statusAutomationToEdit.in_task_status_id:this.taskStatuses[0].id,outFieldType:this.isEditing?this.statusAutomationToEdit.out_field_type:"status",outTaskTypeId:this.isEditing?this.statusAutomationToEdit.out_task_type_id:a[1].id,outTaskStatusId:this.isEditing?this.statusAutomationToEdit.out_task_status_id:this.taskStatuses[1].id,archived:this.isEditing?String(this.statusAutomationToEdit.archived===!0):"false"}}},"form.entityType":function(a){this.setTaskTypes(a),this.isEditing||(this.form.inTaskTypeId=this.form.inEntityTaskTypes[0].id,this.form.inTaskStatusId=this.taskStatuses[0].id,this.form.outTaskTypeId=this.form.outEntityTaskTypes[1].id,this.form.outTaskStatusId=this.taskStatuses[1].id)},"form.outFieldType":function(a){a==="ready_for"?(this.form.outEntityTaskTypes=this.shotTaskTypes,this.form.outTaskTypeId=this.shotTaskTypes[1].id):a==="status"&&(this.setTaskTypes(this.form.entityType),this.form.outTaskTypeId=this.form.outEntityTaskTypes[1].id)}}};var _=function(){var t=this,s=t._self._c;return s("div",{class:{modal:!0,"is-active":t.active}},[s("div",{staticClass:"modal-background",on:{click:function(e){return t.$emit("cancel")}}}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"box"},[t.isEditing?s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("status_automations.edit_title"))+" ")]):s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("status_automations.new_status_automation"))+" ")]),s("form",{on:{submit:function(e){e.preventDefault()}}},[s("h3",{staticClass:"subtitle"},[t._v(t._s(t.$t("status_automations.entity_title")))]),t.isEditing?s("span",{staticClass:"entity-type-name"},[t._v(" "+t._s(t.form.entityType)+" ")]):s("combobox",{attrs:{label:t.$t("status_automations.fields.entity_type"),options:t.entityTypeOptions,"locale-key-prefix":"status_automations.entity_types."},on:{enter:t.confirmClicked},model:{value:t.form.entityType,callback:function(e){t.$set(t.form,"entityType",e)},expression:"form.entityType"}}),s("h2",{staticClass:"subtitle"},[t._v(t._s(t.$t("status_automations.in_title")))]),s("div",{staticClass:"flexrow"},[s("combobox-task-type",{staticClass:"flexrow-item",attrs:{label:t.$t("status_automations.fields.in_task_type"),"task-type-list":t.form.inEntityTaskTypes},on:{enter:t.confirmClicked},model:{value:t.form.inTaskTypeId,callback:function(e){t.$set(t.form,"inTaskTypeId",e)},expression:"form.inTaskTypeId"}}),s("combobox-status",{staticClass:"flexrow-item",attrs:{label:t.$t("status_automations.fields.in_task_status"),"task-status-list":t.taskStatusList||[]},on:{enter:t.confirmClicked},model:{value:t.form.inTaskStatusId,callback:function(e){t.$set(t.form,"inTaskStatusId",e)},expression:"form.inTaskStatusId"}})],1),s("h2",{staticClass:"subtitle"},[t._v(t._s(t.$t("status_automations.out_title")))]),s("div",{staticClass:"flexrow"},[!t.isEditing&&t.form.entityType=="asset"?s("combobox",{staticClass:"flexrow-item margin-fix",attrs:{label:t.$t("status_automations.fields.out_field_type"),options:t.fieldTypeOptions,"locale-key-prefix":"status_automations.field_types."},on:{enter:t.confirmClicked},model:{value:t.form.outFieldType,callback:function(e){t.$set(t.form,"outFieldType",e)},expression:"form.outFieldType"}}):t._e(),t.isEditing&&t.form.outFieldType=="ready_for"?s("span",{staticClass:"flexrow-item"},[t._v(" Ready For ")]):t._e(),s("combobox-task-type",{staticClass:"flexrow-item",attrs:{label:t.$t("status_automations.fields.out_task_type"),"task-type-list":t.form.outEntityTaskTypes,"open-top":!0},on:{enter:t.confirmClicked},model:{value:t.form.outTaskTypeId,callback:function(e){t.$set(t.form,"outTaskTypeId",e)},expression:"form.outTaskTypeId"}}),t.form.outFieldType=="status"?s("combobox-status",{staticClass:"flexrow-item",attrs:{label:t.$t("status_automations.fields.out_task_status"),"task-status-list":t.taskStatusList||[],"open-top":!0},on:{enter:t.confirmClicked},model:{value:t.form.outTaskStatusId,callback:function(e){t.$set(t.form,"outTaskStatusId",e)},expression:"form.outTaskStatusId"}}):t._e()],1),t.isEditing?s("combobox-boolean",{attrs:{label:t.$t("main.archived")},on:{enter:t.confirmClicked},model:{value:t.form.archived,callback:function(e){t.$set(t.form,"archived",e)},expression:"form.archived"}}):t._e()],1),s("modal-footer",{attrs:{"error-text":t.$t("status_automations.create_error"),"is-error":t.isError},on:{confirm:t.confirmClicked,cancel:function(e){return t.$emit("cancel")}}})],1)])])},k=[],b=n(y,_,k,!1,null,"443db74a",null,null);const v=b.exports;const E={name:"status-automations",components:{DeleteModal:f,EditStatusAutomationModal:v,ListPageHeader:T,RouteTabs:h,StatusAutomationList:p},data(){return{activeTab:"active",modals:{edit:!1,del:!1},loading:{edit:!1,del:!1,list:!1},errors:{edit:!1,del:!1,list:!1},tabs:[{name:"active",label:this.$t("main.active")},{name:"archived",label:this.$t("main.archived")}],statusAutomationToDelete:null,statusAutomationToEdit:null}},computed:{...i(["statusAutomations","archivedStatusAutomations"]),statusAutomationsList(){return this.activeTab==="active"?this.statusAutomations:this.archivedStatusAutomations},deleteText(){const a=this.statusAutomationToDelete;return a?this.$t("custom_actions.delete_text",{name:a.name}):""}},created(){this.activeTab=this.$route.query.tab||"active",this.loading.list=!0,this.errors.list=!1,this.loadStatusAutomations(a=>{this.loading.list=!1,a&&(this.errors.list=!0)})},methods:{...o(["deleteStatusAutomation","editStatusAutomation","loadTaskStatuses","loadStatusAutomations","newStatusAutomation"]),confirmEditStatusAutomation(a){let t="newStatusAutomation";this.statusAutomationToEdit&&this.statusAutomationToEdit.id&&(t="editStatusAutomation",a.id=this.statusAutomationToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[t](a).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(s=>{console.error(s),this.errors.edit=!0,this.loading.edit=!1})},confirmDeleteStatusAutomation(){this.loading.del=!0,this.errors.del=!1,this.deleteStatusAutomation(this.statusAutomationToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(a=>{console.error(a),this.errors.del=!0,this.loading.del=!1})},onNewClicked(){this.statusAutomationToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(a){this.statusAutomationToEdit=a,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(a){this.statusAutomationToDelete=a,this.errors.del=!1,this.modals.del=!0}},watch:{$route(){this.handleModalsDisplay(),this.activeTab=this.$route.query.tab}},metaInfo(){return{title:`${this.$t("status_automations.title")} - Kitsu`}}};var A=function(){var t=this,s=t._self._c;return s("div",{staticClass:"status-automations page fixed-page"},[s("list-page-header",{attrs:{title:t.$t("status_automations.title"),"new-entry-label":t.$t("status_automations.new_status_automation")},on:{"new-clicked":t.onNewClicked}}),s("route-tabs",{staticClass:"mt2",attrs:{"active-tab":t.activeTab,tabs:t.tabs,"route-name":"status-automations"}}),s("status-automation-list",{staticClass:"status-automation-list",attrs:{entries:t.statusAutomationsList,"is-editable":!0,"is-loading":t.loading.list,"is-error":t.errors.list},on:{"edit-clicked":t.onEditClicked,"delete-clicked":t.onDeleteClicked}}),s("edit-status-automation-modal",{attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"status-automation-to-edit":t.statusAutomationToEdit},on:{cancel:function(e){t.modals.edit=!1},confirm:t.confirmEditStatusAutomation}}),s("delete-modal",{attrs:{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:t.deleteText,"error-text":t.$t("status_automations.delete_error")},on:{cancel:function(e){t.modals.del=!1},confirm:t.confirmDeleteStatusAutomation}})],1)},S=[],x=n(E,A,S,!1,null,"b2938982",null,null);const F=x.exports;export{F as default};
//# sourceMappingURL=StatusAutomations-defae14d.js.map
