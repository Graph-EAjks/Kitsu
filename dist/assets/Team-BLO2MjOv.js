import{m as y,b as C,_ as g,r as d,o as t,c as s,e as n,t as a,d as m,F as k,g as T,f as c,B as $,al as D,a as V,aF as F,I as E,bt as B,K as N,l as b,cU as A,w as v,p as L}from"./index-C8i5e4k0.js";import{P as S}from"./PageLayout-fvaSeYYZ.js";import{D as x}from"./DepartmentNamesCell-8XvtY-Ny.js";import{P as z}from"./PeopleNameCell-COlSNHkC.js";const K={name:"production-team-list",components:{DepartmentNamesCell:x,PeopleNameCell:z},props:{entries:{type:Array,default:()=>[]}},computed:{...y(["isCurrentUserAdmin","isCurrentUserManager"]),isEmpty(){var e;return!((e=this.entries)!=null&&e.length)}},methods:{...C(["removePersonFromTeam"]),removePerson(e){this.removePersonFromTeam(e)}}},R={class:"data-list"},j={class:"datatable-wrapper"},G={class:"datatable"},q={class:"datatable-head"},H={scope:"col",class:"name datatable-row-header"},J={key:0,scope:"col",class:"email"},O={key:1,scope:"col",class:"contract"},Q={scope:"col",class:"role"},W={scope:"col"},X={key:2,scope:"col",class:"actions"},Y={key:0,class:"datatable-body"},Z={key:0,class:"email"},ee={key:1,class:"contract"},te={class:"role"},oe={key:2,class:"actions has-text-right"},se=["onClick"],re={key:0,class:"has-text-centered mt2"},ae={key:1,class:"has-text-centered footer-info"};function ne(e,o,u,_,i,r){const h=d("people-name-cell"),f=d("department-names-cell");return t(),s("div",R,[n("div",j,[n("table",G,[n("thead",q,[n("tr",null,[n("th",H,a(e.$t("people.list.name")),1),e.isCurrentUserManager?(t(),s("th",J,a(e.$t("people.list.email")),1)):m("",!0),e.isCurrentUserManager?(t(),s("th",O,a(e.$t("people.list.contract")),1)):m("",!0),n("th",Q,a(e.$t("people.list.role")),1),n("th",W,a(e.$t("people.list.departments")),1),e.isCurrentUserManager?(t(),s("th",X)):m("",!0)])]),r.isEmpty?m("",!0):(t(),s("tbody",Y,[(t(!0),s(k,null,T(u.entries,p=>(t(),s("tr",{class:"datatable-row",key:p.id},[c(h,{class:"name datatable-row-header",person:p},null,8,["person"]),e.isCurrentUserManager?(t(),s("td",Z,a(p.email),1)):m("",!0),e.isCurrentUserManager?(t(),s("td",ee,a(e.$t("people.contract."+p.contract_type)),1)):m("",!0),n("td",te,a(e.$t(`people.role.${p.role}`)),1),c(f,{departments:p.departments},null,8,["departments"]),e.isCurrentUserManager?(t(),s("td",oe,[e.isCurrentUserAdmin?(t(),s("button",{key:0,class:"button",onClick:P=>r.removePerson(p)},a(e.$t("main.remove")),9,se)):m("",!0)])):m("",!0)]))),128))]))])]),r.isEmpty?(t(),s("p",re,a(e.$t("people.empty_team")),1)):(t(),s("p",ae,a(u.entries.length)+" "+a(e.$tc("people.persons",u.entries.length)),1))])}const le=g(K,[["render",ne],["__scopeId","data-v-b693e691"]]),ie={name:"team",components:{ButtonSimple:$,ComboboxDepartment:D,ComboboxProduction:V,PageLayout:S,PeopleAvatar:F,PeopleField:E,PeopleName:B,ProductionTeamList:le},data(){return{importDepartmentId:null,importProductionId:null,person:null,isTeamLoading:!1,isTeamLoadingError:!1}},mounted(){var e,o;this.availableProductions.length>0&&(this.importProductionId=(e=this.availableProductions[0])==null?void 0:e.id,this.importDepartmentId=(o=this.departments.sort((u,_)=>u.name.localeCompare(_.name))[0])==null?void 0:o.id)},computed:{...y(["currentProduction","departments","departmentMap","isCurrentUserManager","openProductions","activePeople","personMap","productionMap"]),availableProductions(){return this.openProductions.filter(e=>e.id!==this.currentProduction.id)},teamPersons(){return N(this.currentProduction.team.map(e=>this.personMap.get(e)))},unlistedPeople(){return this.activePeople.filter(e=>!this.currentProduction.team.includes(e.id)&&e.active)}},methods:{...C(["addPersonToTeam"]),addPerson(){this.person&&(this.addPersonToTeam(this.person),this.$refs["people-field"].focus())},removePerson(e){this.removePersonFromTeam(e)},importTeamFromProduction(){this.productionMap.get(this.importProductionId).team.forEach(o=>{this.addPersonToTeam(this.personMap.get(o))})},importTeamFromDepartment(){const e=this.importDepartmentId;this.activePeople.filter(o=>o.departments.includes(e)).forEach(o=>{this.addPersonToTeam(o)})}},head(){return{title:`${this.currentProduction.name} | ${this.$t("people.team")} - Kitsu`}}},de={class:"people flexcolumn"},me={key:0,class:"flexrow mt2 add-people"},pe=["disabled"],ce={class:"importers flexcolumn"},ue={key:0,class:"project-import flexcolumn"},_e={class:"label mt2"},he={class:"import-list"},fe=["onClick"];function Pe(e,o,u,_,i,r){const h=d("people-field"),f=d("production-team-list"),p=d("combobox-production"),P=d("button-simple"),w=d("combobox-department"),I=d("people-avatar"),M=d("people-name"),U=d("page-layout");return t(),b(U,null,A({main:v(()=>[n("div",de,[e.isCurrentUserManager?(t(),s("div",me,[c(h,{ref:"people-field",class:"flexrow-item add-people-field",people:r.unlistedPeople,placeholder:e.$t("people.add_member_to_team"),onSelect:r.addPerson,modelValue:i.person,"onUpdate:modelValue":o[0]||(o[0]=l=>i.person=l)},null,8,["people","placeholder","onSelect","modelValue"]),n("button",{class:"button flexrow-item",onClick:o[1]||(o[1]=(...l)=>r.addPerson&&r.addPerson(...l)),disabled:!i.person},a(e.$t("main.add")),9,pe)])):m("",!0),c(f,{entries:r.teamPersons,onRemove:r.removePerson},null,8,["entries","onRemove"])])]),_:2},[e.isCurrentUserManager?{name:"side",fn:v(()=>[n("div",ce,[r.availableProductions.length>0?(t(),s("div",ue,[c(p,{class:"flexrow-item",label:e.$t("people.import_from_production"),"production-list":r.availableProductions,"with-margin":!1,modelValue:i.importProductionId,"onUpdate:modelValue":o[2]||(o[2]=l=>i.importProductionId=l)},null,8,["label","production-list","modelValue"]),c(P,{class:"flexrow-item mt05",disabled:!i.importProductionId,text:e.$t("main.import"),onClick:r.importTeamFromProduction},null,8,["disabled","text","onClick"])])):m("",!0),n("div",{class:L({"department-import":!0,flexcolumn:!0,mt2:r.availableProductions.length>0})},[c(w,{class:"flexrow-item",label:e.$t("people.import_from_department"),"department-list":e.departments,"with-empty-choice":!1,modelValue:i.importDepartmentId,"onUpdate:modelValue":o[3]||(o[3]=l=>i.importDepartmentId=l)},null,8,["label","department-list","modelValue"]),c(P,{class:"flexrow-item mt05",disabled:!i.importDepartmentId,text:e.$t("main.import"),onClick:r.importTeamFromDepartment},null,8,["disabled","text","onClick"])],2),n("p",_e,a(e.$t("people.import_from_unlisted")),1),n("div",he,[(t(!0),s(k,null,T(r.unlistedPeople,l=>(t(),s("div",{key:`unlisted-person-${l.id}`,class:"flexrow person-to-add mb05",onClick:be=>e.addPersonToTeam(l)},[(t(),b(I,{class:"flexrow-item","font-size":14,key:l.id,person:l,size:30,"is-link":!1},null,8,["person"])),c(M,{class:"flexrow-item",person:l},null,8,["person"])],8,fe))),128))])])]),key:"0"}:void 0]),1024)}const ke=g(ie,[["render",Pe],["__scopeId","data-v-c913a4bd"]]);export{ke as default};
//# sourceMappingURL=Team-BLO2MjOv.js.map
