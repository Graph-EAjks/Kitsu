import{m as o,a as r,n as i,B as l,G as m,ap as p,a7 as c,a1 as d,aX as u,a4 as _}from"./index-BGAIsY9z.js";import{P as f}from"./PageLayout-TZvd-gC1.js";import{D as h}from"./DepartmentNamesCell-BDwgwPjM.js";import{P as v}from"./PeopleNameCell-DPSDdUeD.js";const P={name:"production-team-list",components:{DepartmentNamesCell:h,PeopleNameCell:v},props:{entries:{type:Array,default:()=>[]}},computed:{...o(["isCurrentUserAdmin"]),isEmpty(){var s;return!((s=this.entries)!=null&&s.length)}},methods:{...r(["removePersonFromTeam"]),removePerson(s){this.removePersonFromTeam(s)}}};var C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-list"},[e("div",{staticClass:"datatable-wrapper"},[e("table",{staticClass:"datatable"},[e("thead",{staticClass:"datatable-head"},[e("tr",[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.name"))+" ")]),e("th",{staticClass:"email",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.email"))+" ")]),e("th",{staticClass:"contract",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.contract"))+" ")]),e("th",{staticClass:"role",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.role"))+" ")]),e("th",{attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.departments"))+" ")]),e("th",{staticClass:"actions",attrs:{scope:"col"}})])]),t.isEmpty?t._e():e("tbody",{staticClass:"datatable-body"},t._l(t.entries,function(a){return e("tr",{key:a.id,staticClass:"datatable-row"},[e("people-name-cell",{staticClass:"name datatable-row-header",attrs:{person:a}}),e("td",{staticClass:"email"},[t._v(t._s(a.email))]),e("td",{staticClass:"contract"},[t._v(" "+t._s(t.$t("people.contract."+a.contract_type))+" ")]),e("td",{staticClass:"role"},[t._v(t._s(t.$t(`people.role.${a.role}`)))]),e("department-names-cell",{attrs:{departments:a.departments}}),e("td",{staticClass:"actions has-text-right"},[t.isCurrentUserAdmin?e("button",{staticClass:"button",on:{click:function(n){return t.removePerson(a)}}},[t._v(" "+t._s(t.$t("main.remove"))+" ")]):t._e()])],1)}),0)])]),t.isEmpty?e("p",{staticClass:"has-text-centered mt2"},[t._v(" "+t._s(t.$t("people.empty_team"))+" ")]):e("p",{staticClass:"has-text-centered footer-info"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("people.persons",t.entries.length))+" ")])])},b=[],x=i(P,C,b,!1,null,"de0eb83b",null,null);const $=x.exports,T={name:"team",components:{ButtonSimple:l,ComboboxDepartment:m,ComboboxProduction:p,PageLayout:f,PeopleAvatar:c,PeopleField:d,PeopleName:u,ProductionTeamList:$},data(){return{importDepartmentId:null,importProductionId:null,person:null,isTeamLoading:!1,isTeamLoadingError:!1}},mounted(){var s,t;this.availableProductions.length>0&&(this.importProductionId=(s=this.availableProductions[0])==null?void 0:s.id,this.importDepartmentId=(t=this.departments.sort((e,a)=>e.name.localeCompare(a.name))[0])==null?void 0:t.id)},computed:{...o(["currentProduction","departments","departmentMap","isCurrentUserManager","openProductions","activePeople","personMap","productionMap"]),availableProductions(){return this.openProductions.filter(s=>s.id!==this.currentProduction.id)},teamPersons(){return _(this.currentProduction.team.map(s=>this.personMap.get(s)))},unlistedPeople(){return this.activePeople.filter(s=>!this.currentProduction.team.includes(s.id)&&s.active)}},methods:{...r(["addPersonToTeam"]),addPerson(){this.person&&(this.addPersonToTeam(this.person),setTimeout(()=>{this.$refs["people-field"].clear()},1))},removePerson(s){this.removePersonFromTeam(s)},importTeamFromProduction(){this.productionMap.get(this.importProductionId).team.forEach(t=>{this.addPersonToTeam(this.personMap.get(t))})},importTeamFromDepartment(){const s=this.importDepartmentId;this.activePeople.filter(t=>t.departments.includes(s)).forEach(t=>{this.addPersonToTeam(t)})}},metaInfo(){return{title:`${this.currentProduction.name} | ${this.$t("people.team")} - Kitsu`}}};var g=function(){var t=this,e=t._self._c;return e("page-layout",{scopedSlots:t._u([{key:"main",fn:function(){return[e("div",{staticClass:"people flexcolumn"},[t.isCurrentUserManager?e("div",{staticClass:"flexrow mt2 add-people"},[e("people-field",{ref:"people-field",staticClass:"flexrow-item add-people-field",attrs:{people:t.unlistedPeople,placeholder:t.$t("people.add_member_to_team"),big:""},on:{enter:t.addPerson},model:{value:t.person,callback:function(a){t.person=a},expression:"person"}}),e("button",{staticClass:"button flexrow-item",attrs:{disabled:!t.person},on:{click:t.addPerson}},[t._v(" "+t._s(t.$t("main.add"))+" ")])],1):t._e(),e("production-team-list",{attrs:{entries:t.teamPersons,"is-loading":t.isTeamLoading,"is-error":t.isTeamLoadingError},on:{remove:t.removePerson}})],1)]},proxy:!0},{key:"side",fn:function(){return[e("div",{staticClass:"importers flexcolumn"},[e("div",{staticClass:"project-import flexcolumn"},[e("combobox-production",{staticClass:"flexrow-item",attrs:{label:t.$t("people.import_from_production"),"production-list":t.availableProductions,"with-margin":!1},model:{value:t.importProductionId,callback:function(a){t.importProductionId=a},expression:"importProductionId"}}),e("button-simple",{staticClass:"flexrow-item mt05",attrs:{disabled:!t.importProductionId,text:t.$t("main.import")},on:{click:t.importTeamFromProduction}})],1),e("div",{staticClass:"department-import flexcolumn mt2"},[e("combobox-department",{staticClass:"flexrow-item",attrs:{label:t.$t("people.import_from_department"),"department-list":t.departments,"with-empty-choice":!1},model:{value:t.importDepartmentId,callback:function(a){t.importDepartmentId=a},expression:"importDepartmentId"}}),e("button-simple",{staticClass:"flexrow-item mt05",attrs:{disabled:!t.importDepartmentId,text:t.$t("main.import")},on:{click:t.importTeamFromDepartment}})],1),e("p",{staticClass:"label mt2"},[t._v(" "+t._s(t.$t("people.import_from_unlisted"))+" ")]),e("div",{staticClass:"import-list"},t._l(t.unlistedPeople,function(a){return e("div",{key:`unlisted-person-${a.id}`,staticClass:"flexrow person-to-add mb05",on:{click:function(n){return t.addPersonToTeam(a)}}},[e("people-avatar",{key:a.id,staticClass:"flexrow-item",attrs:{"font-size":14,person:a,size:30,"with-link":!1}}),e("people-name",{staticClass:"flexrow-item",attrs:{person:a,"with-link":!1}})],1)}),0)])]},proxy:!0}])})},y=[],w=i(T,g,y,!1,null,"74c3f942",null,null);const M=w.exports;export{M as default};
//# sourceMappingURL=Team-D8I6clVC.js.map
