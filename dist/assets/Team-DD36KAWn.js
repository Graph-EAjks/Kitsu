import{m as y,b as k,_ as C,r as d,o,c as r,e as n,t as a,d as p,F as g,g as T,f as c,B as U,al as D,a as V,aF as F,I as B,bt as E,K as N,l as b,cU as x,w as v,p as S}from"./index-VIyWXLb8.js";import{P as z}from"./PageLayout-DSW6rylc.js";import{D as A}from"./DepartmentNamesCell-CIuitE_Z.js";import{P as L}from"./PeopleNameCell-Dumbvnrk.js";const K={name:"production-team-list",components:{DepartmentNamesCell:A,PeopleNameCell:L},props:{entries:{type:Array,default:()=>[]}},computed:{...y(["isCurrentUserManager"]),isEmpty(){var e;return!((e=this.entries)!=null&&e.length)}},methods:{...k(["removePersonFromTeam"]),removePerson(e){this.removePersonFromTeam(e)}}},R={class:"data-list"},j={class:"datatable-wrapper"},G={class:"datatable"},q={class:"datatable-head"},H={scope:"col",class:"name datatable-row-header"},J={key:0,scope:"col",class:"email"},O={key:1,scope:"col",class:"contract"},Q={scope:"col",class:"role"},W={scope:"col"},X={key:2,scope:"col",class:"actions"},Y={key:0,class:"datatable-body"},Z={key:0,class:"email"},ee={key:1,class:"contract"},te={class:"role"},oe={key:2,class:"actions has-text-right"},se=["onClick"],re={key:0,class:"has-text-centered mt2"},ne={key:1,class:"has-text-centered footer-info"};function ae(e,t,u,_,i,s){const h=d("people-name-cell"),f=d("department-names-cell");return o(),r("div",R,[n("div",j,[n("table",G,[n("thead",q,[n("tr",null,[n("th",H,a(e.$t("people.list.name")),1),e.isCurrentUserManager?(o(),r("th",J,a(e.$t("people.list.email")),1)):p("",!0),e.isCurrentUserManager?(o(),r("th",O,a(e.$t("people.list.contract")),1)):p("",!0),n("th",Q,a(e.$t("people.list.role")),1),n("th",W,a(e.$t("people.list.departments")),1),e.isCurrentUserManager?(o(),r("th",X)):p("",!0)])]),s.isEmpty?p("",!0):(o(),r("tbody",Y,[(o(!0),r(g,null,T(u.entries,m=>(o(),r("tr",{class:"datatable-row",key:m.id},[c(h,{class:"name datatable-row-header",person:m},null,8,["person"]),e.isCurrentUserManager?(o(),r("td",Z,a(m.email),1)):p("",!0),e.isCurrentUserManager?(o(),r("td",ee,a(e.$t(`people.contract.${m.contract_type}`)),1)):p("",!0),n("td",te,a(e.$t(`people.role.${m.role}`)),1),c(f,{departments:m.departments},null,8,["departments"]),e.isCurrentUserManager?(o(),r("td",oe,[n("button",{class:"button",onClick:P=>s.removePerson(m)},a(e.$t("main.remove")),9,se)])):p("",!0)]))),128))]))])]),s.isEmpty?(o(),r("p",re,a(e.$t("people.empty_team")),1)):(o(),r("p",ne,a(u.entries.length)+" "+a(e.$tc("people.persons",u.entries.length)),1))])}const le=C(K,[["render",ae],["__scopeId","data-v-f88df4ef"]]),ie={name:"team",components:{ButtonSimple:U,ComboboxDepartment:D,ComboboxProduction:V,PageLayout:z,PeopleAvatar:F,PeopleField:B,PeopleName:E,ProductionTeamList:le},data(){return{importDepartmentId:null,importProductionId:null,person:null}},mounted(){var e,t;this.availableProductions.length>0&&(this.importProductionId=(e=this.availableProductions[0])==null?void 0:e.id,this.importDepartmentId=(t=this.departments.sort((u,_)=>u.name.localeCompare(_.name,void 0,{numeric:!0}))[0])==null?void 0:t.id)},computed:{...y(["activePeople","currentProduction","departments","isCurrentUserManager","openProductions","personMap","productionMap"]),availableProductions(){return this.openProductions.filter(e=>e.id!==this.currentProduction.id)},teamPersons(){return N(this.currentProduction.team.map(e=>this.personMap.get(e)))},unlistedPeople(){return this.activePeople.filter(e=>!this.currentProduction.team.includes(e.id)&&e.active)}},methods:{...k(["addPersonToTeam"]),addPerson(){this.person&&(this.addPersonToTeam(this.person),this.$refs["people-field"].focus())},removePerson(e){this.removePersonFromTeam(e)},importTeamFromProduction(){this.productionMap.get(this.importProductionId).team.forEach(t=>{this.addPersonToTeam(this.personMap.get(t))})},importTeamFromDepartment(){const e=this.importDepartmentId;this.activePeople.filter(t=>t.departments.includes(e)).forEach(t=>{this.addPersonToTeam(t)})}},head(){return{title:`${this.currentProduction.name} | ${this.$t("people.team")} - Kitsu`}}},de={class:"people flexcolumn"},me={key:0,class:"flexrow mt2 add-people"},pe=["disabled"],ce={class:"importers flexcolumn"},ue={key:0,class:"project-import flexcolumn"},_e={class:"label mt2"},he={class:"import-list"},fe=["onClick"];function Pe(e,t,u,_,i,s){const h=d("people-field"),f=d("production-team-list"),m=d("combobox-production"),P=d("button-simple"),w=d("combobox-department"),$=d("people-avatar"),I=d("people-name"),M=d("page-layout");return o(),b(M,null,x({main:v(()=>[n("div",de,[e.isCurrentUserManager?(o(),r("div",me,[c(h,{ref:"people-field",class:"flexrow-item add-people-field",people:s.unlistedPeople,placeholder:e.$t("people.add_member_to_team"),onSelect:s.addPerson,modelValue:i.person,"onUpdate:modelValue":t[0]||(t[0]=l=>i.person=l)},null,8,["people","placeholder","onSelect","modelValue"]),n("button",{class:"button flexrow-item",onClick:t[1]||(t[1]=(...l)=>s.addPerson&&s.addPerson(...l)),disabled:!i.person},a(e.$t("main.add")),9,pe)])):p("",!0),c(f,{entries:s.teamPersons,onRemove:s.removePerson},null,8,["entries","onRemove"])])]),_:2},[e.isCurrentUserManager?{name:"side",fn:v(()=>[n("div",ce,[s.availableProductions.length>0?(o(),r("div",ue,[c(m,{class:"flexrow-item",label:e.$t("people.import_from_production"),"production-list":s.availableProductions,"with-margin":!1,modelValue:i.importProductionId,"onUpdate:modelValue":t[2]||(t[2]=l=>i.importProductionId=l)},null,8,["label","production-list","modelValue"]),c(P,{class:"flexrow-item mt05",disabled:!i.importProductionId,text:e.$t("main.import"),onClick:s.importTeamFromProduction},null,8,["disabled","text","onClick"])])):p("",!0),n("div",{class:S({"department-import":!0,flexcolumn:!0,mt2:s.availableProductions.length>0})},[c(w,{class:"flexrow-item",label:e.$t("people.import_from_department"),"department-list":e.departments,"with-empty-choice":!1,modelValue:i.importDepartmentId,"onUpdate:modelValue":t[3]||(t[3]=l=>i.importDepartmentId=l)},null,8,["label","department-list","modelValue"]),c(P,{class:"flexrow-item mt05",disabled:!i.importDepartmentId,text:e.$t("main.import"),onClick:s.importTeamFromDepartment},null,8,["disabled","text","onClick"])],2),n("p",_e,a(e.$t("people.import_from_unlisted")),1),n("div",he,[(o(!0),r(g,null,T(s.unlistedPeople,l=>(o(),r("div",{key:`unlisted-person-${l.id}`,class:"flexrow person-to-add mb05",onClick:be=>e.addPersonToTeam(l)},[(o(),b($,{class:"flexrow-item","font-size":14,key:l.id,person:l,size:30,"is-link":!1},null,8,["person"])),c(I,{class:"flexrow-item",person:l},null,8,["person"])],8,fe))),128))])])]),key:"0"}:void 0]),1024)}const ge=C(ie,[["render",Pe],["__scopeId","data-v-bd494d03"]]);export{ge as default};
//# sourceMappingURL=Team-DD36KAWn.js.map
