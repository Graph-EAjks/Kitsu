import{m as r,b as o,n as i,B as l,a1 as m,a as p,al as c,r as d,b3 as u,t as _}from"./index-DKo3EM5C.js";import{P as f}from"./PageLayout-DNy9g6GF.js";import{D as h}from"./DepartmentNamesCell-DoE-3ZU3.js";import{P as v}from"./PeopleNameCell-BK73ctNw.js";const P={name:"production-team-list",components:{DepartmentNamesCell:h,PeopleNameCell:v},props:{entries:{type:Array,default:()=>[]}},computed:{...r(["isCurrentUserAdmin","isCurrentUserManager"]),isEmpty(){var a;return!((a=this.entries)!=null&&a.length)}},methods:{...o(["removePersonFromTeam"]),removePerson(a){this.removePersonFromTeam(a)}}};var C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-list"},[e("div",{staticClass:"datatable-wrapper"},[e("table",{staticClass:"datatable"},[e("thead",{staticClass:"datatable-head"},[e("tr",[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.name"))+" ")]),t.isCurrentUserManager?e("th",{staticClass:"email",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.email"))+" ")]):t._e(),t.isCurrentUserManager?e("th",{staticClass:"contract",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.contract"))+" ")]):t._e(),e("th",{staticClass:"role",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.role"))+" ")]),e("th",{attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("people.list.departments"))+" ")]),t.isCurrentUserManager?e("th",{staticClass:"actions",attrs:{scope:"col"}}):t._e()])]),t.isEmpty?t._e():e("tbody",{staticClass:"datatable-body"},t._l(t.entries,function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("people-name-cell",{staticClass:"name datatable-row-header",attrs:{person:s}}),t.isCurrentUserManager?e("td",{staticClass:"email"},[t._v(" "+t._s(s.email)+" ")]):t._e(),t.isCurrentUserManager?e("td",{staticClass:"contract"},[t._v(" "+t._s(t.$t("people.contract."+s.contract_type))+" ")]):t._e(),e("td",{staticClass:"role"},[t._v(t._s(t.$t(`people.role.${s.role}`)))]),e("department-names-cell",{attrs:{departments:s.departments}}),t.isCurrentUserManager?e("td",{staticClass:"actions has-text-right"},[t.isCurrentUserAdmin?e("button",{staticClass:"button",on:{click:function(n){return t.removePerson(s)}}},[t._v(" "+t._s(t.$t("main.remove"))+" ")]):t._e()]):t._e()],1)}),0)])]),t.isEmpty?e("p",{staticClass:"has-text-centered mt2"},[t._v(" "+t._s(t.$t("people.empty_team"))+" ")]):e("p",{staticClass:"has-text-centered footer-info"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("people.persons",t.entries.length))+" ")])])},b=[],x=i(P,C,b,!1,null,"8d0202f1");const g=x.exports,$={name:"team",components:{ButtonSimple:l,ComboboxDepartment:m,ComboboxProduction:p,PageLayout:f,PeopleAvatar:c,PeopleField:d,PeopleName:u,ProductionTeamList:g},data(){return{importDepartmentId:null,importProductionId:null,person:null,isTeamLoading:!1,isTeamLoadingError:!1}},mounted(){var a,t;this.availableProductions.length>0&&(this.importProductionId=(a=this.availableProductions[0])==null?void 0:a.id,this.importDepartmentId=(t=this.departments.sort((e,s)=>e.name.localeCompare(s.name))[0])==null?void 0:t.id)},computed:{...r(["currentProduction","departments","departmentMap","isCurrentUserManager","openProductions","activePeople","personMap","productionMap"]),availableProductions(){return this.openProductions.filter(a=>a.id!==this.currentProduction.id)},teamPersons(){return _(this.currentProduction.team.map(a=>this.personMap.get(a)))},unlistedPeople(){return this.activePeople.filter(a=>!this.currentProduction.team.includes(a.id)&&a.active)}},methods:{...o(["addPersonToTeam"]),addPerson(){this.person&&(this.addPersonToTeam(this.person),setTimeout(()=>{this.$refs["people-field"].clear()},1))},removePerson(a){this.removePersonFromTeam(a)},importTeamFromProduction(){this.productionMap.get(this.importProductionId).team.forEach(t=>{this.addPersonToTeam(this.personMap.get(t))})},importTeamFromDepartment(){const a=this.importDepartmentId;this.activePeople.filter(t=>t.departments.includes(a)).forEach(t=>{this.addPersonToTeam(t)})}},metaInfo(){return{title:`${this.currentProduction.name} | ${this.$t("people.team")} - Kitsu`}}};var T=function(){var t=this,e=t._self._c;return e("page-layout",{scopedSlots:t._u([{key:"main",fn:function(){return[e("div",{staticClass:"people flexcolumn"},[t.isCurrentUserManager?e("div",{staticClass:"flexrow mt2 add-people"},[e("people-field",{ref:"people-field",staticClass:"flexrow-item add-people-field",attrs:{people:t.unlistedPeople,placeholder:t.$t("people.add_member_to_team"),big:""},on:{enter:t.addPerson},model:{value:t.person,callback:function(s){t.person=s},expression:"person"}}),e("button",{staticClass:"button flexrow-item",attrs:{disabled:!t.person},on:{click:t.addPerson}},[t._v(" "+t._s(t.$t("main.add"))+" ")])],1):t._e(),e("production-team-list",{attrs:{entries:t.teamPersons,"is-loading":t.isTeamLoading,"is-error":t.isTeamLoadingError},on:{remove:t.removePerson}})],1)]},proxy:!0},t.isCurrentUserManager?{key:"side",fn:function(){return[e("div",{staticClass:"importers flexcolumn"},[t.availableProductions.length>0?e("div",{staticClass:"project-import flexcolumn"},[e("combobox-production",{staticClass:"flexrow-item",attrs:{label:t.$t("people.import_from_production"),"production-list":t.availableProductions,"with-margin":!1},model:{value:t.importProductionId,callback:function(s){t.importProductionId=s},expression:"importProductionId"}}),e("button-simple",{staticClass:"flexrow-item mt05",attrs:{disabled:!t.importProductionId,text:t.$t("main.import")},on:{click:t.importTeamFromProduction}})],1):t._e(),e("div",{class:{"department-import":!0,flexcolumn:!0,mt2:t.availableProductions.length>0}},[e("combobox-department",{staticClass:"flexrow-item",attrs:{label:t.$t("people.import_from_department"),"department-list":t.departments,"with-empty-choice":!1},model:{value:t.importDepartmentId,callback:function(s){t.importDepartmentId=s},expression:"importDepartmentId"}}),e("button-simple",{staticClass:"flexrow-item mt05",attrs:{disabled:!t.importDepartmentId,text:t.$t("main.import")},on:{click:t.importTeamFromDepartment}})],1),e("p",{staticClass:"label mt2"},[t._v(" "+t._s(t.$t("people.import_from_unlisted"))+" ")]),e("div",{staticClass:"import-list"},t._l(t.unlistedPeople,function(s){return e("div",{key:`unlisted-person-${s.id}`,staticClass:"flexrow person-to-add mb05",on:{click:function(n){return t.addPersonToTeam(s)}}},[e("people-avatar",{key:s.id,staticClass:"flexrow-item",attrs:{"font-size":14,person:s,size:30,"with-link":!1}}),e("people-name",{staticClass:"flexrow-item",attrs:{person:s,"with-link":!1}})],1)}),0)])]},proxy:!0}:null],null,!0)})},y=[],w=i($,T,y,!1,null,"017750f1");const U=w.exports;export{U as default};
//# sourceMappingURL=Team-DF60Z81u.js.map
