(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c033f68"],{"435a":function(e,t,i){"use strict";i("7fb8")},4916:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{modal:!0,"is-active":e.active}},[i("div",{staticClass:"modal-background",on:{click:function(t){return e.$emit("cancel")}}}),i("div",{staticClass:"modal-content"},[i("div",{staticClass:"box"},[e.episodeToEdit&&this.episodeToEdit.id?i("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("episodes.edit_title"))+" "+e._s(e.episodeToEdit.name)+" ")]):i("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("episodes.new_episode"))+" ")]),i("form",{on:{submit:function(e){e.preventDefault()}}},[i("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:e.$t("episodes.fields.name")},on:{enter:e.runConfirmation},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),i("textarea-field",{ref:"descriptionField",attrs:{label:e.$t("episodes.fields.description")},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.runConfirmation.apply(null,arguments):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.metaKey?e.runConfirmation.apply(null,arguments):null}]},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),e._l(e.episodeMetadataDescriptors,(function(t){return i("div",{key:t.id},[t.choices.length>0?i("combobox",{attrs:{label:t.name,options:e.getDescriptorChoicesOptions(t)},model:{value:e.form.data[t.field_name],callback:function(i){e.$set(e.form.data,t.field_name,i)},expression:"form.data[descriptor.field_name]"}}):i("text-field",{attrs:{label:t.name},on:{enter:e.runConfirmation},model:{value:e.form.data[t.field_name],callback:function(i){e.$set(e.form.data,t.field_name,i)},expression:"form.data[descriptor.field_name]"}})],1)}))],2),i("modal-footer",{attrs:{"error-text":e.$t("episodes.edit_error"),"is-loading":e.isLoading,"is-error":e.isError},on:{confirm:e.runConfirmation,cancel:function(t){return e.$emit("cancel")}}})],1)])])},a=[],o=i("2f62"),n=i("d065"),r=i("d5c9"),d=i("7bf8"),l=i("1149");function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e){return h(e)||f(e)||m(e)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e,t){if(e){if("string"===typeof e)return y(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(e,t):void 0}}function f(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e){if(Array.isArray(e))return y(e)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){v(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function v(e,t,i){return t=C(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function C(e){var t=k(e,"string");return"symbol"===c(t)?t:String(t)}function k(e,t){if("object"!==c(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!==c(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var S={name:"edit-episode-modal",mixins:[n["a"]],components:{ModalFooter:r["a"],TextField:d["a"],TextareaField:l["a"]},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},episodeToEdit:{type:Object,default:function(){}}},data:function(){return this.episodeToEdit&&this.episodeToEdit.id?{form:{id:this.episodeToEdit.id,name:this.episodeToEdit.name,description:this.episodeToEdit.description,production_id:this.episodeToEdit.project_id,data:this.episodeToEdit.data||{}},episodeSuccessText:""}:{form:{id:"",name:"",description:"",fps:"",data:{}},episodeSuccessText:""}},computed:b({},Object(o["c"])(["currentProduction","episodeMetadataDescriptors"])),methods:b(b({},Object(o["b"])([])),{},{getDescriptorChoicesOptions:function(e){var t=e.choices.map((function(e){return{label:e,value:e}}));return[{label:"",value:""}].concat(u(t))},runConfirmation:function(){this.$emit("confirm",this.form)},isEditing:function(){return this.episodeToEdit&&this.episodeToEdit.id},resetForm:function(){this.episodeSuccessText="",this.isEditing()?this.form={id:this.episodeToEdit.id,name:this.episodeToEdit.name,description:this.episodeToEdit.description,data:this.episodeToEdit.data||{}}:(this.form.id=null,this.form.name="",this.form.description="",this.form.data={})}}),mounted:function(){this.resetForm()},watch:{active:function(){this.active&&this.resetForm()},episodeToEdit:function(){this.resetForm()}}},E=S,D=(i("435a"),i("2877")),T=Object(D["a"])(E,s,a,!1,null,"f722693e",null);t["a"]=T.exports},"536a":function(e,t,i){"use strict";i("a193")},"745f":function(e,t,i){},"7fb8":function(e,t,i){},a193:function(e,t,i){},a591:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"columns fixed-page"},[i("action-panel"),i("div",{staticClass:"column main-column"},[i("div",{staticClass:"episodes page"},[i("div",{staticClass:"episode-list-header page-header"},[i("div",{staticClass:"flexrow"},[i("search-field",{ref:"episode-search-field",attrs:{"can-save":!0,active:e.isSearchActive,placeholder:"ex: e01 episode=wip"},on:{change:e.onSearchChange,enter:e.saveSearchQuery,save:e.saveSearchQuery}}),i("button-simple",{staticClass:"flexrow-item",attrs:{title:e.$t("entities.build_filter.title"),icon:"funnel"},on:{click:function(){return e.modals.isBuildFilterDisplayed=!0}}}),i("div",{staticClass:"filler"}),e.isCurrentUserClient?e._e():i("div",{staticClass:"flexrow flexrow-item"},[i("show-assignations-button",{staticClass:"flexrow-item"}),i("show-infos-button",{staticClass:"flexrow-item"}),i("big-thumbnails-button",{staticClass:"flexrow-item"})],1),e.isCurrentUserManager?i("div",{staticClass:"flexrow"},[i("button-simple",{staticClass:"flexrow-item",attrs:{text:e.$t("episodes.new_episode"),icon:"plus"},on:{click:e.showNewModal}})],1):e._e()],1),i("div",{staticClass:"query-list mt1"},[e.isEpisodesLoading||e.initialLoading?e._e():i("search-query-list",{attrs:{queries:e.episodeSearchQueries},on:{"change-search":e.changeSearch,"remove-search":e.removeSearchQuery}})],1)]),e.episodeSorting&&e.episodeSorting.length>0?i("sorting-info",{attrs:{label:e.$t("main.sorted_by"),sorting:e.episodeSorting},on:{"clear-sorting":function(t){return e.onChangeSortClicked(null)}}}):e._e(),i("episode-list",{ref:"episode-list",attrs:{"displayed-episodes":e.displayedEpisodes,"is-loading":e.isEpisodesLoading||e.initialLoading,"is-error":e.isEpisodesLoadingError,"validation-columns":e.episodeValidationColumns,"department-filter":e.departmentFilter},on:{"add-metadata":e.onAddMetadataClicked,"change-sort":e.onChangeSortClicked,"create-tasks":e.showCreateTasksModal,"delete-all-tasks":e.onDeleteAllTasksClicked,"delete-clicked":e.onDeleteClicked,"delete-metadata":e.onDeleteMetadataClicked,"edit-clicked":e.onEditClicked,"edit-metadata":e.onEditMetadataClicked,"field-changed":e.onFieldChanged,"metadata-changed":e.onMetadataChanged,scroll:e.saveScrollPosition}})],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:1===e.nbSelectedTasks,expression:"nbSelectedTasks === 1"}],staticClass:"column side-column",attrs:{id:"side-column"}},[i("task-info",{attrs:{task:e.selectedTasks.values().next().value}})],1),i("edit-episode-modal",{attrs:{active:e.modals.isNewDisplayed,"is-loading":e.loading.episode,"is-error":e.errors.episode,"episode-to-episode":e.episodeToEdit},on:{cancel:function(t){e.modals.isNewDisplayed=!1},confirm:e.confirmEditEpisode}}),i("delete-modal",{ref:"delete-episode-modal",attrs:{active:e.modals.isDeleteDisplayed,"is-loading":e.loading.del,"is-error":e.errors.del,text:e.deleteText(),"error-text":e.$t("episodes.delete_error")},on:{cancel:function(t){e.modals.isDeleteDisplayed=!1},confirm:e.confirmDeleteEpisode}}),i("delete-modal",{ref:"delete-metadata-modal",attrs:{active:e.modals.isDeleteMetadataDisplayed,"is-loading":e.loading.deleteMetadata,"is-error":e.errors.deleteMetadata,text:e.$t("productions.metadata.delete_text"),"error-text":e.$t("productions.metadata.delete_error")},on:{cancel:function(t){e.modals.isDeleteMetadataDisplayed=!1},confirm:e.confirmDeleteMetadata}}),i("hard-delete-modal",{ref:"delete-all-tasks-modal",attrs:{active:e.modals.isDeleteAllTasksDisplayed,"is-loading":e.loading.deleteAllTasks,"is-error":e.errors.deleteAllTasks,text:e.deleteAllTasksText(),"error-text":e.$t("tasks.delete_all_error"),"lock-text":e.deleteAllTasksLockText,"selection-option":!0},on:{cancel:function(t){e.modals.isDeleteAllTasksDisplayed=!1},confirm:e.confirmDeleteAllTasks}}),i("create-tasks-modal",{attrs:{active:e.modals.isCreateTasksDisplayed,"is-loading":e.loading.creatingTasks,"is-loading-stay":e.loading.creatingTasksStay,"is-error":e.errors.creatingTasks,title:e.$t("tasks.create_tasks_episode"),text:e.$t("tasks.create_tasks_episode_explaination"),"error-text":e.$t("tasks.create_tasks_episode_failed")},on:{cancel:e.hideCreateTasksModal,confirm:e.confirmCreateTasks,"confirm-and-stay":e.confirmCreateTasksAndStay}}),i("add-metadata-modal",{attrs:{active:e.modals.isAddMetadataDisplayed,"is-loading":e.loading.addMetadata,"is-loading-stay":e.loading.addMetadata,"is-error":e.errors.addMetadata,"descriptor-to-edit":e.descriptorToEdit,"entity-type":"Episode"},on:{cancel:e.closeMetadataModal,confirm:e.confirmAddMetadata}}),i("add-thumbnails-modal",{ref:"add-thumbnails-modal",attrs:{parent:"episodes",active:e.modals.isAddThumbnailsDisplayed,"is-loading":e.loading.addThumbnails,"is-error":e.errors.addThumbnails},on:{cancel:e.hideAddThumbnailsModal,confirm:e.confirmAddThumbnails}}),i("build-filter-modal",{ref:"build-filter-modal",attrs:{active:e.modals.isBuildFilterDisplayed,"entity-type":"episode"},on:{cancel:function(t){e.modals.isBuildFilterDisplayed=!1},confirm:e.confirmBuildFilter}}),i("edit-episode-modal",{attrs:{active:e.modals.isNewDisplayed,"is-loading":e.loading.edit,"is-error":e.errors.edit,"episode-to-edit":e.episodeToEdit},on:{cancel:function(t){e.modals.isNewDisplayed=!1},confirm:e.confirmEditEpisode}}),i("hard-delete-modal",{attrs:{active:e.modals.isDeleteDisplayed,"is-loading":e.loading.del,"is-error":e.errors.del,text:e.deleteText(),"error-text":e.$t("episodes.delete_error"),"lock-text":e.episodeToDelete?e.episodeToDelete.name:""},on:{cancel:function(t){e.modals.isDeleteDisplayed=!1},confirm:e.confirmDeleteEpisode}})],1)},a=[],o=i("c1df"),n=i.n(o),r=i("2f62"),d=i("3455"),l=i("2229"),c=i("8c97"),u=i("b06c"),p=i("9050"),m=i("5c2e"),f=i("b5ed"),h=i("3bc4"),y=i("6ca5"),g=i("c31e"),b=i("de40"),v=i("d863"),C=i("5f48"),k=i("4916"),S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-list"},[i("div",{directives:[{name:"scroll",rawName:"v-scroll",value:e.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"datatable-wrapper"},[i("table-header-menu",{ref:"headerMenu",attrs:{"is-minimized":e.hiddenColumns[e.lastHeaderMenuDisplayed],"is-edit-allowed":e.isCurrentUserManager,"is-sticked":e.stickedColumns[e.lastHeaderMenuDisplayed]},on:{"minimize-clicked":function(t){return e.onMinimizeColumnToggled()},"delete-all-clicked":function(t){return e.onDeleteAllTasksClicked()},"sort-by-clicked":function(t){return e.onSortByTaskTypeClicked()},"select-column":e.onSelectColumn,"toggle-stick":function(t){return e.stickColumnClicked()}}}),i("table-metadata-header-menu",{ref:"headerMetadataMenu",attrs:{"is-episode-allowed":e.isMetadataColumnEditAllowed(e.lastMetadaDataHeaderMenuDisplayed),"is-sticked":e.stickedColumns[e.lastMetadaDataHeaderMenuDisplayed]},on:{"edit-clicked":function(t){return e.onEpisodeMetadataClicked()},"delete-clicked":function(t){return e.onDeleteMetadataClicked()},"sort-by-clicked":function(t){return e.onSortByMetadataClicked()},"toggle-stick":function(t){return e.metadataStickColumnClicked(t)}}}),i("table",{staticClass:"datatable"},[i("thead",{directives:[{name:"columns-resizable",rawName:"v-columns-resizable"}],staticClass:"datatable-head",attrs:{id:"datatable-episode"}},[i("tr",[i("th",{ref:"th-episode",staticClass:"name episode-name datatable-row-header",attrs:{scope:"col"}},[i("div",{staticClass:"flexrow"},[i("span",{staticClass:"flexrow-item"},[e._v(" "+e._s(e.$t("episodes.fields.name"))+" ")]),!e.isCurrentUserManager&&!e.isCurrentUserSupervisor||e.isLoading?e._e():i("button-simple",{staticClass:"is-small flexrow-item",attrs:{icon:"plus",text:""},on:{click:e.onAddMetadataClicked}})],1)]),e._l(e.stickedVisibleMetadataDescriptors,(function(t,s){return e.isShowInfos?i("metadata-header",{key:t.id,ref:"editor-"+s,refInFor:!0,attrs:{descriptor:t,left:e.offsets["editor-"+s]?e.offsets["editor-"+s]+"px":"0","is-stick":""},on:{"show-metadata-header-menu":function(i){return e.showMetadataHeaderMenu(t.id,i)}}}):e._e()})),e._l(e.stickedDisplayedValidationColumns,(function(t,s){return e.isLoading?e._e():i("validation-header",{key:t,ref:"validation-"+s,refInFor:!0,attrs:{"hidden-columns":e.hiddenColumns,"column-id":t,"validation-style":e.getValidationStyle(t),left:e.offsets["validation-"+s]?e.offsets["validation-"+s]+"px":"0",type:"editor","is-stick":""},on:{"show-header-menu":function(i){return e.showHeaderMenu(t,s,i)}}})})),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeDescription?i("th",{staticClass:"description selectable",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("episodes.fields.description"))+" ")]):e._e(),e._l(e.nonStickedVisibleMetadataDescriptors,(function(t){return e.isShowInfos?i("metadata-header",{key:t.id,attrs:{descriptor:t},on:{"show-metadata-header-menu":function(i){return e.showMetadataHeaderMenu(t.id,i)}}}):e._e()})),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeTime&&e.metadataDisplayHeaders.timeSpent?i("th",{ref:"th-spent",staticClass:"time-spent",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("episodes.fields.time_spent"))+" ")]):e._e(),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeEstimation&&e.metadataDisplayHeaders.estimation?i("th",{ref:"th-spent",staticClass:"estimation",attrs:{scope:"col",title:e.$t("main.estimation")}},[e._v(" "+e._s(e.$t("main.estimation_short"))+" ")]):e._e(),e._l(e.nonStickedDisplayedValidationColumns,(function(t,s){return e.isLoading?e._e():i("validation-header",{key:t,attrs:{"hidden-columns":e.hiddenColumns,"column-id":t,"validation-style":e.getValidationStyle(t),type:"episodes"},on:{"show-header-menu":function(i){e.showHeaderMenu(t,s,i)}}})})),i("th",{ref:"actionsSection",staticClass:"actions",attrs:{scope:"col"}},[e.isCurrentUserManager&&e.displayedEpisodes.length>0&&!e.isLoading?i("button-simple",{class:{"is-small":!0,highlighted:e.isEmptyTask},attrs:{icon:"plus",text:e.$t("tasks.create_tasks")},on:{click:function(t){return e.$emit("create-tasks")}}}):e._e(),i("table-metadata-selector-menu",{directives:[{name:"show",rawName:"v-show",value:e.columnSelectorDisplayed&&e.isShowInfos,expression:"columnSelectorDisplayed && isShowInfos"}],ref:"headerMetadataSelectorMenu",attrs:{metadataDisplayHeaders:e.metadataDisplayHeaders,descriptors:e.episodeMetadataDescriptors,exclude:{timeSpent:!e.isEpisodeTime,estimation:!e.isEpisodeEstimation},namespace:"episodes"},on:{"update:metadataDisplayHeaders":function(t){e.metadataDisplayHeaders=t},"update:metadata-display-headers":function(t){e.metadataDisplayHeaders=t}}}),e.episodeMetadataDescriptors.length>0&&e.isShowInfos?i("button-simple",{staticClass:"is-small is-pulled-right",attrs:{icon:"down"},on:{click:e.toggleColumnSelector}}):e._e()],1)],2)]),i("tbody",{staticClass:"datatable-body"},e._l(e.displayedEpisodes,(function(t,s){return!e.isLoading&&e.isListVisible?i("tr",{key:t.id,staticClass:"datatable-row",class:{canceled:t.canceled},attrs:{scope:"row"}},[i("th",{class:{"datatable-row-header":!0,"episode-name":!0,name:!0,strong:!t.canceled}},[i("div",{staticClass:"flexrow"},[i("entity-thumbnail",{attrs:{entity:t,width:e.isBigThumbnails?150:50,height:e.isBigThumbnails?100:33,"empty-width":e.isBigThumbnails?150:50,"empty-height":e.isBigThumbnails?100:34}}),i("router-link",{attrs:{tabindex:"-1",title:t.name,to:e.episodePath(t.id)}},[e._v(" "+e._s(t.name)+" ")])],1)]),e._l(e.stickedVisibleMetadataDescriptors,(function(a,o){return e.isShowInfos?i("td",{key:t.id+"-"+a.id,ref:"editor-"+s+"-"+o,refInFor:!0,staticClass:"metadata-descriptor datatable-row-header",style:{left:e.offsets["editor-"+o]?e.offsets["editor-"+o]+"px":"0"},attrs:{title:t.data?t.data[a.field_name]:""}},[0===a.choices.length&&(e.isCurrentUserManager||e.isSupervisorInDepartments(a.departments))?i("input",{staticClass:"input-editor",domProps:{value:e.getMetadataFieldValue(a,t)},on:{input:function(i){return e.onMetadataFieldChanged(t,a,i)},keyup:function(t){return t.ctrlKey?function(t){return e.onInputKeyUp(t,s,o)}.apply(null,arguments):null}}}):e.isCurrentUserManager||e.isSupervisorInDepartments(a.departments)?i("span",{staticClass:"select"},[i("select",{staticClass:"select-input",on:{keyup:function(t){return t.ctrlKey?function(t){return e.onInputKeyUp(t,s,o)}.apply(null,arguments):null},change:function(i){return e.onMetadataFieldChanged(t,a,i)}}},e._l(e.getDescriptorChoicesOptions(a),(function(s,o){return i("option",{key:t.id+"-"+a.id+"-"+o+"-"+s.label+"-"+s.value,domProps:{value:s.value,selected:e.getMetadataFieldValue(a,t)===s.value}},[e._v(" "+e._s(s.label)+" ")])})),0)]):i("span",{staticClass:"metadata-value selectable"},[e._v(" "+e._s(e.getMetadataFieldValue(a,t))+" ")])]):e._e()})),e._l(e.stickedDisplayedValidationColumns,(function(a,o){return e.isLoading?e._e():i("validation-cell",{key:a+"-"+t.id,ref:"validation-"+s+"-"+o,refInFor:!0,class:{"validation-cell":!e.hiddenColumns[a],"hidden-validation-cell":e.hiddenColumns[a],"datatable-row-header":!0},attrs:{column:e.taskTypeMap.get(a),columnY:o,entity:t,"is-assignees":e.isShowAssignations,"is-static":!0,left:e.offsets["validation-"+o]?e.offsets["validation-"+o]+"px":"0",minimized:e.hiddenColumns[a],rowX:s,selected:e.isSelected(s,o),sticked:!0,"task-test":e.taskMap.get(t.validations.get(a))},on:{select:function(t){return e.onTaskSelected(t,!0)},unselect:function(t){return e.onTaskUnselected(t,!0)}}})})),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeDescription?i("description-cell",{staticClass:"description",attrs:{entry:t,editable:e.isCurrentUserManager},on:{"description-changed":function(i){return e.onDescriptionChanged(t,i)}}}):e._e(),e._l(e.nonStickedVisibleMetadataDescriptors,(function(a,o){return e.isShowInfos?i("td",{key:t.id+"-"+a.id,staticClass:"metadata-descriptor",attrs:{title:t.data?t.data[a.field_name]:""}},[0===a.choices.length&&(e.isCurrentUserManager||e.isSupervisorInDepartments(a.departments))?i("input",{staticClass:"input-editor",domProps:{value:e.getMetadataFieldValue(a,t)},on:{input:function(i){return e.onMetadataFieldChanged(t,a,i)},keyup:function(t){return t.ctrlKey?function(t){return e.onInputKeyUp(t,s,o)}.apply(null,arguments):null}}}):e.isCurrentUserManager||e.isSupervisorInDepartments(a.departments)?i("span",{staticClass:"select"},[i("select",{staticClass:"select-input",on:{keyup:function(t){return t.ctrlKey?function(t){return e.onInputKeyUp(t,s,o)}.apply(null,arguments):null},change:function(i){return e.onMetadataFieldChanged(t,a,i)}}},e._l(e.getDescriptorChoicesOptions(a),(function(s,o){return i("option",{key:t.id+"-"+a.id+"-"+o+"-"+s.label+"-"+s.value,domProps:{value:s.value,selected:e.getMetadataFieldValue(a,t)===s.value}},[e._v(" "+e._s(s.label)+" ")])})),0)]):i("span",{staticClass:"metadata-value selectable"},[e._v(" "+e._s(e.getMetadataFieldValue(a,t))+" ")])]):e._e()})),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeTime&&e.metadataDisplayHeaders.timeSpent?i("td",{staticClass:"time-spent selectable"},[e._v(" "+e._s(e.formatDuration(t.timeSpent))+" ")]):e._e(),!e.isCurrentUserClient&&e.isShowInfos&&e.isEpisodeEstimation&&e.metadataDisplayHeaders.estimation?i("td",{staticClass:"estimation selectable"},[e._v(" "+e._s(e.formatDuration(t.estimation))+" ")]):e._e(),e._l(e.nonStickedDisplayedValidationColumns,(function(a,o){return e.isLoading?e._e():i("validation-cell",{key:a+"-"+t.id,ref:"validation-"+s+"-"+(o+e.stickedDisplayedValidationColumns.length),refInFor:!0,class:{"validation-cell":!e.hiddenColumns[a],"hidden-validation-cell":e.hiddenColumns[a]},attrs:{column:e.taskTypeMap.get(a),entity:t,"task-test":e.taskMap.get(t.validations?t.validations.get(a):null),minimized:e.hiddenColumns[a],selected:e.isSelected(s,o+e.stickedDisplayedValidationColumns.length),rowX:s,columnY:o,"is-assignees":e.isShowAssignations},on:{select:e.onTaskSelected,unselect:e.onTaskUnselected}})})),e.isCurrentUserManager?i("row-actions-cell",{attrs:{entry:t},on:{"delete-clicked":function(i){return e.$emit("delete-clicked",t)},"edit-clicked":function(i){return e.$emit("edit-clicked",t)}}}):i("td",{staticClass:"actions"})],2):e._e()})),0)])],1),i("table-info",{attrs:{"is-loading":e.isLoading,"is-error":e.isError}}),e.isEmptyList&&e.isCurrentUserClient&&!e.isLoading?i("div",{staticClass:"has-text-centered"},[e._m(0),i("p",{staticClass:"info"},[e._v(e._s(e.$t("episodes.empty_list_client")))])]):e._e(),e.isEmptyList||e.isLoading?e._e():i("p",{staticClass:"has-text-centered nb-episodes"},[e._v(" "+e._s(e.displayedEpisodesLength)+" "+e._s(e.$tc("episodes.number",e.displayedEpisodesLength))+" "),e.displayedEpisodesTimeSpent>0&&e.displayedEpisodesEstimation>0?i("span",[e._v(" ("+e._s(e.formatDuration(e.displayedEpisodesTimeSpent))+" "+e._s(e.$tc("main.days_spent",e.displayedEpisodesTimeSpent))+", "+e._s(e.formatDuration(e.displayedEpisodesEstimation))+" "+e._s(e.$tc("main.man_days",e.displayedEpisodesEstimation))+") ")]):e._e()])],1)},E=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"info"},[s("img",{attrs:{src:i("732b")}})])}],D=i("bd69"),T=i("eb23"),_=i("5097"),w=i("31f2"),M=i("35bb"),x=i("0fcb"),O=i("bb21"),P=i("fec0"),$=i("14b2"),j=i("5b1c"),A=i("64d9"),L=i("1eb4"),I=i("e60b"),F=i("cb0e"),U=i("ab3e");function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function H(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function B(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?H(Object(i),!0).forEach((function(t){N(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function N(e,t,i){return t=K(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function K(e){var t=q(e,"string");return"symbol"===V(t)?t:String(t)}function q(e,t){if("object"!==V(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!==V(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var z={name:"episode-list",mixins:[D["a"],T["a"],w["a"],_["a"],M["a"]],props:{displayedEpisodes:{type:Array,default:function(){return[]}},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}},departmentFilter:{type:Array,default:function(){return[]}}},data:function(){return{type:"episode",hiddenColumns:{},lastHeaderMenuDisplayed:null,lastMetadaDataHeaderMenuDisplayed:null,lastHeaderMenuDisplayedIndexInGrid:null,lastSelectedEpisode:null,lastSelection:null,metadataDisplayHeaders:{estimation:!0,timeSpent:!0},offsets:{},stickedColumns:{}}},components:{ButtonSimple:b["a"],DescriptionCell:x["a"],EntityThumbnail:O["a"],MetadataHeader:P["a"],RowActionsCell:$["a"],TableHeaderMenu:L["a"],TableMetadataHeaderMenu:j["a"],TableMetadataSelectorMenu:A["a"],TableInfo:I["a"],ValidationCell:F["a"],ValidationHeader:U["a"]},computed:B(B({},Object(r["c"])(["currentProduction","episodeMap","episodeFilledColumns","episodeMetadataDescriptors","episodes","episodeSearchText","episodeSelectionGrid","currentEpisode","displayedEpisodesEstimation","displayedEpisodesLength","displayedEpisodesTimeSpent","isBigThumbnails","isCurrentUserAdmin","isCurrentUserManager","isCurrentUserSupervisor","isCurrentUserClient","isSingleEpisode","isEpisodeDescription","isEpisodeEstimation","isEpisodeTime","isShowAssignations","isShowInfos","nbSelectedTasks","taskMap","taskTypeMap","user"])),{},{isEmptyList:function(){return this.displayedEpisodes.length&&0===this.displayedEpisodes[0].length&&!this.isLoading&&!this.isError&&(!this.episodeSearchText||0===this.episodeSearchText.length)},isListVisible:function(){return!this.isLoading&&!this.isError&&this.displayedEpisodesLength>0},visibleColumns:function(){var e=2;return e+=!this.isCurrentUserClient&&this.isShowInfos&&this.isEpisodeDescription?1:0,e+=this.visibleMetadataDescriptors.length,e+=!this.isCurrentUserClient&&this.isShowInfos&&this.isEpisodeTime&&this.metadataDisplayHeaders.timeSpent?1:0,e+=!this.isCurrentUserClient&&this.isShowInfos&&this.isEpisodeEstimation&&this.metadataDisplayHeaders.estimation?1:0,e+=this.displayedValidationColumns.length,e},displayedValidationColumns:function(){var e=this;return this.validationColumns.filter((function(t){return e.episodeFilledColumns[t]&&(!e.hiddenColumns[t]||e.isShowInfos)}))},metadataDescriptors:function(){return this.episodeMetadataDescriptors},localStorageStickKey:function(){return"stick-episodes-".concat(this.currentProduction.id)}}),methods:B(B({},Object(r["b"])(["setEpisodeSelection"])),{},{isSelected:function(e,t){return this.episodeSelectionGrid[e]&&this.episodeSelectionGrid[e][t]},episodePath:function(e){return this.getPath("episode",e)},getPath:function(e,t){var i={name:e,params:{production_id:this.currentProduction.id}};return t&&(i.params.episode_id=t),i}}),watch:{displayedEpisodes:function(){this.$options.lineIndex={}},validationColumns:function(){this.initHiddenColumns(this.validationColumns,this.hiddenColumns)},stickedColumns:function(){this.updateOffsets()},isLoading:function(){this.updateOffsets()}}},Q=z,Y=(i("536a"),i("2877")),G=Object(Y["a"])(Q,S,E,!1,null,"79a92dc4",null),R=G.exports,W=i("2c1a"),J=i("4d04"),X=i("55ce"),Z=i("eae1"),ee=i("82f0"),te=i("0e99"),ie=i("9d94");function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ae(e){return de(e)||re(e)||ne(e)||oe()}function oe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ne(e,t){if(e){if("string"===typeof e)return le(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?le(e,t):void 0}}function re(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function de(e){if(Array.isArray(e))return le(e)}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function ce(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ue(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(i),!0).forEach((function(t){pe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ce(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function pe(e,t,i){return t=me(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(e){var t=fe(e,"string");return"symbol"===se(t)?t:String(t)}function fe(e,t){if("object"!==se(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!==se(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var he={name:"episodes",mixins:[u["a"],p["a"]],components:{ActionPanel:h["a"],AddMetadataModal:m["a"],AddThumbnailsModal:f["a"],BigThumbnailsButton:y["a"],BuildFilterModal:g["a"],ButtonSimple:b["a"],CreateTasksModal:v["a"],DeleteModal:C["a"],EditEpisodeModal:k["a"],EpisodeList:R,HardDeleteModal:W["a"],SearchField:J["a"],SearchQueryList:X["a"],SortingInfo:Z["a"],ShowAssignationsButton:ee["a"],ShowInfosButton:te["a"],TaskInfo:ie["default"]},data:function(){return{type:"episode",deleteAllTasksLockText:null,descriptorToEdit:{},departmentFilter:[],episodeToDelete:null,episodeToEdit:null,formData:null,genericColumns:["metadata_column_name => text value","task_type_name => task_status_name","task_type_name comment => comment text"],historyEdit:{},initialLoading:!0,isSearchActive:!1,optionalColumns:["Description"],pageName:"Episodes",parsedCSV:[],selectedDepartment:"ALL",taskTypeForTaskDeletion:null,modals:{isAddMetadataDisplayed:!1,isAddThumbnailsDisplayed:!1,isBuildFilterDisplayed:!1,isCreateTasksDisplayed:!1,isDeleteDisplayed:!1,isDeleteMetadataDisplayed:!1,isDeleteAllTasksDisplayed:!1,isImportRenderDisplayed:!1,isImportDisplayed:!1,isNewDisplayed:!1},loading:{addMetadata:!1,addThumbnails:!1,creatingTasks:!1,creatingTasksStay:!1,deleteAllTasks:!1,deleteMetadata:!1,episode:!1,del:!1,importing:!1,stay:!1},errors:{addMetadata:!1,deleteMetadata:!1,creatingTasks:!1,deleteAllTasks:!1,importing:!1,importingError:null}}},beforeDestroy:function(){this.clearSelectedEpisodes()},created:function(){this.setLastProductionScreen("episodes")},mounted:function(){var e=this,t="";this.episodeSearchText&&this.episodeSearchText.length>0&&this.searchField.setValue(this.episodeSearchText),this.$route.query.search&&this.$route.query.search.length>0&&(t=""+this.$route.query.search),"undefined"===t&&(t=""),this.$refs["episode-list"].setScrollPosition(this.episodeListScrollPosition),this.onSearchChange(),this.$refs["episode-list"].setScrollPosition(this.episodeListScrollPosition),!this.isCurrentUserManager&&this.user.departments.length>0?(this.selectedDepartment="MY_DEPARTMENTS",this.departmentFilter=this.user.departments):this.departmentFilter=[];var i=function(){e.initialLoading=!1,e.$refs["episode-list"]&&(e.$refs["episode-search-field"].setValue(t),e.onSearchChange(),e.$refs["episode-list"].setScrollPosition(e.episodeListScrollPosition))};this.episodeMap.size<1||0===this.episodeValidationColumns.length||this.episodeMap.values().next().project_id!==this.currentProduction.id?this.loadEpisodesWithTasks().then((function(){e.initialLoading=!1})).catch(console.error):(this.isEpisodesLoading||(this.initialLoading=!1),i())},computed:ue(ue({},Object(r["c"])(["currentEpisode","currentProduction","displayedEpisodes","departments","episodeMap","episodes","episodeSearchQueries","isCurrentUserClient","isCurrentUserManager","isEpisodeDescription","isEpisodeEstimation","isEpisodeTime","isEpisodesLoading","isEpisodesLoadingError","isShowAssignations","isTVShow","nbSelectedTasks","openProductions","selectedTasks","episodeMap","episodeFilledColumns","episodesCsvFormData","episodeSearchText","episodeValidationColumns","episodeListScrollPosition","episodeSorting","taskTypeMap","user","departmentMap","productionEpisodeTaskTypes"])),{},{renderColumns:function(){var e=[].concat(ae(this.dataMatchers),ae(this.optionalColumns));return this.productionEpisodeTaskTypes.forEach((function(t){e.push(t.name),e.push(t.name+" comment")})),e},filteredEpisodes:function(){var e={};return this.displayedEpisodes.forEach((function(t){var i=t.name;e[i]=!0})),e},metadataDescriptors:function(){return this.episodeMetadataDescriptors}}),methods:ue(ue({},Object(r["b"])(["addMetadataDescriptor","createTasks","changeEpisodeSort","clearSelectedEpisodes","commentTaskWithPreview","deleteAllEpisodeTasks","deleteEpisode","deleteMetadataDescriptor","editEpisode","getEpisodesCsvLines","hideAssignations","loadEpisodesWithTasks","newEpisode","removeEpisodeSearch","saveEpisodeSearch","setLastProductionScreen","setPreview","setEpisodeSearch","showAssignations","uploadEpisodeFile"])),{},{confirmAddMetadata:function(e){var t=this;this.loading.addMetadata=!0,e.entity_type="Episode",this.addMetadataDescriptor(e).then((function(){t.loading.addMetadata=!1,t.modals.isAddMetadataDisplayed=!1})).catch((function(e){console.error(e),t.loading.addMetadata=!1,t.errors.addMetadata=!0}))},showNewModal:function(){this.episodeToEdit={},this.modals.isNewDisplayed=!0},confirmDeleteEpisode:function(){var e=this;this.loading.del=!0,this.errors.del=!1,this.deleteEpisode(this.episodeToDelete).then((function(){e.loading.del=!1,e.modals.isDeleteDisplayed=!1})).catch((function(t){console.error(t),e.loading.del=!1,e.errors.del=!0}))},runTasksCreation:function(e,t){return this.errors.creatingTasks=!1,this.createTasks({type:"episodes",task_type_id:e.task_type_id,project_id:this.currentProduction.id,selectionOnly:t})},reset:function(){var e=this;this.initialLoading=!1,this.loadEpisodesWithTasks((function(t){t&&console.error(t),e.initialLoading=!1}))},resetEditModal:function(){var e={name:""};this.openProductions.length>0&&(e.production_id=this.openProductions[0].id),this.episodeToEdit=e},applySearch:function(e){this.setEpisodeSearch(e),this.setSearchInUrl(),this.isSearchActive=!0},saveSearchQuery:function(e){this.saveEpisodeSearch(e).catch(console.error)},removeSearchQuery:function(e){this.removeEpisodeSearch(e).catch(console.error)},onExportClick:function(){var e=this;this.getEpisodesCsvLines().then((function(t){var i=[n()().format("YYYY-MM-DD"),"kitsu",e.currentProduction.name,e.$t("episodes.title")],s=c["a"].slugify(i.join("_")),a=[e.$t("episodes.fields.name"),e.$t("episodes.fields.description")];e.currentEpisode&&a.splice(0,0,"Episode"),Object(l["d"])(ae(e.currentProduction.descriptors)).filter((function(e){return"Episode"===e.entity_type})).forEach((function(e){a.push(e.name)})),e.isEpisodeTime&&a.push(e.$t("episodes.fields.time_spent")),e.isEpisodeEstimation&&a.push(e.$t("main.estimation_short")),e.episodeValidationColumns.forEach((function(t){a.push(e.taskTypeMap.get(t).name),a.push("Assignations")})),d["a"].buildCsvFile(s,[a].concat(t))}))},onFieldChanged:function(e){var t=e.entry,i=e.fieldName,s=e.value,a={id:t.id,description:t.description};a[i]=s,this.editEpisode(a)},onMetadataChanged:function(e){var t=e.entry,i=e.descriptor,s=e.value,a={};a[i.field_name]=s;var o={id:t.id,data:a};this.editEpisode(o)},onEditClicked:function(e){this.episodeToEdit=e,this.modals.isNewDisplayed=!0},onDeleteClicked:function(e){this.episodeToDelete=e,this.modals.isDeleteDisplayed=!0},confirmEditEpisode:function(e){var t=this;this.loading.edit=!0,this.errors.edit=!1,e.id?this.editEpisode(e).then((function(){t.loading.edit=!1,t.modals.isNewDisplayed=!1})).catch((function(){t.loading.edit=!1,t.errors.edit=!0})):(e.project_id=this.currentProduction.id,this.newEpisode(e).then((function(){t.loading.edit=!1,t.modals.isNewDisplayed=!1})).catch((function(){t.loading.edit=!1,t.errors.edit=!0})))},deleteText:function(){var e=this.episodeToDelete;return e?this.$t("episodes.delete_text",{name:e.name}):""}}),watch:{$route:function(){if(this.$route.query){var e=this.$route.query.search,t=this.$refs["episode-search-field"].getValue();e!==t&&(this.searchField.setValue(e),this.applySearch(e))}},currentProduction:function(){this.$refs["episode-search-field"].setValue(""),this.$store.commit("SET_EDIT_LIST_SCROLL_POSITION",0),this.initialLoading=!1,this.reset()},isEpisodesLoading:function(){var e=this;if(!this.isEpisodesLoading){var t="";this.$route.query.search&&this.$route.query.search.length>0&&(t=""+this.$route.query.search),this.initialLoading=!1,this.$refs["episode-search-field"].setValue(t),this.$nextTick((function(){e.applySearch(t)})),this.$refs["episode-list"]&&this.$refs["episode-list"].setScrollPosition(this.episodeListScrollPosition)}}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," ").concat(this.$t("episodes.title")," - Kitsu")}}},ye=he,ge=(i("b524"),Object(Y["a"])(ye,s,a,!1,null,"321ac136",null));t["default"]=ge.exports},b524:function(e,t,i){"use strict";i("745f")}}]);
//# sourceMappingURL=chunk-1c033f68.9e9b1015.js.map