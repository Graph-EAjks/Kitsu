(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-302c8f8e"],{"1f38":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"columns fixed-page episode"},[i("div",{staticClass:"column main-column"},[i("div",{staticClass:"page-header flexrow"},[i("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:e.getEpisodesRoute}},[i("corner-left-up-icon")],1),i("span",{staticClass:"flexrow-item ml2"},[e.currentEpisode?i("entity-thumbnail",{staticClass:"entity-thumbnail",attrs:{entity:e.currentEpisode,"empty-width":120,"empty-height":50,width:120}}):e._e()],1),i("div",{staticClass:"flexrow-item"},[i("page-title",{staticClass:"entity-title",attrs:{text:e.title}})],1)],1),i("div",{staticClass:"flexrow infos"},[i("div",{staticClass:"flexrow-item block flexcolumn"},[i("page-subtitle",{attrs:{text:e.$t("episodes.tasks")}}),i("entity-task-list",{staticClass:"task-list",attrs:{entries:e.currentTasks.map((function(e){return e.id})),"is-loading":!e.currentEpisode,"is-error":!1},on:{"task-selected":e.onTaskSelected}})],1),i("div",{staticClass:"flexrow-item block flexcolumn"},[i("div",{staticClass:"flexrow"},[i("page-subtitle",{attrs:{text:e.$t("main.info")}}),i("div",{staticClass:"filler"}),i("div",{staticClass:"flexrow-item has-text-right"},[e.isCurrentUserManager?i("button-simple",{attrs:{icon:"edit"},on:{click:function(t){e.modals.edit=!0}}}):e._e()],1)],1),i("div",{staticClass:"table-body"},[e.currentEpisode?i("table",{staticClass:"datatable no-header"},[i("tbody",{staticClass:"datatable-body"},[i("tr",{staticClass:"datatable-row"},[i("td",{staticClass:"field-label"},[e._v(e._s(e.$t("shots.fields.description")))]),i("description-cell",{attrs:{entry:e.currentEpisode,full:!0}})],1),e._l(e.episodeMetadataDescriptors,(function(t){return i("tr",{key:t.id,staticClass:"datatable-row"},[i("td",{staticClass:"field-label"},[e._v(e._s(t.name))]),i("td",[e._v(" "+e._s(e.currentEpisode&&e.currentEpisode.data?e.currentEpisode.data[t.field_name]:"")+" ")])])}))],2)]):e._e()])])]),i("div",{staticClass:"episode-data block"},[i("div",{staticClass:"flexrow"},[i("combobox-styled",{staticClass:"section-combo flexrow-item",attrs:{options:e.entityNavOptions},model:{value:e.currentSection,callback:function(t){e.currentSection=t},expression:"currentSection"}}),i("span",{directives:[{name:"show",rawName:"v-show",value:"casting"===e.currentSection,expression:"currentSection === 'casting'"}]},[e._v(" "+e._s(e.nbAssets)+" "+e._s(e.$tc("assets.number",e.nbAssets))+" ")]),i("span",{directives:[{name:"show",rawName:"v-show",value:"casting"===e.currentSection&&e.currentEpisode.is_casting_standby,expression:"currentSection === 'casting' && currentEpisode.is_casting_standby"}],staticClass:"tag tag-standby"},[e._v(" "+e._s(e.$t("breakdown.fields.standby"))+" ")]),i("div",{staticClass:"filler"}),i("span",{directives:[{name:"show",rawName:"v-show",value:"schedule"===e.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"flexrow-item mt05"},[e._v(" "+e._s(e.$t("schedule.zoom_level"))+": ")]),i("combobox-number",{directives:[{name:"show",rawName:"v-show",value:"schedule"===e.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"zoom-level flexrow-item ",attrs:{options:e.zoomOptions,"is-simple":""},model:{value:e.zoomLevel,callback:function(t){e.zoomLevel=t},expression:"zoomLevel"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"casting"===e.currentSection,expression:"currentSection === 'casting'"}],staticClass:"episode-casting"},[e.currentEpisode?i("div",[e.currentEpisode&&e.currentEpisode.castingAssetsByType&&e.currentEpisode.castingAssetsByType[0].length>0?i("div",e._l(e.currentEpisode.castingAssetsByType,(function(t){return i("div",{key:t.length>0?t[0].asset_type_name:"",staticClass:"type-assets"},[i("div",{staticClass:"asset-type"},[e._v(" "+e._s(t.length>0?t[0].asset_type_name:"")+" ("+e._s(t.length)+") ")]),i("div",{staticClass:"asset-list"},e._l(t,(function(t){return i("router-link",{key:t.id,staticClass:"asset-link",attrs:{to:e.buildAssetRoute(t)}},[i("entity-thumbnail",{staticClass:"entity-thumbnail",attrs:{entity:t,square:!0,"empty-width":103,"empty-height":103,"with-link":!1,"no-cache":!0}}),i("div",[e._v(" "+e._s(t.asset_name)+" "),t.nb_occurences>1?i("span",[e._v(" ("+e._s(t.nb_occurences)+") ")]):e._e()]),i("div",{staticClass:"ready-for flexrow"},[t.ready_for?i("task-type-name",{staticClass:"flexrow-item",attrs:{"task-type":e.taskTypeMap.get(t.ready_for),"current-production-id":e.currentProduction.id,title:"Ready for: "+e.taskTypeMap.get(t.ready_for).name}}):e._e()],1)],1)})),1)])})),0):i("div",{staticClass:"mt1"},[e._v(" "+e._s(e.$t("episodes.no_casting"))+" ")])]):i("table-info",{attrs:{"is-loading":e.casting.isLoading,"is-error":e.casting.isError}})],1),e.scheduleItems[0].children.length>0?i("div",{directives:[{name:"show",rawName:"v-show",value:"schedule"===e.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"schedule mt1"},[i("div",{staticClass:"wrapper"},[i("schedule",{ref:"schedule-widget",attrs:{"start-date":e.tasksStartDate,"end-date":e.tasksEndDate,hierarchy:e.scheduleItems,"zoom-level":e.zoomLevel,"is-loading":!1,"is-estimation-linked":!0,"hide-root":!0,"with-milestones":!1}})],1)]):i("div",{directives:[{name:"show",rawName:"v-show",value:"schedule"===e.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"mt1"},[e._v(" "+e._s(e.$t("main.empty_schedule"))+" ")]),"preview-files"===e.currentSection?i("entity-preview-files",{attrs:{entity:e.currentEpisode}}):e._e(),"activity"===e.currentSection?i("entity-news",{attrs:{entity:e.currentEpisode}}):e._e(),"time-logs"===e.currentSection?i("entity-time-logs",{attrs:{entity:e.currentEpisode}}):e._e()],1)]),e.currentTask?i("div",{staticClass:"column side-column"},[i("task-info",{attrs:{task:e.currentTask}})],1):e._e(),i("edit-episode-modal",{ref:"edit-episode-modal",attrs:{active:e.modals.edit,"is-loading":e.loading.edit,"is-error":e.errors.edit,"episode-to-edit":e.currentEpisode},on:{cancel:function(t){e.modals.edit=!1},confirm:e.confirmEditEpisode}})],1)},r=[],n=i("2f62"),o=i("0a35"),a=i("9d8b"),c=i("f58f"),d=i("31f2"),l=i("de40"),u=i("1e4c"),p=i("9751"),f=i("0fcb"),m=i("4916"),y=i("22a2"),h=i("b2f9"),b=i("0024"),v=i("4ee3"),g=i("bb21"),E=i("8d07"),w=i("8751"),_=i("d7c7"),C=i("e60b"),k=i("9d94"),x=i("274f");function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function O(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?T(Object(i),!0).forEach((function(t){j(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function j(e,t,i){return t=P(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e){var t=$(e,"string");return"symbol"===S(t)?t:String(t)}function $(e,t){if("object"!==S(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!==S(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var D={name:"episode",mixins:[c["a"],d["a"]],components:{ButtonSimple:l["a"],ComboboxNumber:u["a"],ComboboxStyled:p["a"],CornerLeftUpIcon:o["q"],DescriptionCell:f["a"],EditEpisodeModal:m["a"],EntityNews:y["a"],EntityPreviewFiles:h["a"],EntityTaskList:b["a"],EntityTimeLogs:v["a"],EntityThumbnail:g["a"],PageSubtitle:w["a"],PageTitle:E["a"],Schedule:_["a"],TableInfo:C["a"],TaskInfo:k["default"],TaskTypeName:x["a"]},data:function(){return{type:"episode",currentEpisode:null,currentTask:null,casting:{isLoading:!1,isError:!1},errors:{edit:!1},loading:{edit:!1},modals:{edit:!1,preview:!1}}},mounted:function(){var e=this;this.clearSelectedTasks(),this.loadCurrentEpisode().then((function(t){e.currentEpisode=t,e.currentSection=e.route.query.section||"casting",e.casting.isLoading=!0,e.casting.isError=!1,e.currentEpisode?e.loadEpisodeCasting(e.currentEpisode).then((function(){e.casting.isLoading=!1})).catch((function(t){e.casting.isLoading=!1,e.casting.isError=!0,console.error(t)})):e.resetData()})).catch(console.error)},computed:O(O({},Object(n["c"])(["currentProduction","getTaskTypePriority","episodeMap","episodeMetadataDescriptors","episodeSearchText","isCurrentUserManager","route","taskMap","taskTypeMap"])),{},{title:function(){return this.currentEpisode?"".concat(this.currentEpisode.name):"Loading..."},currentEntity:function(){return this.currentEpisode},getEpisodesRoute:function(){var e={name:"episodes",params:{production_id:this.currentProduction.id,project_id:this.currentProduction.id},query:{search:this.episodeSearchText}};return e.name="episodes",e},nbAssets:function(){var e=0;return this.currentEpisode&&"casting"===this.currentSection&&this.currentEpisode.castingAssetsByType&&this.currentEpisode.castingAssetsByType.forEach((function(t){e+=t.length})),e}}),methods:O(O({},Object(n["b"])(["clearSelectedTasks","editEpisode","setCurrentEpisode","loadEpisodesWithTasks","loadEpisodeCasting"])),{},{loadCurrentEpisode:function(){var e=this;return new Promise((function(t,i){var s=e.route.params.episode_id,r=e.episodeMap.get(s)||null;return r&&r.validations?t(r):e.loadEpisodesWithTasks().then((function(){var i=e.episodeMap.get(s)||null;return t(i)}))}))},confirmEditEpisode:function(e){var t=this;e.id=this.currentEpisode.id,this.loading.edit=!0,this.errors.edit=!1,this.editEpisode(e).then((function(){t.loading.edit=!1,t.modals.edit=!1})).catch((function(e){console.error(e),t.loading.edit=!1,t.errors.edit=!0}))},buildAssetRoute:function(e){var t=e.episode_id;t||(t="main");var i={name:"asset",params:{production_id:this.currentProduction.id,asset_id:e.asset_id}};return Object(a["a"])(i,t)},resetData:function(){var e=this;this.casting.isLoading=!0,this.$nextTick((function(){e.getCurrentEpisode().then((function(t){return e.currentEpisode=t,e.loadEpisodeCasting(e.currentEpisode)})).then((function(){e.casting.isLoading=!1})).catch((function(t){e.casting.isError=!0,e.casting.isLoading=!1,console.error(t)}))}))}}),watch:{},metaInfo:function(){return{title:"".concat(this.title," - Kitsu")}}},L=D,A=(i("5429"),i("2877")),M=Object(A["a"])(L,s,r,!1,null,"6ee2f26a",null);t["default"]=M.exports},3134:function(e,t,i){},"435a":function(e,t,i){"use strict";i("7fb8")},4916:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{modal:!0,"is-active":e.active}},[i("div",{staticClass:"modal-background",on:{click:function(t){return e.$emit("cancel")}}}),i("div",{staticClass:"modal-content"},[i("div",{staticClass:"box"},[e.episodeToEdit&&this.episodeToEdit.id?i("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("episodes.edit_title"))+" "+e._s(e.episodeToEdit.name)+" ")]):i("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("episodes.new_episode"))+" ")]),i("form",{on:{submit:function(e){e.preventDefault()}}},[i("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:e.$t("episodes.fields.name")},on:{enter:e.runConfirmation},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),i("textarea-field",{ref:"descriptionField",attrs:{label:e.$t("episodes.fields.description")},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.runConfirmation.apply(null,arguments):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.metaKey?e.runConfirmation.apply(null,arguments):null}]},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),e._l(e.episodeMetadataDescriptors,(function(t){return i("div",{key:t.id},[t.choices.length>0?i("combobox",{attrs:{label:t.name,options:e.getDescriptorChoicesOptions(t)},model:{value:e.form.data[t.field_name],callback:function(i){e.$set(e.form.data,t.field_name,i)},expression:"form.data[descriptor.field_name]"}}):i("text-field",{attrs:{label:t.name},on:{enter:e.runConfirmation},model:{value:e.form.data[t.field_name],callback:function(i){e.$set(e.form.data,t.field_name,i)},expression:"form.data[descriptor.field_name]"}})],1)}))],2),i("modal-footer",{attrs:{"error-text":e.$t("episodes.edit_error"),"is-loading":e.isLoading,"is-error":e.isError},on:{confirm:e.runConfirmation,cancel:function(t){return e.$emit("cancel")}}})],1)])])},r=[],n=i("2f62"),o=i("d065"),a=i("d5c9"),c=i("7bf8"),d=i("1149");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e){return y(e)||m(e)||f(e)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){if(e){if("string"===typeof e)return h(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?h(e,t):void 0}}function m(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e){if(Array.isArray(e))return h(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(e,t,i){return t=E(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E(e){var t=w(e,"string");return"symbol"===l(t)?t:String(t)}function w(e,t){if("object"!==l(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!==l(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var _={name:"edit-episode-modal",mixins:[o["a"]],components:{ModalFooter:a["a"],TextField:c["a"],TextareaField:d["a"]},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},episodeToEdit:{type:Object,default:function(){}}},data:function(){return this.episodeToEdit&&this.episodeToEdit.id?{form:{id:this.episodeToEdit.id,name:this.episodeToEdit.name,description:this.episodeToEdit.description,production_id:this.episodeToEdit.project_id,data:this.episodeToEdit.data||{}},episodeSuccessText:""}:{form:{id:"",name:"",description:"",fps:"",data:{}},episodeSuccessText:""}},computed:v({},Object(n["c"])(["currentProduction","episodeMetadataDescriptors"])),methods:v(v({},Object(n["b"])([])),{},{getDescriptorChoicesOptions:function(e){var t=e.choices.map((function(e){return{label:e,value:e}}));return[{label:"",value:""}].concat(u(t))},runConfirmation:function(){this.$emit("confirm",this.form)},isEditing:function(){return this.episodeToEdit&&this.episodeToEdit.id},resetForm:function(){this.episodeSuccessText="",this.isEditing()?this.form={id:this.episodeToEdit.id,name:this.episodeToEdit.name,description:this.episodeToEdit.description,data:this.episodeToEdit.data||{}}:(this.form.id=null,this.form.name="",this.form.description="",this.form.data={})}}),mounted:function(){this.resetForm()},watch:{active:function(){this.active&&this.resetForm()},episodeToEdit:function(){this.resetForm()}}},C=_,k=(i("435a"),i("2877")),x=Object(k["a"])(C,s,r,!1,null,"f722693e",null);t["a"]=x.exports},5429:function(e,t,i){"use strict";i("3134")},"7fb8":function(e,t,i){}}]);
//# sourceMappingURL=chunk-302c8f8e.9a015ed0.js.map