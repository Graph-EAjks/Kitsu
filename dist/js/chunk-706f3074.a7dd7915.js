(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-706f3074"],{"293f":function(e,t,r){},"45a7":function(e,t,r){},"4a0f":function(e,t,r){"use strict";r("9eb4")},6893:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"people page fixed-page"},[r("div",{staticClass:"flexrow page-header"},[r("page-title",{staticClass:"flexrow-item filler",attrs:{text:e.$t("people.title")}}),e.isCurrentUserAdmin?r("button-simple",{staticClass:"flexrow-item",attrs:{title:e.$t("main.csv.import_file"),"is-responsive":!0,icon:"upload"},on:{click:e.showImportModal}}):e._e(),r("button-href-link",{staticClass:"flexrow-item",attrs:{title:e.$t("main.csv.export_file"),icon:"download",path:"/api/export/csv/persons.csv"}}),e.isCurrentUserAdmin?r("button-simple",{staticClass:"flexrow-item",attrs:{text:e.$t("people.new_person"),"is-responsive":!0,icon:"plus"},on:{click:e.onNewClicked}}):e._e()],1),r("div",{staticClass:"flexrow search-options"},[r("search-field",{ref:"people-search-field",staticClass:"search flexrow-item",attrs:{"can-save":!0,placeholder:"ex: John Doe"},on:{change:e.onSearchChange,enter:e.saveSearchQuery,save:e.saveSearchQuery}}),r("button-simple",{staticClass:"flexrow-item filter-button",attrs:{title:e.$t("entities.build_filter.title"),icon:"funnel"},on:{click:function(){return e.modals.isBuildFilterDisplayed=!0}}})],1),r("div",{staticClass:"query-list"},[e.isPeopleLoading?e._e():r("search-query-list",{attrs:{queries:e.peopleSearchQueries},on:{"change-search":e.changeSearch,"remove-search":e.removeSearchQuery}})],1),r("people-list",{attrs:{entries:e.displayedPeople,"is-loading":e.isPeopleLoading,"is-error":e.isPeopleLoadingError},on:{"edit-clicked":e.onEditClicked,"delete-clicked":e.onDeleteClicked,"change-password-clicked":e.onChangePasswordClicked}}),r("import-render-modal",{attrs:{active:e.modals.isImportRenderDisplayed,"is-loading":e.isImportPeopleLoading,"is-error":e.isImportPeopleLoadingError,"parsed-csv":e.parsedCSV,"form-data":e.personCsvFormData,columns:e.dataMatchers.concat(e.csvColumns,e.optionalCsvColumns),dataMatchers:e.dataMatchers,database:e.filteredPeople},on:{reupload:e.resetImport,cancel:e.hideImportRenderModal,confirm:e.uploadImportFile}}),r("import-modal",{ref:"import-modal",attrs:{active:e.modals.importModal,"is-loading":e.isImportPeopleLoading,"is-error":e.isImportPeopleLoadingError,"form-data":e.personCsvFormData,columns:e.dataMatchers.concat(e.csvColumns),"optional-columns":e.optionalCsvColumns},on:{cancel:e.hideImportModal,confirm:e.renderImport}}),r("edit-person-modal",{attrs:{active:e.modals.edit,"is-create-invite-loading":e.loading.createAndInvite,"is-error":e.errors.edit,"is-invite-loading":e.loading.invite,"is-invitation-success":e.success.invite,"is-invitation-error":e.errors.invite,"is-loading":e.loading.edit,"is-user-limit-error":e.errors.userLimit,"person-to-edit":e.personToEdit},on:{cancel:function(t){e.modals.edit=!1},confirm:e.confirmEditPeople,"confirm-invite":e.confirmCreateAndInvite,invite:e.confirmInvite}}),r("change-password-modal",{attrs:{active:e.modals.changePassword,person:e.personToChangePassword},on:{cancel:function(t){e.modals.changePassword=!1},confirm:function(t){e.modals.changePassword=!1}}}),r("hard-delete-modal",{attrs:{active:e.modals.del,"error-text":e.$t("people.delete_error"),"is-loading":e.loading.del,"is-error":e.errors.del,"lock-text":e.personToDelete?e.personToDelete.full_name:"",text:e.deleteText},on:{cancel:function(t){e.modals.del=!1},confirm:e.confirmDeletePeople}}),r("build-people-filter-modal",{ref:"build-filter-modal",attrs:{active:e.modals.isBuildFilterDisplayed},on:{cancel:function(t){e.modals.isBuildFilterDisplayed=!1},confirm:e.confirmBuildFilter}})],1)},o=[],n=r("2f62"),s=r("3455"),a=r("9355"),l=r("de40"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{modal:!0,"is-active":e.active}},[r("div",{staticClass:"modal-background",on:{click:function(t){return e.$emit("cancel")}}}),r("div",{staticClass:"modal-content"},[r("div",{staticClass:"box"},[r("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("people.change_password_for"))+" "+e._s(e.person.name)+" ")]),r("form",{on:{submit:function(e){e.preventDefault()}}},[r("text-field",{ref:"first-password",attrs:{label:e.$t("people.fields.password"),type:"password"},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),r("text-field",{attrs:{label:e.$t("people.fields.password_2"),type:"password"},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),r("div",{staticClass:"flexrow"},[r("button",{class:{button:!0,"is-primary":!0,"flexrow-item":!0,"is-loading":e.isLoading},attrs:{disabled:!1},on:{click:e.confirmClicked}},[e._v(" "+e._s(e.$t("profile.change_password.button"))+" ")]),r("div",{staticClass:"filler"}),r("button",{staticClass:"button is-link flexrow-item",on:{click:function(t){return e.$emit("cancel")}}},[e._v(" "+e._s(e.$t("main.cancel"))+" ")])]),e.isValid?e._e():r("div",{staticClass:"error has-text-right mt1"},[e._v(" "+e._s(e.$t("profile.change_password.unvalid"))+" ")]),e.isError?r("div",{staticClass:"error has-text-right mt1"},[e._v(" "+e._s(e.$t("profile.change_password.error"))+" ")]):e._e()])])])},d=[],p=r("d065"),u=r("7bf8");function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t=b(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=y(e,"string");return"symbol"===m(t)?t:String(t)}function y(e,t){if("object"!==m(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==m(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var g={name:"change-password-modal",mixins:[p["a"]],props:{active:{type:Boolean,default:!1},person:{type:Object,default:function(){}}},data:function(){return{form:{password:"",password2:""},isLoading:!1,isError:!1,isValid:!0}},components:{TextField:u["a"]},computed:h({},Object(n["c"])([])),methods:h(h({},Object(n["b"])(["changePasswordPerson"])),{},{confirmClicked:function(){var e=this;this.changePasswordPerson({person:this.person,form:this.form}).then((function(){e.$emit("confirm")})).catch((function(t){!1===t.isValidPassword?e.isValid=!1:e.isError=!0}))},resetForm:function(){this.person&&(this.form={password:"",password2:""},this.isLoading=!1,this.isError=!1,this.isValid=!0)}}),watch:{person:function(){this.resetForm()},active:function(){var e=this;this.active&&(this.resetForm(),setTimeout((function(){e.$refs["first-password"].focus()}),100))}}},_=g,C=(r("ad88"),r("2877")),w=Object(C["a"])(_,c,d,!1,null,"532714e4",null),O=w.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{modal:!0,"is-active":e.active}},[r("div",{staticClass:"modal-background",on:{click:function(t){return e.$emit("cancel")}}}),r("div",{staticClass:"modal-content"},[r("div",{staticClass:"box"},[void 0!==e.personToEdit.id?r("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("people.edit_title"))+" "+e._s(e.personName)+" ")]):r("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("people.new_person"))+" ")]),r("form",{on:{submit:function(e){e.preventDefault()}}},[r("text-field",{ref:"name-field",attrs:{label:e.$t("people.fields.first_name"),disabled:e.personToEdit.is_generated_from_ldap},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.first_name,callback:function(t){e.$set(e.form,"first_name",t)},expression:"form.first_name"}}),r("text-field",{attrs:{label:e.$t("people.fields.last_name"),disabled:e.personToEdit.is_generated_from_ldap},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.last_name,callback:function(t){e.$set(e.form,"last_name",t)},expression:"form.last_name"}}),r("text-field",{attrs:{label:e.$t("people.fields.email"),disabled:e.personToEdit.is_generated_from_ldap},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),r("text-field",{attrs:{label:e.$t("people.fields.phone")},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),r("div",{staticClass:"departments"},[r("label",{staticClass:"label"},[e._v(e._s(e.$t("people.fields.departments")))]),e._l(e.form.departments,(function(t){return r("div",{key:t,staticClass:"department-element mb1",on:{click:function(r){return e.removeDepartment(t)}}},[t?r("department-name",{attrs:{department:e.departmentMap.get(t)}}):e._e()],1)})),r("div",{staticClass:"flexrow"},[e.selectableDepartments.length>0?r("combobox-department",{staticClass:"flexrow-item",attrs:{"selectable-departments":e.selectableDepartments},on:{enter:e.confirmClicked},model:{value:e.selectedDepartment,callback:function(t){e.selectedDepartment=t},expression:"selectedDepartment"}}):e._e(),e.selectableDepartments.length>0?r("button",{staticClass:"button is-success flexrow-item mb2",class:{"is-disabled":null===e.selectedDepartment},on:{click:e.addDepartment}},[e._v(" "+e._s(e.$t("main.add"))+" ")]):e._e()],1)],2),r("combobox",{attrs:{label:e.$t("people.fields.role"),options:e.roleOptions,localeKeyPrefix:"people.role."},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}}),r("combobox",{attrs:{label:e.$t("people.fields.active"),options:e.activeOptions,disabled:e.personToEdit.is_generated_from_ldap},on:{enter:function(t){return e.confirmClicked()}},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}})],1),r("div",{staticClass:"flexrow"},[!e.isCreating&&e.isCurrentUserAdmin?r("button",{class:{button:!0,"flexrow-item":!0,"is-loading":e.isInviteLoading},attrs:{disabled:!e.isValidEmail},on:{click:e.invite}},[e._v(" "+e._s(e.$t("people.invite"))+" ")]):e._e(),r("div",{staticClass:"filler"}),e.isCreating&&e.isCurrentUserAdmin?r("button",{class:{button:!0,"is-primary":!0,"flexrow-item":!0,"is-loading":e.isCreateInviteLoading},attrs:{disabled:!e.isValidEmail},on:{click:e.createAndInvite}},[e._v(" "+e._s(e.$t("people.create_invite"))+" ")]):e._e(),r("a",{class:{button:!0,"is-primary":!0,"flexrow-item":!0,"is-loading":e.isLoading},attrs:{disabled:!e.isValidEmail},on:{click:e.confirmClicked}},[e._v(" "+e._s(e.isCreating?e.$t("people.create"):e.$t("people.confirm_edit"))+" ")]),r("button",{staticClass:"button is-link flexrow-item",on:{click:function(t){return e.$emit("cancel")}}},[e._v(" "+e._s(e.$t("main.cancel"))+" ")])]),e.isInvitationSuccess?r("div",{staticClass:"success has-text-right mt1"},[e._v(" "+e._s(e.$t("people.invite_success"))+" ")]):e._e(),e.isInvitationError?r("div",{staticClass:"error has-text-right mt1"},[e._v(" "+e._s(e.$t("people.invite_error"))+" ")]):e._e(),e.isUserLimitError?r("div",{staticClass:"error has-text-right mt1"},[e._v(" "+e._s(e.$t("people.user_limit_error"))+" ")]):e._e(),e.isError?r("div",{staticClass:"error has-text-right mt1"},[e._v(" "+e._s(e.$t("people.create_error"))+" ")]):e._e()])])])},S=[],j=r("992f"),x=r("5cf5"),E=r("5af2");function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return t=F(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){var t=T(e,"string");return"symbol"===$(t)?t:String(t)}function T(e,t){if("object"!==$(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==$(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var L={name:"edit-person-modal",mixins:[p["a"]],props:{active:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},isCreateInviteLoading:{type:Boolean,default:!1},isInviteLoading:{type:Boolean,default:!1},isInvitationSuccess:{type:Boolean,default:!1},isInvitationError:{type:Boolean,default:!1},isUserLimitError:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},personToEdit:{type:Object,default:function(){}}},data:function(){return{activeOptions:[{label:this.$t("main.yes"),value:"true"},{label:this.$t("main.no"),value:"false"}],isValidEmail:!1,form:{first_name:"",last_name:"",email:"",phone:"",role:"user",active:"true",departments:[]},roleOptions:[{label:"user",value:"user"},{label:"supervisor",value:"supervisor"},{label:"manager",value:"manager"},{label:"client",value:"client"},{label:"vendor",value:"vendor"},{label:"admin",value:"admin"}],selectedDepartment:null}},components:{TextField:u["a"],Combobox:j["a"],ComboboxDepartment:x["a"],DepartmentName:E["a"]},computed:D(D({},Object(n["c"])(["departments","departmentMap","isCurrentUserAdmin","people"])),{},{selectableDepartments:function(){var e=this;return this.departments.filter((function(t){return-1===e.form.departments.findIndex((function(e){return e===t.id}))}))},isCreating:function(){return void 0===this.personToEdit.id},personName:function(){return void 0!==this.personToEdit?this.personToEdit.first_name+" "+this.personToEdit.last_name:""}}),methods:D(D({},Object(n["b"])([])),{},{createAndInvite:function(){this.$emit("confirm-invite",this.form)},invite:function(){this.$emit("invite",this.form)},confirmClicked:function(){var e=D({},this.form);e.active="true"===this.form.active||!0===this.form.active,this.form.email&&this.$emit("confirm",e)},addDepartment:function(){this.form.departments.push(this.selectedDepartment),this.selectedDepartment=null},removeDepartment:function(e){var t=this.form.departments.indexOf(e);t>=0&&this.form.departments.splice(t,1)},resetForm:function(){this.personToEdit?this.form={first_name:this.personToEdit.first_name,last_name:this.personToEdit.last_name,phone:this.personToEdit.phone,email:this.personToEdit.email,role:this.personToEdit.role,active:!this.personToEdit.id||this.personToEdit.active?"true":"false",departments:this.personToEdit.departments||[]}:this.form={first_name:"",last_name:"",email:"",phone:"",role:"user",active:"true",departments:[]},this.checkEmailValidity()},checkEmailValidity:function(){var e=this,t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r=this.people.some((function(t){return t.email===e.form.email&&(!e.personToEdit||e.personToEdit.email!==t.email)}));this.isValidEmail=this.form.email&&t.test(this.form.email)&&!r}}),watch:{personToEdit:function(){this.resetForm()},active:function(){var e=this;this.active&&(this.resetForm(),setTimeout((function(){e.$refs["name-field"].focus()}),100))},"form.email":function(){this.checkEmailValidity()}}},M=L,A=(r("926e"),Object(C["a"])(M,P,S,!1,null,"34d05fb6",null)),B=A.exports,V=r("2c1a"),N=r("440f"),U=r("4918"),R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"data-list"},[r("div",{directives:[{name:"scroll",rawName:"v-scroll",value:e.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"datatable-wrapper"},[r("table",{staticClass:"datatable multi-section"},[r("thead",{staticClass:"datatable-head"},[r("tr",[r("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("people.list.name"))+" ")]),r("th",{staticClass:"email",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("people.list.email"))+" ")]),r("th",{staticClass:"phone",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("people.list.phone"))+" ")]),r("th",{staticClass:"role",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("people.list.role"))+" ")]),r("th",{staticClass:"departments",attrs:{scope:"col"}},[e._v(" "+e._s(e.$t("people.list.departments"))+" ")]),r("th",{staticClass:"actions",attrs:{scope:"col"}})])]),e.activePeople.length>0?r("tbody",{staticClass:"datatable-body"},[r("tr",{staticClass:"datatable-type-header"},[r("th",{attrs:{scope:"rowgroup",colspan:"5"}},[r("span",{staticClass:"datatable-row-header"},[e._v(e._s(e.$t("people.active")))])])]),e._l(e.activePeople,(function(t){return r("tr",{key:t.id,staticClass:"datatable-row"},[r("people-name-cell",{staticClass:"name datatable-row-header",attrs:{person:t}}),r("td",{staticClass:"email"},[e._v(e._s(t.email))]),r("td",{staticClass:"phone"},[e._v(e._s(t.phone))]),r("td",{staticClass:"role"},[e._v(e._s(e.$t("people.role."+t.role)))]),r("td",{staticClass:"departments"},e._l(e.sortDepartments(t.departments),(function(i){return r("span",{key:t.id+"-"+i.id,staticClass:"departments-element"},[i?r("department-name",{attrs:{department:i}}):e._e()],1)})),0),e.isCurrentUserAdmin?r("row-actions-cell",{attrs:{"entry-id":t.id,"hide-delete":!0,"hide-change-password":!1,"is-ldap":t.is_generated_from_ldap},on:{"edit-clicked":function(r){return e.$emit("edit-clicked",t)},"change-password-clicked":function(r){return e.$emit("change-password-clicked",t)}}}):r("td",{staticClass:"actions"})],1)}))],2):e._e(),e.unactivePeople.length>0?r("tbody",{staticClass:"datatable-body"},[r("tr",{staticClass:"datatable-type-header"},[r("th",{attrs:{scope:"rowgroup",colspan:"5"}},[r("span",{staticClass:"datatable-row-header"},[e._v(" "+e._s(e.$t("people.unactive"))+" ")])])]),e._l(e.unactivePeople,(function(t){return r("tr",{key:t.id,staticClass:"datatable-row"},[r("people-name-cell",{staticClass:"name datatable-row-header",attrs:{person:t}}),r("td",{staticClass:"email"},[e._v(e._s(t.email))]),r("td",{staticClass:"phone"},[e._v(e._s(t.phone))]),r("td",{staticClass:"role"},[e._v(e._s(e.$t("people.role."+t.role)))]),r("td",{staticClass:"departments"},e._l(e.sortDepartments(t.departments),(function(i){return r("span",{key:t.id+"-"+i.id,staticClass:"departments-element"},[i?r("department-name",{attrs:{department:i}}):e._e()],1)})),0),e.isCurrentUserAdmin?r("row-actions-cell",{attrs:{"entry-id":t.id,"hide-change-password":!0},on:{"edit-clicked":function(r){return e.$emit("edit-clicked",t)},"delete-clicked":function(r){return e.$emit("delete-clicked",t)}}}):r("td",{staticClass:"actions"})],1)}))],2):e._e()])]),r("table-info",{attrs:{"is-loading":e.isLoading,"is-error":e.isError}}),e.isLoading?e._e():r("p",{staticClass:"has-text-centered footer-info"},[e._v(" "+e._s(e.entries.length)+" "+e._s(e.$tc("people.persons",e.entries.length))+" ("+e._s(e.activePeople.length)+" "+e._s(e.$tc("people.active_persons",e.activePeople.length))+") ")])],1)},Q=[],q=r("2229"),J=r("7365"),z=r("14b2"),H=r("e60b");function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function G(e,t,r){return t=X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(e){var t=Y(e,"string");return"symbol"===K(t)?t:String(t)}function Y(e,t){if("object"!==K(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==K(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var ee={name:"people-list",components:{PeopleNameCell:J["a"],RowActionsCell:z["a"],TableInfo:H["a"],DepartmentName:E["a"]},props:{entries:{type:Array,default:function(){return[]}},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},computed:W(W({},Object(n["c"])(["departmentMap","isCurrentUserAdmin"])),{},{activePeople:function(){return this.entries.filter((function(e){return e.active}))},unactivePeople:function(){return this.entries.filter((function(e){return!e.active}))}}),methods:W(W({},Object(n["b"])([])),{},{taskColor:function(e){return e<1||e>4?"red":""},onBodyScroll:function(e,t){this.$refs.body.style.left="-".concat(t.scrollLeft,"px")},sortDepartments:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(q["d"])(t.map((function(t){return e.departmentMap.get(t)})))}})},te=ee,re=(r("790f"),Object(C["a"])(te,R,Q,!1,null,"269e0e8b",null)),ie=re.exports,oe=r("8d07"),ne=r("4d04"),se=r("55ce"),ae=r("b06c"),le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{modal:!0,"is-active":e.active}},[r("div",{staticClass:"modal-background",on:{click:function(t){return e.$emit("cancel")}}}),r("div",{staticClass:"modal-content"},[r("div",{staticClass:"box content"},[r("h1",{staticClass:"title"},[e._v(" "+e._s(e.$t("entities.build_filter.title"))+" ")]),r("h3",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("entities.build_filter.department"))+" ")]),e._l(e.departmentFilters.values,(function(t,i){return r("div",{key:"task-type-"+i,staticClass:"flexrow department-filter"},[r("combobox",{staticClass:"flexrow-item",attrs:{options:e.general.operatorOptions,"locale-key-prefix":"entities.build_filter."},on:{input:function(r){return e.onDepartmentOperatorChanged(t)}},model:{value:t.operator,callback:function(r){e.$set(t,"operator",r)},expression:"departmentFilter.operator"}}),r("div",{staticClass:"flexrow-item flexrow value-column"},[e._l(t.values,(function(i,o){return r("div",{key:"department-"+o},[r("combobox",{staticClass:"flexrow-item",attrs:{options:e.departmentsOptions},model:{value:t.values[o],callback:function(r){e.$set(t.values,o,r)},expression:"departmentFilter.values[index]"}})],1)})),"in"===t.operator?r("button-simple",{staticClass:"mt05",attrs:{icon:"plus"},on:{click:function(r){return e.addInDepartmentFilter(t)}}}):e._e()],2)],1)})),r("modal-footer",{attrs:{"error-text":e.$t("entities.thumbnails.error")},on:{confirm:e.applyFilter,cancel:function(t){return e.$emit("cancel")}}})],2)])])},ce=[],de=r("ca76"),pe=r("d5c9");function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){he(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function he(e,t,r){return t=ve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ve(e){var t=be(e,"string");return"symbol"===ue(t)?t:String(t)}function be(e,t){if("object"!==ue(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==ue(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var ye={name:"build-people-filter-modal",mixins:[p["a"]],components:{ButtonSimple:l["a"],Combobox:j["a"],ModalFooter:pe["a"]},props:{active:{type:Boolean,default:!1}},data:function(){return{general:{operatorOptions:[{label:"equal",value:"="},{label:"not_equal",value:"=-"},{label:"in",value:"in"}],unionOptions:[{label:"union_and",value:"and"},{label:"union_or",value:"or"}]},departmentFilters:{values:[]},union:"and"}},mounted:function(){this.reset(),this.setFiltersFromCurrentQuery()},computed:fe(fe({},Object(n["c"])(["peopleSearchText","peopleSearchText","departmentMap","departments"])),{},{departmentsOptions:function(){return this.departments.map((function(e){return{label:e.name,value:e.id}}))}}),methods:fe(fe({},Object(n["b"])([])),{},{applyFilter:function(){var e=this.buildFilter();this.$emit("confirm",e)},buildFilter:function(){var e="";return e=this.applyDepartmentChoice(e),e=this.applyUnionChoice(e),e.trim()},addDepartmentFilter:function(){var e={operator:"=",values:[this.departments[0].id]};return this.departmentFilters.values.push(e),e},addInDepartmentFilter:function(e){e.values.push(this.departments[0].name)},removeDepartmentFilter:function(e){this.departmentFilters.values=this.departmentFilters.values.filter((function(t){return t!==e}))},applyDepartmentChoice:function(e){var t=this;return this.departmentFilters.values.forEach((function(r){var i="=[";"=-"===r.operator&&(i="=[-");var o=r.values.map((function(e){return t.departmentMap.get(e)?t.departmentMap.get(e).name:t.departments[0].name})).join(",");e+=" department".concat(i).concat(o,"]")})),e},applyUnionChoice:function(e){return"or"===this.union&&(e=" +(".concat(e.trim(),")")),e},setFiltersFromCurrentQuery:function(){var e=this;if(this.peopleSearchText){this.departmentFilters.values=[];var t=Object(de["d"])({entryIndex:[],departments:this.departments,persons:[],query:this.peopleSearchText});t.forEach((function(t){e.setFiltersFromDepartmentQuery(t)})),t.union&&this.setUnion()}},setFiltersFromDepartmentQuery:function(e){var t="=";e.values.length>1?t="in":e.excluding&&(t="=-"),this.departmentFilters.values.push({operator:t,values:e.values.map((function(e){return e.id}))})},setUnion:function(){this.union="or"},onDepartmentOperatorChanged:function(e){"in"!==e.operator&&(e.values=[e.values[0]])},reset:function(){this.departmentFilters.values=[{operator:"=",values:this.departments.length>0?[this.departments[0].id]:[]}]}}),watch:{active:function(){this.active&&(this.reset(),this.setFiltersFromCurrentQuery())}}},ge=ye,_e=(r("9ab0"),Object(C["a"])(ge,le,ce,!1,null,"037fa0c8",null)),Ce=_e.exports;function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){Se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Se(e,t,r){return t=je(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function je(e){var t=xe(e,"string");return"symbol"===we(t)?t:String(t)}function xe(e,t){if("object"!==we(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==we(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Ee={name:"people",mixins:[ae["a"]],components:{BuildPeopleFilterModal:Ce,ButtonHrefLink:a["a"],ButtonSimple:l["a"],ChangePasswordModal:O,EditPersonModal:B,HardDeleteModal:V["a"],ImportModal:N["a"],PageTitle:oe["a"],PeopleList:ie,ImportRenderModal:U["a"],SearchField:ne["a"],SearchQueryList:se["a"]},data:function(){return{csvColumns:["First Name","Last Name"],optionalCsvColumns:["Phone","Role"],dataMatchers:["Email"],errors:{del:!1,edit:!1,invite:!1},loading:{createAndInvite:!1,edit:!1,del:!1,invite:!1},modals:{edit:!1,del:!1,changePassword:!1,importModal:!1,isImportRenderDisplayed:!1,isBuildFilterDisplayed:!1},parsedCSV:[],personToDelete:{},personToEdit:{role:"user"},personToChangePassword:{},success:{invite:!1}}},mounted:function(){var e=this;this.loadPeople((function(){e.setSearchFromUrl(),e.onSearchChange()}))},watch:{"modals.edit":function(){this.modals.edit&&(this.loading.createAndInvite=!1,this.errors.edit=!1,this.errors.invite=!1,this.errors.userLimit=!1,this.loading.edit=!1,this.loading.invite=!1,this.success.invite=!1)}},computed:Pe(Pe({},Object(n["c"])(["displayedPeople","isCurrentUserAdmin","isPeopleLoading","isPeopleLoadingError","isImportPeopleModalShown","isImportPeopleLoading","isImportPeopleLoadingError","peopleSearchQueries","personCsvFormData"])),{},{deleteText:function(){var e=this.personToDelete;if(void 0!==e){var t="".concat(e.first_name," ").concat(e.last_name);return this.$t("people.delete_text",{personName:t})}return""},filteredPeople:function(){var e={};return this.displayedPeople.forEach((function(t){var r=t.email;e[r]=!0})),e},searchField:function(){return this.$refs["people-search-field"]}}),methods:Pe(Pe({},Object(n["b"])(["editPerson","deletePeople","invitePerson","loadPeople","loadDepartments","newPerson","newPersonAndInvite","removePeopleSearch","savePeopleSearch","setPeopleSearch","uploadPersonFile"])),{},{renderImport:function(e,t){var r=this;this.loading.importing=!0,this.errors.importing=!1,this.formData=e,"file"===t&&(e=e.get("file")),s["a"].processCSV(e).then((function(e){r.parsedCSV=e,r.hideImportModal(),r.loading.importing=!1,r.showImportRenderModal()}))},uploadImportFile:function(e,t){var r=this,i=new FormData,o="import.csv",n=new File([e.join("\n")],o,{type:"text/csv"});i.append("file",n),this.loading.importing=!0,this.errors.importing=!1,this.$store.commit("PERSON_CSV_FILE_SELECTED",i),this.uploadPersonFile(t).then((function(){r.$store.dispatch("loadPeople"),r.hideImportRenderModal()})).catch((function(e){console.error(e),r.loading.importing=!1,r.errors.importing=!0}))},resetImport:function(){this.errors.importing=!1,this.hideImportRenderModal(),this.$store.commit("PERSON_CSV_FILE_SELECTED",null),this.$refs["import-modal"].reset(),this.showImportModal()},confirmEditPeople:function(e){var t=this,r="editPerson";void 0===this.personToEdit.id?r="newPerson":e.id=this.personToEdit.id,this.loading.edit=!0,this.errors.edit=!1,this.errors.userLimit=!1,this[r](e).then((function(){t.loading.edit=!1,t.modals.edit=!1})).catch((function(e){var r=e.body&&e.body.message&&e.body.message.indexOf("limit")>0;r?t.errors.userLimit=!0:t.errors.edit=!0,t.loading.edit=!1}))},confirmCreateAndInvite:function(e){var t=this;this.loading.createAndInvite=!0,this.errors.edit=!1,this.errors.userLimit=!1,this.newPersonAndInvite(e).then((function(){t.loading.createAndInvite=!1,t.modals.edit=!1})).catch((function(e){var r=e.body&&e.body.message&&e.body.message.indexOf("limit")>0;r?t.errors.userLimit=!0:t.errors.edit=!0,t.errors.edit=!0,t.loading.createAndInvite=!1})),this.onSearchChange()},confirmInvite:function(e){var t=this;e.id=this.personToEdit.id,this.loading.invite=!0,this.errors.invite=!1,this.invitePerson(e).then((function(){t.loading.invite=!1,t.success.invite=!0})).catch((function(e){console.error(e),t.loading.invite=!1,t.success.invite=!1,t.errors.invite=!0})),this.onSearchChange()},confirmDeletePeople:function(){var e=this;this.loading.del=!0,this.errors.del=!1,this.deletePeople(this.personToDelete).then((function(){e.loading.del=!1,e.modals.del=!1})).catch((function(t){console.error(t),e.loading.del=!1,e.errors.del=!0}))},onSearchChange:function(){if(this.searchField){var e=this.searchField.getValue();1!==e.length&&(this.setPeopleSearch(e),this.setSearchInUrl())}},onDeleteClicked:function(e){this.personToDelete=e,this.modals.del=!0},onEditClicked:function(e){this.errors.invite=!1,this.success.invite=!1,this.personToEdit=e,this.modals.edit=!0},onChangePasswordClicked:function(e){this.personToChangePassword=e,this.modals.changePassword=!0},onNewClicked:function(){this.errors.invite=!1,this.success.invite=!1,this.personToEdit={role:"user"},this.modals.edit=!0},showImportModal:function(){this.modals.importModal=!0},hideImportModal:function(){this.modals.importModal=!1},showImportRenderModal:function(){this.modals.isImportRenderDisplayed=!0},hideImportRenderModal:function(){this.modals.isImportRenderDisplayed=!1},saveSearchQuery:function(e){this.savePeopleSearch(e).catch(console.error)},removeSearchQuery:function(e){this.removePeopleSearch(e).catch(console.error)},confirmBuildFilter:function(e){this.modals.isBuildFilterDisplayed=!1,this.searchField.setValue(e),this.onSearchChange()}}),metaInfo:function(){return{title:"".concat(this.$t("people.title")," - Kitsu")}}},$e=Ee,ke=(r("7529"),Object(C["a"])($e,i,o,!1,null,"32b10d5a",null));t["default"]=ke.exports},"6c78":function(e,t,r){"use strict";r("954a")},"70f9":function(e,t,r){},7365:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("td",{staticClass:"name",attrs:{scope:"row"}},[r("div",{staticClass:"people-name"},[r("people-avatar",{staticClass:"avatar",attrs:{person:e.person}}),r("people-name",{staticClass:"people-name",attrs:{"with-link":"",person:e.person}})],1)])},o=[],n=r("2f62"),s=r("eb8c"),a=r("0073");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t=u(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){var t=m(e,"string");return"symbol"===l(t)?t:String(t)}function m(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var f={name:"people-name-cell",components:{PeopleName:a["a"],PeopleAvatar:s["a"]},props:{person:{type:Object,required:!0}},computed:d({},Object(n["c"])([])),methods:d({},Object(n["b"])([]))},h=f,v=(r("6c78"),r("2877")),b=Object(v["a"])(h,i,o,!1,null,"badaef58",null);t["a"]=b.exports},7529:function(e,t,r){"use strict";r("fd9e")},"790f":function(e,t,r){"use strict";r("45a7")},"791d":function(e,t,r){},"926e":function(e,t,r){"use strict";r("791d")},9355:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",{staticClass:"button",attrs:{title:e.title,href:e.path,target:e.target}},["plus"===e.icon?r("plus-icon",{staticClass:"icon is-small"}):e._e(),"download"===e.icon?r("download-icon",{staticClass:"icon is-small"}):e._e(),"upload"===e.icon?r("upload-icon",{staticClass:"icon is-small"}):e._e(),"list"===e.icon?r("list-icon",{staticClass:"icon is-small"}):e._e(),e.text?r("span",{staticClass:"text is-hidden-touch"},[e._v(" "+e._s(e.text)+" ")]):e._e()],1)},o=[],n=r("0a35"),s={name:"button-href-link",components:{DownloadIcon:n["v"],ListIcon:n["J"],PlusIcon:n["W"],UploadIcon:n["mb"]},props:{text:{default:"",type:String},path:{default:"",type:String},icon:{default:"",type:String},title:{default:"",type:String},styleclass:{default:"",type:String},target:{default:"_self",type:String}}},a=s,l=(r("4a0f"),r("2877")),c=Object(l["a"])(a,i,o,!1,null,"ebbaf58c",null);t["a"]=c.exports},"954a":function(e,t,r){},"9ab0":function(e,t,r){"use strict";r("70f9")},"9eb4":function(e,t,r){},ad88:function(e,t,r){"use strict";r("293f")},fd9e:function(e,t,r){}}]);
//# sourceMappingURL=chunk-706f3074.a7dd7915.js.map