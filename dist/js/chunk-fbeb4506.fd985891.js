(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fbeb4506"],{"7e1c":function(t,e,s){},de06:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns fixed-page shot"},[s("div",{staticClass:"column main-column"},[s("div",{staticClass:"page-header flexrow"},[s("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:t.getShotsRoute}},[s("corner-left-up-icon")],1),s("span",{staticClass:"flexrow-item ml2"},[t.currentShot?s("entity-thumbnail",{staticClass:"entity-thumbnail",attrs:{entity:t.currentShot,"empty-width":120,"empty-height":50,width:120}}):t._e()],1),s("div",{staticClass:"entity-title flexrow-item"},[t._v(" "+t._s(t.title)+" ")])],1),s("div",{staticClass:"flexrow infos"},[s("div",{staticClass:"flexrow-item block flexcolumn"},[s("page-subtitle",{attrs:{text:t.$t("shots.tasks")}}),s("entity-task-list",{staticClass:"task-list",attrs:{entries:t.currentTasks.map((function(t){return t.id})),"is-loading":!t.currentShot,"is-error":!1},on:{"task-selected":t.onTaskSelected}})],1),s("div",{staticClass:"flexrow-item block flexcolumn"},[s("div",{staticClass:"flexrow"},[s("page-subtitle",{attrs:{text:t.$t("main.info")}}),s("div",{staticClass:"filler"}),s("div",{staticClass:"flexrow-item has-text-right"},[t.isCurrentUserManager?s("button-simple",{attrs:{icon:"edit"},on:{click:function(e){t.modals.edit=!0}}}):t._e()],1)],1),s("div",{staticClass:"table-body"},[t.currentShot?s("table",{staticClass:"datatable no-header"},[s("tbody",{staticClass:"datatable-body"},[s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.description")))]),s("description-cell",{attrs:{entry:t.currentShot,full:!0}})],1),s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.nb_frames")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.nb_frames:"")+" ")])]),t.currentShot&&t.currentShot.data&&t.currentShot.data.frame_in?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_in")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_in:"")+" ")])]):t._e(),t.currentShot&&t.currentShot.data&&t.currentShot.data.frame_out?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_out")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_out:"")+" ")])]):t._e(),t.currentShot&&t.currentShot.data&&t.currentShot.data.fps?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.fps")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.fps:"")+" ")])]):t._e(),t.currentShot&&t.currentShot.data&&t.currentShot.data.resolution?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.resolution")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.resolution:"")+" ")])]):t._e(),t.currentShot&&t.currentShot.data&&t.currentShot.data.max_retakes?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.max_retakes")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.max_retakes:"")+" ")])]):t._e(),t._l(t.shotMetadataDescriptors,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(e.name))]),s("td",[t._v(" "+t._s(t.currentShot&&t.currentShot.data?t.currentShot.data[e.field_name]:"")+" ")])])}))],2)]):t._e()])])]),s("div",{staticClass:"shot-data block"},[s("div",{staticClass:"flexrow"},[s("combobox-styled",{staticClass:"section-combo flexrow-item",attrs:{options:t.entityNavOptions},model:{value:t.currentSection,callback:function(e){t.currentSection=e},expression:"currentSection"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:"casting"===t.currentSection,expression:"currentSection === 'casting'"}]},[t._v(" "+t._s(t.nbAssets)+" "+t._s(t.$tc("assets.number",t.nbAssets))+" ")]),s("span",{directives:[{name:"show",rawName:"v-show",value:"casting"===t.currentSection&&t.currentShot.is_casting_standby,expression:"currentSection === 'casting' && currentShot.is_casting_standby"}],staticClass:"tag tag-standby"},[t._v(" "+t._s(t.$t("breakdown.fields.standby"))+" ")]),s("div",{staticClass:"filler"}),s("span",{directives:[{name:"show",rawName:"v-show",value:"schedule"===t.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"flexrow-item mt05"},[t._v(" "+t._s(t.$t("schedule.zoom_level"))+": ")]),s("combobox-number",{directives:[{name:"show",rawName:"v-show",value:"schedule"===t.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"zoom-level flexrow-item ",attrs:{options:t.zoomOptions,"is-simple":""},model:{value:t.zoomLevel,callback:function(e){t.zoomLevel=e},expression:"zoomLevel"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"casting"===t.currentSection,expression:"currentSection === 'casting'"}],staticClass:"shot-casting"},[t.currentShot?s("div",[t.currentShot&&t.currentShot.castingAssetsByType&&t.currentShot.castingAssetsByType[0].length>0?s("div",t._l(t.currentShot.castingAssetsByType,(function(e){return s("div",{key:e.length>0?e[0].asset_type_name:"",staticClass:"type-assets"},[s("div",{staticClass:"asset-type"},[t._v(" "+t._s(e.length>0?e[0].asset_type_name:"")+" ("+t._s(e.length)+") ")]),s("div",{staticClass:"asset-list"},t._l(e,(function(e){return s("router-link",{key:e.id,staticClass:"asset-link",attrs:{to:t.buildAssetRoute(e)}},[s("entity-thumbnail",{staticClass:"entity-thumbnail",attrs:{entity:e,square:!0,"empty-width":103,"empty-height":103,"with-link":!1,"no-cache":!0}}),s("div",[t._v(" "+t._s(e.asset_name)+" "),e.nb_occurences>1?s("span",[t._v(" ("+t._s(e.nb_occurences)+") ")]):t._e()]),s("div",{staticClass:"ready-for flexrow"},[e.ready_for?s("task-type-name",{staticClass:"flexrow-item",attrs:{"task-type":t.taskTypeMap.get(e.ready_for),"current-production-id":t.currentProduction.id,title:"Ready for: "+t.taskTypeMap.get(e.ready_for).name}}):t._e()],1)],1)})),1)])})),0):s("div",{staticClass:"mt1"},[t._v(" "+t._s(t.$t("shots.no_casting"))+" ")])]):s("table-info",{attrs:{"is-loading":t.casting.isLoading,"is-error":t.casting.isError}})],1),t.scheduleItems[0].children.length>0?s("div",{directives:[{name:"show",rawName:"v-show",value:"schedule"===t.currentSection,expression:"currentSection === 'schedule'"}],staticClass:"schedule mt1"},[s("div",{staticClass:"wrapper"},[s("schedule",{ref:"schedule-widget",attrs:{"start-date":t.tasksStartDate,"end-date":t.tasksEndDate,hierarchy:t.scheduleItems,"zoom-level":t.zoomLevel,"is-loading":!1,"is-estimation-linked":!0,"hide-root":!0,"with-milestones":!1}})],1)]):t._e(),"preview-files"===t.currentSection?s("entity-preview-files",{attrs:{entity:t.currentShot}}):t._e(),"activity"===t.currentSection?s("entity-news",{attrs:{entity:t.currentShot}}):t._e(),"time-logs"===t.currentSection?s("entity-time-logs",{attrs:{entity:t.currentShot}}):t._e()],1)]),t.currentTask?s("div",{staticClass:"column side-column"},[s("task-info",{attrs:{task:t.currentTask}})],1):t._e(),s("edit-shot-modal",{ref:"edit-shot-modal",attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"shot-to-edit":t.currentShot},on:{cancel:function(e){t.modals.edit=!1},confirm:t.confirmEditShot}})],1)},r=[],i=s("2f62"),n=s("0a35"),o=s("9d8b"),c=s("f58f"),l=s("31f2"),u=s("de40"),d=s("1e4c"),h=s("9751"),f=s("0fcb"),m=s("162b"),S=s("22a2"),_=s("b2f9"),p=s("0024"),v=s("4ee3"),b=s("bb21"),g=s("8751"),y=s("d7c7"),w=s("e60b"),C=s("9d94"),k=s("274f");function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function T(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(Object(s),!0).forEach((function(e){O(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function O(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var E={name:"shot",mixins:[c["a"],l["a"]],components:{ButtonSimple:u["a"],ComboboxNumber:d["a"],ComboboxStyled:h["a"],CornerLeftUpIcon:n["q"],DescriptionCell:f["a"],EditShotModal:m["a"],EntityNews:S["a"],EntityPreviewFiles:_["a"],EntityTaskList:p["a"],EntityTimeLogs:v["a"],EntityThumbnail:b["a"],PageSubtitle:g["a"],Schedule:y["a"],TableInfo:w["a"],TaskInfo:C["default"],TaskTypeName:k["a"]},data:function(){return{currentShot:null,currentTask:null,casting:{isLoading:!1,isError:!1},errors:{edit:!1},loading:{edit:!1},modals:{edit:!1,preview:!1}}},mounted:function(){var t=this;this.clearSelectedTasks(),this.getCurrentShot().then((function(e){t.currentShot=e,t.currentSection=t.route.query.section||"casting",t.casting.isLoading=!0,t.casting.isError=!1,t.currentShot?t.loadShotCasting(t.currentShot).then((function(){return t.loadShotCasting(t.currentShot)})).then((function(){t.casting.isLoading=!1})).catch((function(e){t.casting.isLoading=!1,t.casting.isError=!0,console.error(e)})):t.resetData()})).catch(console.error)},computed:T(T({},Object(i["c"])(["currentEpisode","currentProduction","getTaskTypePriority","isCurrentUserManager","isTVShow","route","shotMap","shotMetadataDescriptors","shotSearchText","shotsPath","taskMap","taskTypeMap"])),{},{title:function(){return this.currentShot?this.currentShot.episode_name?"".concat(this.currentShot.episode_name," / ")+"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"Loading..."},shotThumbnailPath:function(){var t=this.currentShot.preview_file_id;return"/api/pictures/originals/preview-files/".concat(t,".png")},isPreview:function(){return this.currentShot&&this.currentShot.preview_file_id&&this.currentShot.preview_file_id.length>0},getShotsRoute:function(){var t={name:"shots",params:{production_id:this.currentProduction.id},query:{search:this.shotSearchText}};return this.currentEpisode&&(t.name="episode-shots",t.params.episode_id=this.currentEpisode.id),t},nbAssets:function(){var t=0;return this.currentShot&&"casting"===this.currentSection&&this.currentShot.castingAssetsByType&&this.currentShot.castingAssetsByType.forEach((function(e){t+=e.length})),t}}),methods:T(T({},Object(i["b"])(["clearSelectedTasks","editShot","loadShot","loadShotCasting"])),{},{changeTab:function(t){this.selectedTab=t},getCurrentShot:function(){var t=this;return new Promise((function(e,s){var a=t.route.params.shot_id,r=t.shotMap.get(a)||null;return r?e(r):t.loadShot(a).then(e)}))},onEditClicked:function(){this.modals.edit=!0},confirmEditShot:function(t){var e=this;t.id=this.currentShot.id,t.data.resolution=t.resolution,t.data.max_retakes=t.max_retakes,t.data.frame_in=t.frameIn,t.data.frame_out=t.frameOut,t.data.fps=t.fps,this.loading.edit=!0,this.errors.edit=!1,this.editShot(t).then((function(){e.loading.edit=!1,e.modals.edit=!1})).catch((function(t){console.error(t),e.loading.edit=!1,e.errors.edit=!0}))},buildAssetRoute:function(t){var e=t.episode_id;this.isTVShow&&!e&&(e="main");var s={name:"asset",params:{production_id:this.currentProduction.id,asset_id:t.asset_id}};return Object(o["a"])(s,e)},resetData:function(){var t=this;this.casting.isLoading=!0,this.$nextTick((function(){t.getCurrentShot().then((function(e){return t.currentShot=e,t.loadShotCasting(t.currentShot)})).then((function(){t.casting.isLoading=!1})).catch((function(e){t.casting.isError=!0,t.casting.isLoading=!1,console.error(e)}))}))}}),watch:{},metaInfo:function(){return{title:"".concat(this.title," - Kitsu")}}},P=E,j=(s("e62f"),s("2877")),L=Object(j["a"])(P,a,r,!1,null,"249a4464",null);e["default"]=L.exports},e62f:function(t,e,s){"use strict";s("7e1c")}}]);
//# sourceMappingURL=chunk-fbeb4506.fd985891.js.map